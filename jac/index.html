<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ÊóÖÈÅäÁßòÊõ∏">
    <meta name="theme-color" content="#0f172a">
    <title>ÊóÖÈÅäÁßòÊõ∏ v6 - ÊãçÁ´ãÂæóÁâà</title>
    
    <link rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22%E6%97%85%E9%81%8A%E7%A7%98%E6%9B%B8%22%2C%22short_name%22%3A%22%E6%97%85%E9%81%8A%E7%A7%98%E6%9B%B8%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%230f172a%22%2C%22theme_color%22%3A%22%2306b6d4%22%7D">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%2306b6d4'/%3E%3Cstop offset='100%25' stop-color='%23ec4899'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' fill='%230f172a' rx='40'/%3E%3Ccircle cx='90' cy='90' r='60' fill='url(%23g)'/%3E%3Ctext x='90' y='105' font-size='60' text-anchor='middle'%3E‚úàÔ∏è%3C/text%3E%3C/svg%3E">
    
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --cyan: #06b6d4;
            --cyan-glow: rgba(6, 182, 212, 0.3);
            --purple: #a855f7;
            --purple-glow: rgba(168, 85, 247, 0.3);
            --emerald: #10b981;
            --emerald-glow: rgba(16, 185, 129, 0.3);
            --orange: #f59e0b;
            --orange-glow: rgba(245, 158, 11, 0.3);
            --pink: #ec4899;
            --pink-glow: rgba(236, 72, 153, 0.3);
            --red: #ef4444;
            --text-light: #e2e8f0;
            --text-dim: #94a3b8;
            --text-muted: #64748b;
            --border: #334155;
            --nav-height: 70px;
            --header-height: 60px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { height: 100%; overflow: hidden; touch-action: manipulation; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif; background: var(--bg-dark); color: var(--text-light); line-height: 1.5; }
        
        .app-container { height: 100%; display: flex; flex-direction: column; padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }
        
        .app-header { height: var(--header-height); background: linear-gradient(135deg, var(--cyan) 0%, var(--purple) 100%); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; flex-shrink: 0; }
        .app-logo { display: flex; align-items: center; gap: 10px; font-size: 1.2em; font-weight: 700; }
        .header-actions { display: flex; gap: 8px; }
        .header-btn { width: 40px; height: 40px; border: none; background: rgba(255,255,255,0.2); border-radius: 12px; color: white; font-size: 1.3em; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        
        .app-content { flex: 1; overflow: hidden; position: relative; }
        .page { position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow-y: auto; padding: 16px; padding-bottom: calc(var(--nav-height) + 20px); display: none; -webkit-overflow-scrolling: touch; }
        .page.active { display: block; }
        
        .bottom-nav { height: var(--nav-height); background: var(--bg-card); border-top: 1px solid var(--border); display: flex; flex-shrink: 0; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; border: none; background: transparent; color: var(--text-muted); padding: 8px 0; cursor: pointer; position: relative; }
        .nav-item::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 0; height: 3px; background: var(--cyan); border-radius: 0 0 3px 3px; transition: width 0.3s; }
        .nav-item.active { color: var(--cyan); }
        .nav-item.active::before { width: 30px; }
        .nav-icon { font-size: 1.5em; }
        .nav-label { font-size: 0.7em; font-weight: 500; }
        
        .card { background: var(--bg-card); border-radius: 16px; padding: 16px; margin-bottom: 16px; border: 1px solid var(--border); }
        .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .card-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2em; }
        .card-icon.cyan { background: var(--cyan-glow); }
        .card-icon.purple { background: var(--purple-glow); }
        .card-icon.emerald { background: var(--emerald-glow); }
        .card-icon.orange { background: var(--orange-glow); }
        .card-icon.pink { background: var(--pink-glow); }
        .card-title { font-size: 1em; font-weight: 600; }
        .card-subtitle { font-size: 0.8em; color: var(--text-dim); }
        
        .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 16px; }
        .stat-card { background: var(--bg-card); border-radius: 12px; padding: 12px; text-align: center; border: 1px solid var(--border); }
        .stat-value { font-size: 1.4em; font-weight: 700; }
        .stat-value.cyan { color: var(--cyan); }
        .stat-value.orange { color: var(--orange); }
        .stat-value.emerald { color: var(--emerald); }
        .stat-label { font-size: 0.7em; color: var(--text-muted); margin-top: 2px; }
        
        .input-group { margin-bottom: 14px; }
        .input-label { display: block; font-size: 0.85em; font-weight: 500; color: var(--text-dim); margin-bottom: 6px; }
        .input-field { width: 100%; padding: 12px 14px; background: var(--bg-dark); border: 2px solid var(--border); border-radius: 10px; color: var(--text-light); font-size: 1em; -webkit-appearance: none; }
        .input-field:focus { outline: none; border-color: var(--cyan); }
        select.input-field { cursor: pointer; }
        textarea.input-field { min-height: 80px; resize: vertical; }
        
        .input-row { display: flex; gap: 10px; }
        .input-row .input-group { flex: 1; margin-bottom: 0; }
        .input-row-btn { display: flex; gap: 8px; }
        .input-row-btn .input-field { flex: 1; }
        .input-btn { width: 50px; height: 48px; border: none; background: var(--bg-card-hover); border-radius: 10px; color: var(--text-dim); font-size: 1.2em; cursor: pointer; flex-shrink: 0; }
        
        .btn { width: 100%; padding: 14px 20px; border: none; border-radius: 12px; font-size: 1em; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer; }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: linear-gradient(135deg, var(--cyan) 0%, var(--purple) 100%); color: white; }
        .btn-secondary { background: linear-gradient(135deg, var(--emerald) 0%, #059669 100%); color: white; }
        .btn-orange { background: linear-gradient(135deg, var(--orange) 0%, #d97706 100%); color: white; }
        .btn-pink { background: linear-gradient(135deg, var(--pink) 0%, #db2777 100%); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--cyan); color: var(--cyan); }
        .btn-danger { background: var(--red); color: white; }
        .btn-sm { padding: 10px 14px; font-size: 0.9em; }
        .btn-xs { padding: 8px 12px; font-size: 0.8em; border-radius: 8px; }
        
        .action-row { display: flex; gap: 10px; margin-top: 14px; }
        .action-row .btn { flex: 1; }
        
        .trip-banner { background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); border-radius: 16px; padding: 20px; margin-bottom: 16px; border: 1px solid var(--border); text-align: center; }
        .trip-name { font-size: 1.5em; font-weight: 700; margin-bottom: 4px; }
        .trip-dest { font-size: 1em; color: var(--cyan); margin-bottom: 8px; }
        .trip-dates { font-size: 0.85em; color: var(--text-dim); }
        
        .day-card { background: var(--bg-card); border-radius: 14px; margin-bottom: 14px; border: 1px solid var(--border); overflow: hidden; }
        .day-header { padding: 14px; background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
        .day-title { font-weight: 600; }
        .day-date { font-size: 0.8em; color: var(--text-dim); }
        .day-content { padding: 14px; display: none; }
        .day-content.show { display: block; }
        
        .schedule-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; border-left: 3px solid var(--cyan); }
        .schedule-item.has-reminder { border-left-color: var(--orange); }
        .schedule-item.synced { border-left-color: var(--emerald); }
        .schedule-time { font-size: 0.8em; color: var(--cyan); font-weight: 600; }
        .schedule-title { font-size: 0.95em; font-weight: 500; margin: 4px 0; }
        .schedule-location { font-size: 0.8em; color: var(--text-dim); }
        .schedule-actions { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
        .schedule-badge { font-size: 0.7em; padding: 2px 8px; border-radius: 10px; }
        .schedule-badge.reminder { background: var(--orange-glow); color: var(--orange); }
        .schedule-badge.synced { background: var(--emerald-glow); color: var(--emerald); }
        
        .expense-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .expense-info { flex: 1; }
        .expense-category { font-size: 0.75em; color: var(--text-muted); }
        .expense-name { font-size: 0.95em; font-weight: 500; }
        .expense-meta { font-size: 0.75em; color: var(--text-dim); margin-top: 2px; }
        .expense-amount { font-size: 1.1em; font-weight: 700; }
        .expense-amount.jpy { color: var(--orange); }
        .expense-amount.twd { color: var(--emerald); }
        .expense-delete { color: var(--text-muted); padding: 8px; cursor: pointer; }
        
        .shop-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; display: flex; align-items: center; gap: 12px; }
        .shop-item.bought { opacity: 0.5; }
        .shop-checkbox { width: 24px; height: 24px; border: 2px solid var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; }
        .shop-item.bought .shop-checkbox { background: var(--emerald); border-color: var(--emerald); }
        .shop-info { flex: 1; }
        .shop-name { font-size: 0.95em; font-weight: 500; }
        .shop-item.bought .shop-name { text-decoration: line-through; }
        .shop-meta { font-size: 0.75em; color: var(--text-dim); }
        .shop-priority { font-size: 0.7em; padding: 2px 8px; border-radius: 10px; }
        .shop-priority.high { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .shop-priority.medium { background: var(--orange-glow); color: var(--orange); }
        .shop-priority.low { background: var(--emerald-glow); color: var(--emerald); }
        
        .reminder-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 10px; }
        .reminder-option { display: flex; align-items: center; gap: 8px; padding: 10px; background: var(--bg-dark); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; font-size: 0.85em; }
        .reminder-option.checked { border-color: var(--cyan); background: var(--cyan-glow); }
        .reminder-checkbox { width: 20px; height: 20px; border: 2px solid var(--border); border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        .reminder-option.checked .reminder-checkbox { background: var(--cyan); border-color: var(--cyan); }
        
        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--border); }
        .setting-item:last-child { border-bottom: none; }
        .setting-info { flex: 1; }
        .setting-label { font-size: 0.95em; font-weight: 500; }
        .setting-status { font-size: 0.8em; color: var(--text-dim); }
        
        .toggle { width: 50px; height: 28px; background: var(--border); border-radius: 14px; position: relative; cursor: pointer; transition: background 0.3s; }
        .toggle.active { background: var(--cyan); }
        .toggle::after { content: ''; position: absolute; top: 3px; left: 3px; width: 22px; height: 22px; background: white; border-radius: 50%; transition: transform 0.3s; }
        .toggle.active::after { transform: translateX(22px); }
        
        .auth-status { margin-top: 8px; padding: 10px; border-radius: 8px; font-size: 0.85em; }
        .auth-status.success { background: var(--emerald-glow); color: var(--emerald); }
        .auth-status.error { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; align-items: flex-end; justify-content: center; z-index: 1000; }
        .modal-overlay.show { display: flex; }
        .modal { background: var(--bg-card); border-radius: 20px 20px 0 0; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; padding: 20px; padding-bottom: calc(20px + env(safe-area-inset-bottom)); animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .modal-handle { width: 40px; height: 4px; background: var(--border); border-radius: 2px; margin: 0 auto 16px; }
        .modal-title { font-size: 1.1em; font-weight: 600; text-align: center; margin-bottom: 16px; }
        
        .toast { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: var(--bg-card); color: var(--text-light); padding: 12px 20px; border-radius: 10px; font-size: 0.9em; z-index: 2000; opacity: 0; transition: opacity 0.3s; border: 1px solid var(--border); max-width: calc(100% - 40px); text-align: center; }
        .toast.show { opacity: 1; }
        .toast.success { border-color: var(--emerald); }
        .toast.error { border-color: var(--red); }
        
        .progress-bar { height: 8px; background: var(--bg-dark); border-radius: 4px; overflow: hidden; margin-top: 8px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--cyan), var(--purple)); border-radius: 4px; transition: width 0.5s ease; }
        
        .empty-state { text-align: center; padding: 40px 20px; color: var(--text-muted); }
        .empty-icon { font-size: 3em; margin-bottom: 12px; }
        
        .fab { position: fixed; bottom: calc(var(--nav-height) + 20px + env(safe-area-inset-bottom)); right: 20px; width: 56px; height: 56px; border-radius: 50%; background: linear-gradient(135deg, var(--cyan), var(--purple)); color: white; border: none; font-size: 1.5em; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4); cursor: pointer; z-index: 100; }
        
        /* Âª∫Ë≠∞ÈÅ∏ÂñÆÊ®£Âºè */
        .suggest-section { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 14px; }
        .suggest-title { font-size: 0.85em; color: var(--cyan); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .suggest-chips { display: flex; flex-wrap: wrap; gap: 8px; }
        .suggest-chip { padding: 8px 12px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 20px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; }
        .suggest-chip:hover, .suggest-chip:active { background: var(--cyan-glow); border-color: var(--cyan); }
        .suggest-chip.selected { background: var(--cyan); color: white; border-color: var(--cyan); }
        
        /* Ëá™ÂãïÁî¢ÁîüÊåâÈàï */
        .auto-generate-btn { background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%); margin-bottom: 10px; }
        
        /* üí∞ È†êÁÆóÂÆàË≠∑Áí∞Ê®£Âºè */
        .budget-ring-section { display: flex; align-items: center; gap: 20px; padding: 15px; background: var(--bg-dark); border-radius: 16px; margin-bottom: 15px; }
        .budget-ring-container { position: relative; width: 100px; height: 100px; flex-shrink: 0; }
        .budget-ring { width: 100%; height: 100%; transform: rotate(-90deg); }
        .ring-bg { fill: none; stroke: var(--bg-card); stroke-width: 10; }
        .ring-progress { fill: none; stroke: var(--emerald); stroke-width: 10; stroke-linecap: round; stroke-dasharray: 264; stroke-dashoffset: 264; transition: stroke-dashoffset 0.8s ease, stroke 0.3s ease; }
        .ring-progress.warning { stroke: var(--orange); }
        .ring-progress.danger { stroke: var(--pink); }
        .ring-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .ring-percent { font-size: 1.3em; font-weight: 700; color: var(--text-light); }
        .ring-label { font-size: 0.65em; color: var(--text-dim); }
        .budget-info { flex: 1; }
        .budget-row { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid var(--border); font-size: 0.85em; }
        .budget-row:last-of-type { border-bottom: none; }
        .budget-value { font-weight: 600; color: var(--text-light); }
        .budget-value.spent { color: var(--orange); }
        .budget-value.remain { color: var(--emerald); }
        .budget-value.over { color: var(--pink); }
        .btn-sm { padding: 8px 12px; font-size: 0.8em; }
        
        /* üó∫Ô∏è Âú∞ÂúñÂ∞éËà™ÊåâÈàï */
        .map-btn { display: inline-flex; align-items: center; justify-content: center; width: 26px; height: 26px; background: var(--bg-dark); border-radius: 50%; font-size: 0.9em; cursor: pointer; margin-left: 6px; transition: all 0.2s; vertical-align: middle; text-decoration: none; }
        .map-btn:hover, .map-btn:active { background: var(--cyan); transform: scale(1.1); }
        
        /* üì∏ ÊØèÊó•Â∞ÅÈù¢ÁÖßÁâá */
        .day-cover { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 12px 12px 0 0; overflow: hidden; background: var(--bg-dark); }
        .day-cover img { width: 100%; height: 100%; object-fit: cover; }
        .day-cover-placeholder { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-dim); cursor: pointer; transition: background 0.2s; }
        .day-cover-placeholder:hover { background: var(--bg-card); }
        .day-cover-placeholder .icon { font-size: 2em; margin-bottom: 5px; }
        .cover-edit-btn { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); padding: 6px 10px; border-radius: 20px; font-size: 0.75em; color: white; cursor: pointer; border: none; }
        .cover-edit-btn:hover { background: rgba(0,0,0,0.8); }
        .day-card-with-cover { border-radius: 12px; overflow: hidden; }
        .day-card-with-cover .card-header { border-radius: 0; }
        
        /* ‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥Ê®£Âºè */
        .notes-btn { display: flex; align-items: center; gap: 6px; background: var(--purple-glow); border: 1px solid var(--purple); padding: 6px 12px; border-radius: 20px; font-size: 0.8em; color: var(--purple); cursor: pointer; transition: all 0.2s; margin-top: 8px; }
        .notes-btn:hover { background: var(--purple); color: white; }
        .notes-btn .count { background: var(--purple); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.85em; }
        .note-item { background: var(--bg-dark); border-radius: 12px; padding: 14px; margin-bottom: 12px; border-left: 3px solid var(--purple); position: relative; }
        .note-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .note-time { font-size: 0.8em; color: var(--text-dim); display: flex; align-items: center; gap: 6px; }
        .note-mood { font-size: 1.2em; }
        .note-content { font-size: 0.95em; line-height: 1.7; color: var(--text-light); white-space: pre-wrap; word-break: break-word; }
        .note-delete { position: absolute; top: 10px; right: 10px; background: transparent; border: none; color: var(--text-muted); cursor: pointer; font-size: 1em; padding: 4px; transition: color 0.2s; }
        .note-delete:hover { color: var(--pink); }
        .note-empty { text-align: center; padding: 30px 20px; color: var(--text-muted); }
        .note-empty .icon { font-size: 2.5em; margin-bottom: 10px; }
        .mood-picker { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
        .mood-option { width: 44px; height: 44px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 1.4em; cursor: pointer; transition: all 0.2s; }
        .mood-option:hover { transform: scale(1.15); border-color: var(--purple); }
        .mood-option.selected { border-color: var(--purple); background: var(--purple-glow); transform: scale(1.1); }
        .notes-day-header { background: linear-gradient(135deg, var(--purple-glow), var(--cyan-glow)); padding: 15px; border-radius: 12px; margin-bottom: 15px; text-align: center; }
        .notes-day-title { font-size: 1.1em; font-weight: 600; }
        .notes-day-date { font-size: 0.85em; color: var(--text-dim); margin-top: 4px; }
        
        /* üë• ÊóÖ‰º¥ÁÆ°ÁêÜËàáÂàÜÂ∏≥Ê®£Âºè */
        .member-tag { display: inline-flex; align-items: center; gap: 6px; background: var(--bg-card); padding: 6px 12px; border-radius: 20px; margin: 4px; font-size: 0.85em; }
        .member-tag .remove { cursor: pointer; opacity: 0.6; transition: opacity 0.2s; }
        .member-tag .remove:hover { opacity: 1; color: var(--pink); }
        .member-tag.me { background: var(--cyan-glow); border: 1px solid var(--cyan); }
        .split-checkbox { display: inline-flex; align-items: center; gap: 6px; background: var(--bg-card); padding: 8px 12px; border-radius: 20px; cursor: pointer; font-size: 0.85em; transition: all 0.2s; border: 1px solid transparent; }
        .split-checkbox:hover { background: var(--bg-card-hover); }
        .split-checkbox.checked { background: var(--emerald-glow); border-color: var(--emerald); }
        .split-checkbox input { display: none; }
        .split-checkbox .check { width: 18px; height: 18px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 0.7em; }
        .split-checkbox.checked .check { background: var(--emerald); border-color: var(--emerald); color: white; }
        
        /* ÂàÜÂ∏≥ÁµêÁÆó */
        .split-person { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; }
        .split-person-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .split-person-name { font-weight: 600; font-size: 1em; }
        .split-person-stats { display: flex; gap: 15px; font-size: 0.85em; }
        .split-stat { display: flex; flex-direction: column; }
        .split-stat-label { color: var(--text-dim); font-size: 0.75em; }
        .split-stat-value { font-weight: 600; }
        .split-stat-value.paid { color: var(--cyan); }
        .split-stat-value.owe { color: var(--orange); }
        .split-stat-value.receive { color: var(--emerald); }
        .split-transactions { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }
        .split-tx { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: var(--bg-card); border-radius: 8px; margin-bottom: 6px; font-size: 0.9em; }
        .split-tx-arrow { color: var(--text-dim); margin: 0 10px; }
        .split-tx-amount { font-weight: 600; color: var(--emerald); }
        
        /* üì∏ ÊôØÈªûÊâìÂç°ÂäüËÉΩÊ®£Âºè */
        .checkin-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .checkin-stat { background: var(--bg-card); border-radius: 12px; padding: 12px 8px; text-align: center; border: 1px solid var(--border); }
        .checkin-stat-icon { font-size: 1.3em; margin-bottom: 4px; }
        .checkin-stat-value { font-size: 1.4em; font-weight: 700; }
        .checkin-stat-value.pink { color: var(--pink); }
        .checkin-stat-value.gold { color: #ffd700; }
        .checkin-stat-value.cyan { color: var(--cyan); }
        .checkin-stat-label { font-size: 0.7em; color: var(--text-dim); }
        
        .spot-card { background: var(--bg-card); border-radius: 14px; padding: 14px; margin-bottom: 10px; border: 1px solid var(--border); display: flex; align-items: center; gap: 12px; transition: all 0.3s; cursor: pointer; }
        .spot-card:hover { transform: translateX(4px); border-color: var(--pink); }
        .spot-card.checked { background: linear-gradient(135deg, rgba(236,72,153,0.15), rgba(255,215,0,0.1)); border-color: rgba(255,215,0,0.4); }
        .spot-checkbox { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--text-muted); display: flex; align-items: center; justify-content: center; font-size: 0.85em; flex-shrink: 0; transition: all 0.3s; }
        .spot-card.checked .spot-checkbox { background: linear-gradient(135deg, var(--pink), #ffd700); border-color: transparent; box-shadow: 0 0 12px rgba(236,72,153,0.4); }
        .spot-info { flex: 1; min-width: 0; }
        .spot-name { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .spot-meta { font-size: 0.8em; color: var(--text-dim); display: flex; align-items: center; gap: 8px; margin-top: 3px; }
        .spot-delete { width: 32px; height: 32px; border: none; background: rgba(239,68,68,0.15); border-radius: 8px; color: #ef4444; cursor: pointer; display: flex; align-items: center; justify-content: center; opacity: 0.6; transition: all 0.2s; }
        .spot-delete:hover { opacity: 1; background: rgba(239,68,68,0.25); }
        
        .checkin-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .checkin-photo { position: relative; aspect-ratio: 1; border-radius: 12px; overflow: hidden; cursor: pointer; }
        .checkin-photo img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .checkin-photo:hover img { transform: scale(1.05); }
        .checkin-photo-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 6px; background: linear-gradient(transparent, rgba(0,0,0,0.8)); font-size: 0.7em; }
        
        .badge-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .badge-card { background: var(--bg-card); border-radius: 14px; padding: 14px 10px; text-align: center; border: 1px solid var(--border); transition: all 0.3s; }
        .badge-card.locked { opacity: 0.5; filter: grayscale(0.8); }
        .badge-card.unlocked { background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(6,182,212,0.1)); border-color: var(--pink); box-shadow: 0 0 15px rgba(236,72,153,0.2); }
        .badge-icon { font-size: 2em; margin-bottom: 6px; }
        .badge-name { font-size: 0.8em; font-weight: 600; margin-bottom: 4px; }
        .badge-desc { font-size: 0.7em; color: var(--text-dim); }
        .badge-progress { margin-top: 8px; height: 4px; background: var(--bg-dark); border-radius: 2px; overflow: hidden; }
        .badge-progress-fill { height: 100%; background: linear-gradient(90deg, var(--pink), var(--cyan)); border-radius: 2px; transition: width 0.5s; }
        
        .photo-upload-area { border: 2px dashed var(--border); border-radius: 14px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s; margin-bottom: 15px; }
        .photo-upload-area:hover { border-color: var(--pink); background: rgba(236,72,153,0.05); }
        .photo-upload-area.has-photo { padding: 0; border: none; }
        .photo-upload-area.has-photo img { width: 100%; max-height: 200px; object-fit: cover; border-radius: 14px; }
        .photo-upload-icon { font-size: 2.5em; margin-bottom: 10px; }
        .photo-upload-text { color: var(--text-dim); font-size: 0.9em; }
        
        .photo-viewer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9999; display: none; flex-direction: column; }
        .photo-viewer-overlay.show { display: flex; }
        .photo-viewer-header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .photo-viewer-close { width: 40px; height: 40px; border: none; background: rgba(255,255,255,0.1); border-radius: 50%; color: white; font-size: 1.2em; cursor: pointer; }
        .photo-viewer-content { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .photo-viewer-content img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 12px; }
        .photo-viewer-info { padding: 20px; text-align: center; }
        .photo-viewer-spot { font-size: 1.1em; font-weight: 600; margin-bottom: 8px; }
        .photo-viewer-note { color: var(--text-dim); font-size: 0.9em; }
        
        .memoir-day { margin-bottom: 25px; }
        .memoir-day-title { font-size: 1em; font-weight: 700; color: var(--pink); padding-bottom: 8px; border-bottom: 2px solid var(--pink); margin-bottom: 12px; }
        .memoir-entry { background: var(--bg-card); border-radius: 14px; overflow: hidden; margin-bottom: 12px; }
        .memoir-entry-photo { width: 100%; height: 200px; object-fit: cover; }
        .memoir-entry-content { padding: 12px; }
        .memoir-entry-spot { font-weight: 600; margin-bottom: 4px; }
        .memoir-entry-note { color: var(--text-dim); font-size: 0.9em; }
        
        .checkin-tab-bar { display: flex; gap: 8px; margin-bottom: 15px; }
        .checkin-tab { flex: 1; padding: 10px; border: none; background: var(--bg-card); border-radius: 10px; color: var(--text-dim); font-size: 0.85em; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .checkin-tab.active { background: linear-gradient(135deg, var(--pink), var(--purple)); color: white; }
        .checkin-section { display: none; }
        .checkin-section.active { display: block; }
        
        /* üé¨ ÂïüÂãïÁï´Èù¢Ê®£Âºè */
        .splash-screen {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        .splash-screen.hide {
            opacity: 0;
            visibility: hidden;
        }
        .splash-content {
            text-align: center;
        }
        .splash-logo {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }
        .logo-circle {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #06b6d4, #ec4899, #a855f7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(236, 72, 153, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }
        .logo-plane {
            font-size: 3.5em;
            animation: float 3s ease-in-out infinite;
        }
        .logo-ring {
            position: absolute;
            top: -10px; left: -10px; right: -10px; bottom: -10px;
            border: 3px solid rgba(6, 182, 212, 0.3);
            border-radius: 50%;
            animation: ring-rotate 4s linear infinite;
        }
        .logo-ring::before {
            content: '';
            position: absolute;
            top: 5px; left: 50%;
            width: 10px; height: 10px;
            background: #06b6d4;
            border-radius: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 10px #06b6d4;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-8px) rotate(5deg); }
        }
        @keyframes ring-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .splash-title {
            font-size: 2em;
            font-weight: 700;
            background: linear-gradient(135deg, #06b6d4, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: 2px;
        }
        .splash-subtitle {
            color: #94a3b8;
            font-size: 0.95em;
            margin-bottom: 40px;
        }
        .splash-loading {
            display: flex;
            justify-content: center;
        }
        .loading-dots {
            display: flex;
            gap: 8px;
        }
        .loading-dots span {
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #06b6d4, #ec4899);
            border-radius: 50%;
            animation: bounce 1.4s ease-in-out infinite;
        }
        .loading-dots span:nth-child(1) { animation-delay: 0s; }
        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        .splash-footer {
            position: absolute;
            bottom: 30px;
            color: #475569;
            font-size: 0.8em;
            letter-spacing: 1px;
        }
        
        /* ===== Ë∂£Âë≥Â∑•ÂÖ∑È†ÅÈù¢ CSS ===== */
        .fun-tools-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px; }
        .fun-tool-card { background: var(--bg-card); border-radius: 16px; padding: 20px 16px; text-align: center; border: 1px solid var(--border); cursor: pointer; transition: all 0.3s ease; }
        .fun-tool-card:hover { transform: translateY(-3px); border-color: var(--cyan); }
        .fun-tool-card.active { border-color: var(--cyan); background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); }
        .fun-tool-icon { font-size: 2.2em; margin-bottom: 10px; }
        .fun-tool-name { font-size: 0.95em; font-weight: 600; }
        .fun-tool-desc { font-size: 0.75em; color: var(--text-muted); margin-top: 4px; }
        
        .fun-panel { display: none; animation: fadeIn 0.3s ease; }
        .fun-panel.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Ëº™Áõ§Ê®£Âºè */
        .roulette-container { display: flex; flex-direction: column; align-items: center; padding: 20px 0; }
        .roulette-wheel { width: 260px; height: 260px; border-radius: 50%; position: relative; margin-bottom: 24px; box-shadow: 0 0 30px var(--cyan-glow), inset 0 0 20px rgba(0,0,0,0.5); transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); }
        .roulette-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: 50px; background: linear-gradient(135deg, var(--cyan), var(--purple)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; box-shadow: 0 4px 15px var(--cyan-glow); z-index: 10; }
        .roulette-pointer { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 12px solid transparent; border-right: 12px solid transparent; border-top: 20px solid var(--cyan); filter: drop-shadow(0 3px 8px var(--cyan-glow)); z-index: 20; }
        .roulette-result { text-align: center; padding: 16px; background: var(--bg-card-hover); border-radius: 14px; margin-top: 16px; display: none; }
        .roulette-result.show { display: block; animation: popIn 0.4s ease; }
        .roulette-result-text { font-size: 1.4em; font-weight: 700; color: var(--cyan); }
        @keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        
        .tag-list { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 14px; }
        .tag { padding: 8px 12px; background: var(--bg-card-hover); border-radius: 16px; font-size: 0.85em; display: flex; align-items: center; gap: 6px; }
        .tag-remove { width: 18px; height: 18px; border: none; background: rgba(255,255,255,0.1); border-radius: 50%; color: var(--text-muted); font-size: 0.7em; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        /* ÈªòÂ•ëÊ∏¨Ë©¶ */
        .player-tabs { display: flex; gap: 8px; margin-bottom: 14px; }
        .player-tab { flex: 1; padding: 12px; background: var(--bg-card-hover); border: 2px solid var(--border); border-radius: 10px; color: var(--text-dim); font-weight: 600; cursor: pointer; text-align: center; transition: all 0.3s ease; }
        .player-tab.active { border-color: var(--cyan); color: var(--cyan); background: var(--cyan-glow); }
        .player-tab.done::after { content: ' ‚úì'; color: var(--emerald); }
        .chemistry-question { background: var(--bg-dark); border-radius: 12px; padding: 14px; margin-bottom: 12px; }
        .chemistry-question-title { font-size: 0.8em; color: var(--cyan); margin-bottom: 6px; }
        .chemistry-question-text { font-size: 1em; font-weight: 600; margin-bottom: 10px; }
        .chemistry-result { background: var(--bg-dark); border-radius: 12px; padding: 14px; margin-bottom: 12px; border-left: 3px solid var(--cyan); }
        .chemistry-match { display: flex; align-items: center; justify-content: center; gap: 16px; padding: 16px; margin-bottom: 16px; }
        .chemistry-score { font-size: 2.5em; font-weight: 900; color: var(--cyan); }
        
        /* Áâ©ÂÉπË®àÁÆóÊ©ü */
        .currency-display { background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); border-radius: 16px; padding: 20px; text-align: center; margin-bottom: 16px; }
        .currency-amount { font-size: 2.2em; font-weight: 900; margin-bottom: 6px; }
        .currency-converted { font-size: 1.1em; color: var(--text-dim); }
        .currency-equivalent { background: var(--bg-card); border-radius: 12px; padding: 14px; margin-top: 14px; text-align: center; }
        .equivalent-title { font-size: 0.8em; color: var(--text-muted); margin-bottom: 6px; }
        .equivalent-text { font-size: 1em; font-weight: 600; color: var(--orange); }
        .currency-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-bottom: 14px; max-height: 200px; overflow-y: auto; }
        .currency-btn { padding: 10px 6px; background: var(--bg-card-hover); border: 2px solid var(--border); border-radius: 8px; color: var(--text-dim); font-size: 0.75em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .currency-btn.active { border-color: var(--cyan); color: var(--cyan); background: var(--cyan-glow); }
        .currency-search { margin-bottom: 10px; }
        
        /* Bingo */
        .bingo-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin-bottom: 16px; }
        .bingo-cell { aspect-ratio: 1; background: var(--bg-card-hover); border: 2px solid var(--border); border-radius: 8px; display: flex; align-items: center; justify-content: center; text-align: center; font-size: 0.6em; font-weight: 500; padding: 3px; cursor: pointer; transition: all 0.3s ease; line-height: 1.2; }
        .bingo-cell.checked { background: linear-gradient(135deg, var(--pink), var(--purple)); border-color: transparent; color: white; box-shadow: 0 3px 12px var(--pink-glow); }
        .bingo-cell.center { background: linear-gradient(135deg, var(--cyan), var(--purple)); border-color: transparent; color: white; font-weight: 700; }
        .bingo-stats { display: flex; justify-content: center; gap: 30px; padding: 14px; background: var(--bg-card-hover); border-radius: 12px; }
        .bingo-stat { text-align: center; }
        .bingo-stat-value { font-size: 1.8em; font-weight: 900; }
        .bingo-stat-value.lines { color: var(--pink); }
        .bingo-stat-value.checks { color: var(--orange); }
        .bingo-stat-label { font-size: 0.75em; color: var(--text-muted); }
        
        /* Â§©Ê∞£Á©øÊê≠ */
        .weather-display { background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 50%, var(--bg-card) 100%); border-radius: 20px; padding: 24px 16px; text-align: center; margin-bottom: 16px; position: relative; overflow: hidden; }
        .weather-location { font-size: 1.1em; font-weight: 700; margin-bottom: 6px; }
        .weather-icon { font-size: 3.5em; margin: 12px 0; }
        .weather-temp { font-size: 2.5em; font-weight: 900; }
        .weather-desc { color: var(--text-dim); margin-top: 6px; }
        .weather-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 16px; }
        .weather-detail { background: var(--bg-card); border-radius: 12px; padding: 12px 8px; text-align: center; }
        .weather-detail-icon { font-size: 1.2em; margin-bottom: 4px; }
        .weather-detail-value { font-weight: 700; font-size: 0.95em; }
        .weather-detail-label { font-size: 0.7em; color: var(--text-muted); }
        .outfit-suggestion { background: var(--bg-card); border-radius: 14px; padding: 16px; }
        .outfit-title { font-weight: 700; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .outfit-items { display: flex; flex-wrap: wrap; gap: 8px; }
        .outfit-item { padding: 8px 14px; background: var(--bg-card-hover); border-radius: 16px; font-size: 0.85em; }
        
        /* ÂøÉÊÉÖÊ∫´Â∫¶Ë®à */
        .mood-today { background: linear-gradient(135deg, var(--pink-glow) 0%, var(--orange-glow) 100%); border-radius: 16px; padding: 20px; text-align: center; margin-bottom: 16px; }
        .mood-date { font-size: 0.85em; color: var(--text-dim); margin-bottom: 12px; }
        .mood-emoji { font-size: 2em; }
        .mood-value { font-size: 2.5em; font-weight: 900; margin: 10px 0; }
        .mood-slider { width: 100%; height: 8px; -webkit-appearance: none; background: linear-gradient(90deg, #ef4444, #f59e0b, #ffd93d, #84cc16, #10b981); border-radius: 8px; outline: none; margin: 16px 0; }
        .mood-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 26px; height: 26px; background: white; border-radius: 50%; cursor: pointer; box-shadow: 0 3px 12px rgba(0,0,0,0.3); }
        .mood-note { width: 100%; padding: 12px; background: var(--bg-dark); border: 2px solid var(--border); border-radius: 10px; color: var(--text-light); font-family: inherit; font-size: 0.95em; resize: none; margin-top: 12px; }
        .mood-note:focus { outline: none; border-color: var(--pink); }
        .mood-chart { background: var(--bg-card); border-radius: 14px; padding: 16px; margin-top: 16px; }
        .mood-chart-title { font-weight: 700; margin-bottom: 14px; }
        .mood-chart-container { height: 120px; display: flex; align-items: flex-end; justify-content: space-between; gap: 5px; padding-bottom: 24px; position: relative; }
        .mood-bar { flex: 1; background: linear-gradient(180deg, var(--pink), var(--orange)); border-radius: 5px 5px 0 0; min-height: 8px; position: relative; transition: height 0.5s ease; }
        .mood-bar-label { position: absolute; bottom: -20px; left: 50%; transform: translateX(-50%); font-size: 0.6em; color: var(--text-muted); white-space: nowrap; }
        .mood-history { margin-top: 16px; }
        .mood-entry { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg-card-hover); border-radius: 10px; margin-bottom: 8px; }
        .mood-entry-emoji { font-size: 1.3em; }
        .mood-entry-info { flex: 1; }
        .mood-entry-date { font-size: 0.75em; color: var(--text-muted); }
        .mood-entry-note { font-size: 0.85em; margin-top: 2px; }
        .mood-entry-score { font-size: 1.2em; font-weight: 900; color: var(--pink); }
        
        /* ============================================ */
        /* üì∏ ÊãçÁ´ãÂæóÁõ∏Ê©üÊ®£Âºè */
        /* ============================================ */
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
        
        .polaroid-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, #f0f4f8 0%, #dfe6e9 100%);
            background-image: radial-gradient(#dfe6e9 1px, transparent 1px);
            background-size: 20px 20px;
            z-index: 9998;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            overflow: hidden;
        }
        .polaroid-overlay.show { display: flex; }
        
        .polaroid-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            z-index: 100;
        }
        .polaroid-title {
            font-family: 'Pacifico', cursive;
            font-size: 1.5em;
            color: #5a8274;
            text-shadow: 1px 1px 0px white;
        }
        .polaroid-close-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0,0,0,0.1);
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
        }
        
        /* 3D Áõ∏Ê©üÊú¨È´î */
        .camera-body {
            width: 280px;
            height: 300px;
            background: linear-gradient(135deg, #cbf0de 0%, #b2e2cd 50%, #9ad4bd 100%);
            border-radius: 55px;
            position: relative;
            box-shadow: 
                inset 5px 5px 15px rgba(255,255,255,0.8), 
                inset -8px -8px 25px rgba(0,0,0,0.15),   
                20px 30px 50px rgba(0,0,0,0.25),         
                -5px -5px 20px rgba(255,255,255,0.5);    
            z-index: 20;
            transition: transform 0.1s;
            flex-shrink: 0;
        }
        .camera-body:active { transform: scale(0.99); }
        
        .camera-grip {
            position: absolute;
            left: 0;
            top: 35px;
            bottom: 35px;
            width: 45px;
            background: linear-gradient(90deg, rgba(0,0,0,0.08), transparent 80%);
            border-radius: 50px 0 0 50px;
        }
        
        .cam-flash {
            position: absolute;
            top: 25px;
            right: 35px;
            width: 38px;
            height: 55px;
            background: linear-gradient(135deg, #f0f4f2, #d1d9d6);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1), inset 2px 2px 1px rgba(255,255,255,1);
            overflow: hidden;
            z-index: 25;
        }
        .cam-flash::after {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 85%; height: 85%;
            background: repeating-linear-gradient(0deg, transparent 0px, transparent 2px, rgba(0,0,0,0.1) 3px),
                        repeating-linear-gradient(90deg, transparent 0px, transparent 2px, rgba(0,0,0,0.1) 3px);
            background-color: #eef2f0;
            border-radius: 6px;
        }
        
        .cam-viewfinder {
            position: absolute;
            top: 40px;
            right: 90px;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle at 30% 30%, #555, #111);
            border-radius: 6px;
            box-shadow: inset 1px 1px 3px rgba(255,255,255,0.3);
        }
        
        .cam-sensor-dots {
            position: absolute;
            top: 45px;
            right: 125px;
            display: flex;
            gap: 5px;
        }
        .cam-dot {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%, #444, #000);
            border-radius: 50%;
        }
        
        .lens-mount {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -40%);
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, #cbf0de 40%, #a5dcc5 100%);
            border-radius: 50%;
            box-shadow: -8px -8px 20px rgba(255,255,255,0.7), 8px 8px 25px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 22;
        }
        
        .lens-ring-outer {
            width: 165px;
            height: 165px;
            background: linear-gradient(135deg, #b8e6d3, #9adbc0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1), inset 1px 1px 2px rgba(255,255,255,0.8);
            position: relative;
        }
        
        .lens-text {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            animation: rotateText 20s linear infinite;
            opacity: 0.7;
            pointer-events: none;
        }
        @keyframes rotateText { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .lens-text path { fill: none; }
        .lens-text text {
            fill: #5a8274;
            font-size: 10px;
            font-family: monospace;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .lens-glass {
            width: 82px;
            height: 82px;
            background: #1a1a1a;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 5px solid #2d2d2d;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.9);
            z-index: 1;
        }
        .lens-glass video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1);
            opacity: 0.9;
        }
        .lens-glass::before {
            content: '';
            position: absolute;
            top: 15%; left: 15%;
            width: 20px; height: 10px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            transform: rotate(-45deg);
            z-index: 3;
            pointer-events: none;
            filter: blur(1px);
        }
        
        .shutter-socket {
            position: absolute;
            top: 90px;
            left: 22px;
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, #aaddc8, #cbf0de);
            border-radius: 50%;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1), inset -1px -1px 2px rgba(255,255,255,0.8);
            z-index: 25;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .shutter-btn {
            width: 42px;
            height: 42px;
            background: radial-gradient(circle at 35% 35%, #e0fff4 0%, #a2dcc0 40%, #8bc4aa 100%);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 10px rgba(0,0,0,0.15), inset 2px 2px 5px rgba(255,255,255,1);
            transition: all 0.1s;
        }
        .shutter-btn:active {
            transform: scale(0.92) translateY(2px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.2), inset 3px 3px 8px rgba(0,0,0,0.2);
        }
        .shutter-inner {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 28px; height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(0,0,0,0.05), transparent);
            pointer-events: none;
        }
        
        .cam-brand {
            position: absolute;
            top: 10px;
            right: 8px;
            text-align: right;
            opacity: 0.5;
            pointer-events: none;
        }
        .cam-brand-name { font-size: 0.6em; color: #666; font-weight: bold; }
        .cam-brand-model { font-size: 0.85em; color: #555; font-weight: bold; line-height: 1; }
        
        /* ÊãçÁ´ãÂæóÂ∫ïÁâáÂãïÁï´ */
        .polaroid-film {
            position: absolute;
            top: 25px;
            right: 35px;
            width: 190px;
            height: 230px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            z-index: 5;
            display: none;
            transform: rotate(-5deg) scale(0.9);
            pointer-events: none;
            padding: 12px 12px 45px 12px;
            border-radius: 3px;
        }
        
        .polaroid-image-area {
            width: 100%;
            height: 165px;
            background-color: #1a1a1a;
            overflow: hidden;
            position: relative;
        }
        .polaroid-image-area img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 3s ease-in-out;
            filter: sepia(0.3) contrast(1.1) brightness(1.1) saturate(0.85);
        }
        .polaroid-image-area::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle, transparent 50%, rgba(0,0,0,0.3) 100%);
            pointer-events: none;
        }
        
        /* ÊãçÁ´ãÂæóËä±ÈÇäÊ®£Âºè */
        .frame-white { background: white; }
        .frame-black { background: #1a1a1a; color: #aaa; }
        .frame-mint { background: #d1fae5; }
        .frame-pink { background: #fce7f3; }
        .frame-floral {
            background-color: #fff0f5;
            background-image: radial-gradient(#ffb7b2 20%, transparent 20%), radial-gradient(#ffdac1 20%, transparent 20%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }
        .frame-plaid {
            background-color: #e0f2fe;
            background-image: repeating-linear-gradient(90deg, transparent, transparent 19px, #bae6fd 19px, #bae6fd 20px),
                              repeating-linear-gradient(0deg, transparent, transparent 19px, #bae6fd 19px, #bae6fd 20px);
        }
        .frame-gradient { background: linear-gradient(135deg, #fce7f3 0%, #e0f2fe 50%, #dcfce7 100%); }
        
        /* ÈÄÄÁâáÂãïÁï´ */
        @keyframes ejectFilm {
            0% { transform: translate(0, 0) rotate(0deg) scale(0.5); opacity: 0; z-index: 5; }
            30% { opacity: 1; transform: translate(50px, -150px) rotate(5deg) scale(0.8); z-index: 5; }
            60% { z-index: 25; }
            100% { transform: translate(120px, 60px) rotate(10deg) scale(1); z-index: 30; }
        }
        @media (max-width: 500px) {
            @keyframes ejectFilm {
                0% { transform: translate(0, 0) scale(0.5); opacity: 0; z-index: 5; }
                40% { transform: translate(15px, -100px) rotate(2deg) scale(0.8); z-index: 5; }
                60% { z-index: 25; }
                100% { transform: translate(0px, 220px) rotate(0deg) scale(1); z-index: 30; }
            }
        }
        .polaroid-film.ejecting {
            display: block;
            animation: ejectFilm 1s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }
        
        /* ÈñÉÂÖâÁáàÊïàÊûú */
        .cam-flash-overlay {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 9999;
        }
        @keyframes flashBurst { 0% { opacity: 0; } 10% { opacity: 1; } 100% { opacity: 0; } }
        .cam-flash-overlay.flash-active { animation: flashBurst 0.3s ease-out; }
        
        /* Êï£ËêΩÁÖßÁâáÂÆπÂô® */
        .polaroid-photos-container {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
        }
        
        /* Êï£ËêΩÁÖßÁâáÂç°Áâá */
        .polaroid-photo-card {
            position: absolute;
            width: 190px;
            padding: 12px 12px 12px 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 30;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: grab;
            pointer-events: auto;
            border-radius: 3px;
        }
        .polaroid-photo-card:hover {
            z-index: 100 !important;
            transform: scale(1.05) rotate(0deg) !important;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        .polaroid-photo-card:active { cursor: grabbing; }
        
        .polaroid-photo-close {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 22px;
            height: 22px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 50;
        }
        .polaroid-photo-card:hover .polaroid-photo-close { opacity: 1; }
        
        .polaroid-photo-text {
            margin-top: 10px;
            text-align: center;
            font-family: 'Pacifico', cursive;
            font-size: 0.85em;
        }
        
        .polaroid-photo-actions {
            margin-top: 8px;
            display: flex;
            gap: 6px;
        }
        .polaroid-photo-btn {
            flex: 1;
            padding: 5px;
            background: rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            transition: background 0.2s;
        }
        .polaroid-photo-btn:hover { background: rgba(0,0,0,0.1); }
        
        /* Ëä±ÈÇäÈÅ∏ÊìáÂô® */
        .frame-selector {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 100;
        }
        .frame-selector-label {
            font-size: 0.75em;
            color: #666;
            font-weight: bold;
            text-transform: uppercase;
        }
        .frame-options { display: flex; gap: 8px; }
        
        /* Áõ∏Ê©üÂàáÊèõÊåâÈàï */
        .camera-switch-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            margin-left: 8px;
        }
        .camera-switch-btn:active {
            transform: scale(0.9) rotate(180deg);
        }
        
        .frame-option {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid rgba(0,0,0,0.15);
            transition: all 0.2s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            position: relative;
        }
        .frame-option:active { transform: scale(0.9); }
        .frame-option.selected {
            border-color: #ec4899;
            transform: scale(1.2);
            box-shadow: 0 0 0 3px white, 0 0 0 6px #ec4899, 0 4px 10px rgba(0,0,0,0.2);
        }
        .frame-option::after {
            content: '';
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 8px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s;
            color: #333;
            font-weight: bold;
        }
        .frame-option.selected::after { opacity: 1; }
        .frame-option.frame-white::after { content: 'Á∂ìÂÖ∏ÁôΩ'; }
        .frame-option.frame-black::after { content: 'ÂÑ™ÈõÖÈªë'; }
        .frame-option.frame-mint::after { content: 'ËñÑËç∑Á∂†'; }
        .frame-option.frame-pink::after { content: 'ÁîúÁæéÁ≤â'; }
        .frame-option.frame-floral::after { content: 'Ëä±Âçâ'; }
        .frame-option.frame-plaid::after { content: 'Ê†ºÁ¥ã'; }
        .frame-option.frame-gradient::after { content: 'Êº∏Â±§'; }
        
        /* ÊãçÁÖßÊ®°ÂºèÈÅ∏Êìá */
        .camera-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .camera-mode-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-card);
            color: var(--text-light);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        .camera-mode-btn:hover { border-color: var(--cyan); }
        .camera-mode-btn.active {
            border-color: var(--pink);
            background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(168,85,247,0.1));
        }
        .camera-mode-icon { font-size: 1.8em; margin-bottom: 5px; }
        .camera-mode-label { font-size: 0.85em; font-weight: 600; }
    </style>
</head>
<body>
    <!-- üé¨ ÂïüÂãïÁï´Èù¢ -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <div class="logo-circle">
                    <div class="logo-plane">‚úàÔ∏è</div>
                </div>
                <div class="logo-ring"></div>
            </div>
            <div class="splash-title">ÊóÖÈÅäÁßòÊõ∏</div>
            <div class="splash-subtitle">ÊÇ®ÁöÑË≤ºÂøÉÊóÖÈÅäÂä©ÁêÜ</div>
            <div class="splash-loading">
                <div class="loading-dots">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
        <div class="splash-footer">Travel Secretary v6.0 - Polaroid Edition</div>
    </div>
    
    <div class="app-container">
        <header class="app-header">
            <div class="app-logo">‚úàÔ∏è ÊóÖÈÅäÁßòÊõ∏</div>
            <div class="header-actions">
                <button class="header-btn" onclick="showModal('exportModal')">üìä</button>
                <button class="header-btn" onclick="switchPage('settings')">‚öôÔ∏è</button>
            </div>
        </header>
        
        <main class="app-content">
            <!-- È¶ñÈ†Å -->
            <div id="page-home" class="page active">
                <div class="trip-banner">
                    <div class="trip-name" id="displayTripName">ÊàëÁöÑÊóÖË°å</div>
                    <div class="trip-dest" id="displayDestination">üåç ÈªûÊìä‰∏ãÊñπË®≠ÂÆöÁõÆÁöÑÂú∞</div>
                    <div class="trip-dates" id="displayDates">üìÖ Â∞öÊú™Ë®≠ÂÆöÊó•Êúü</div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-value cyan" id="statDays">0</div>
                        <div class="stat-label">Â§©Êï∏</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value orange" id="statExpenseJPY">¬•0</div>
                        <div class="stat-label">Êó•Âπ£Ëä±Ë≤ª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value emerald" id="statExpenseTWD">$0</div>
                        <div class="stat-label">Âè∞Âπ£Ëä±Ë≤ª</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">üéØ</div>
                        <div><div class="card-title">ÊóÖÈÅäË®≠ÂÆö</div><div class="card-subtitle">Ë®≠ÂÆöÊÇ®ÁöÑÊóÖË°åË≥áË®ä</div></div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÊóÖÈÅäÂêçÁ®±</label>
                        <input type="text" class="input-field" id="tripName" placeholder="‰æãÔºö2025 Êù±‰∫¨Ëá™Áî±Ë°å" onchange="updateTripInfo()">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÁõÆÁöÑÂú∞</label>
                        <select class="input-field" id="destination" onchange="handleDestinationChange()">
                            <option value="">Ë´ãÈÅ∏ÊìáÁõÆÁöÑÂú∞</option>
                            <optgroup label="üåè ‰∫ûÊ¥≤">
                                <option value="üáØüáµ Êù±‰∫¨">üáØüáµ Êù±‰∫¨</option>
                                <option value="üáØüáµ Â§ßÈò™">üáØüáµ Â§ßÈò™</option>
                                <option value="üáØüáµ ‰∫¨ÈÉΩ">üáØüáµ ‰∫¨ÈÉΩ</option>
                                <option value="üáØüáµ ÂåóÊµ∑ÈÅì">üáØüáµ ÂåóÊµ∑ÈÅì</option>
                                <option value="üáØüáµ Ê≤ñÁπ©">üáØüáµ Ê≤ñÁπ©</option>
                                <option value="üá∞üá∑ È¶ñÁàæ">üá∞üá∑ È¶ñÁàæ</option>
                                <option value="üá∞üá∑ ÈáúÂ±±">üá∞üá∑ ÈáúÂ±±</option>
                                <option value="üá∞üá∑ ÊøüÂ∑ûÂ≥∂">üá∞üá∑ ÊøüÂ∑ûÂ≥∂</option>
                                <option value="üáπüá≠ ÊõºË∞∑">üáπüá≠ ÊõºË∞∑</option>
                                <option value="üáπüá≠ Ê∏ÖÈÇÅ">üáπüá≠ Ê∏ÖÈÇÅ</option>
                                <option value="üáπüá≠ ÊôÆÂêâÂ≥∂">üáπüá≠ ÊôÆÂêâÂ≥∂</option>
                                <option value="üá∏üá¨ Êñ∞Âä†Âù°">üá∏üá¨ Êñ∞Âä†Âù°</option>
                                <option value="üáªüá≥ Ê≤≥ÂÖß">üáªüá≥ Ê≤≥ÂÖß</option>
                                <option value="üáªüá≥ ËÉ°ÂøóÊòéÂ∏Ç">üáªüá≥ ËÉ°ÂøóÊòéÂ∏Ç</option>
                                <option value="üá≠üá∞ È¶ôÊ∏Ø">üá≠üá∞ È¶ôÊ∏Ø</option>
                                <option value="üá≤üá¥ Êæ≥ÈñÄ">üá≤üá¥ Êæ≥ÈñÄ</option>
                                <option value="üá≤üáæ ÂêâÈöÜÂù°">üá≤üáæ ÂêâÈöÜÂù°</option>
                                <option value="üáÆüá© Â≥áÈáåÂ≥∂">üáÆüá© Â≥áÈáåÂ≥∂</option>
                                <option value="üáµüá≠ Èï∑ÁÅòÂ≥∂">üáµüá≠ Èï∑ÁÅòÂ≥∂</option>
                                <option value="üá®üá≥ ‰∏äÊµ∑">üá®üá≥ ‰∏äÊµ∑</option>
                                <option value="üá®üá≥ Âåó‰∫¨">üá®üá≥ Âåó‰∫¨</option>
                            </optgroup>
                            <optgroup label="üåç Ê≠êÊ¥≤">
                                <option value="üá´üá∑ Â∑¥Èªé">üá´üá∑ Â∑¥Èªé</option>
                                <option value="üá¨üáß ÂÄ´Êï¶">üá¨üáß ÂÄ´Êï¶</option>
                                <option value="üáÆüáπ ÁæÖÈ¶¨">üáÆüáπ ÁæÖÈ¶¨</option>
                                <option value="üáÆüáπ Â®ÅÂ∞ºÊñØ">üáÆüáπ Â®ÅÂ∞ºÊñØ</option>
                                <option value="üá™üá∏ Â∑¥Â°ûÈöÜÁ¥ç">üá™üá∏ Â∑¥Â°ûÈöÜÁ¥ç</option>
                                <option value="üá©üá™ ÊÖïÂ∞ºÈªë">üá©üá™ ÊÖïÂ∞ºÈªë</option>
                                <option value="üá≥üá± ÈòøÂßÜÊñØÁâπ‰∏π">üá≥üá± ÈòøÂßÜÊñØÁâπ‰∏π</option>
                                <option value="üá®üá≠ ËòáÈªé‰∏ñ">üá®üá≠ ËòáÈªé‰∏ñ</option>
                                <option value="üá¶üáπ Á∂≠‰πüÁ¥ç">üá¶üáπ Á∂≠‰πüÁ¥ç</option>
                                <option value="üá®üáø Â∏ÉÊãâÊ†º">üá®üáø Â∏ÉÊãâÊ†º</option>
                                <option value="üá¨üá∑ ÈõÖÂÖ∏">üá¨üá∑ ÈõÖÂÖ∏</option>
                                <option value="üá¨üá∑ ËÅñÊâòÈáåÂ∞º">üá¨üá∑ ËÅñÊâòÈáåÂ∞º</option>
                                <option value="üáµüáπ ÈáåÊñØÊú¨">üáµüáπ ÈáåÊñØÊú¨</option>
                            </optgroup>
                            <optgroup label="üåé ÂåóÁæéÊ¥≤">
                                <option value="üá∫üá∏ Á¥êÁ¥Ñ">üá∫üá∏ Á¥êÁ¥Ñ</option>
                                <option value="üá∫üá∏ Ê¥õÊùâÁ£Ø">üá∫üá∏ Ê¥õÊùâÁ£Ø</option>
                                <option value="üá∫üá∏ ËàäÈáëÂ±±">üá∫üá∏ ËàäÈáëÂ±±</option>
                                <option value="üá∫üá∏ ÊãâÊñØÁ∂≠Âä†ÊñØ">üá∫üá∏ ÊãâÊñØÁ∂≠Âä†ÊñØ</option>
                                <option value="üá∫üá∏ Â§èÂ®ÅÂ§∑">üá∫üá∏ Â§èÂ®ÅÂ§∑</option>
                                <option value="üá®üá¶ Ê∫´Âì•ËèØ">üá®üá¶ Ê∫´Âì•ËèØ</option>
                                <option value="üá®üá¶ Â§öÂÄ´Â§ö">üá®üá¶ Â§öÂÄ´Â§ö</option>
                                <option value="üá≤üáΩ ÂùéÊòÜ">üá≤üáΩ ÂùéÊòÜ</option>
                            </optgroup>
                            <optgroup label="üåè Â§ßÊ¥ãÊ¥≤">
                                <option value="üá¶üá∫ Èõ™Ê¢®">üá¶üá∫ Èõ™Ê¢®</option>
                                <option value="üá¶üá∫ Â¢®ÁàæÊú¨">üá¶üá∫ Â¢®ÁàæÊú¨</option>
                                <option value="üá≥üáø Â•ßÂÖãËò≠">üá≥üáø Â•ßÂÖãËò≠</option>
                                <option value="üá≥üáø ÁöáÂêéÈéÆ">üá≥üáø ÁöáÂêéÈéÆ</option>
                            </optgroup>
                            <optgroup label="üåç ÈùûÊ¥≤">
                                <option value="üáøüá¶ ÈñãÊôÆÊï¶">üáøüá¶ ÈñãÊôÆÊï¶</option>
                                <option value="üá™üá¨ ÈñãÁæÖ">üá™üá¨ ÈñãÁæÖ</option>
                                <option value="üá≤üá¶ È¶¨ÊãâÂñÄ‰ªÄ">üá≤üá¶ È¶¨ÊãâÂñÄ‰ªÄ</option>
                                <option value="üá∞üá™ Â•àÊ¥õÊØî">üá∞üá™ Â•àÊ¥õÊØî</option>
                            </optgroup>
                            <optgroup label="‚úèÔ∏è Ëá™Ë®Ç">
                                <option value="custom">‚úèÔ∏è Ëá™Ë®ÇÁõÆÁöÑÂú∞...</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="input-group" id="customDestGroup" style="display:none;">
                        <input type="text" class="input-field" id="customDestination" placeholder="Ëº∏ÂÖ•Ëá™Ë®ÇÁõÆÁöÑÂú∞" onchange="updateTripInfo()">
                    </div>
                    
                    <div class="input-row" style="margin-bottom:14px;">
                        <div class="input-group">
                            <label class="input-label">Âá∫ÁôºÊó•Êúü</label>
                            <input type="date" class="input-field" id="startDate" onchange="updateTripInfo()">
                        </div>
                        <div class="input-group">
                            <label class="input-label">ÁµêÊùüÊó•Êúü</label>
                            <input type="date" class="input-field" id="endDate" onchange="updateTripInfo()">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">‰∏ªË¶ÅÂπ£Âà•</label>
                        <select class="input-field" id="mainCurrency" onchange="saveData()">
                            <optgroup label="üåè ‰∫ûÊ¥≤">
                                <option value="JPY">üáØüáµ Êó•Âπ£ (JPY)</option>
                                <option value="KRW">üá∞üá∑ ÈüìÂÖÉ (KRW)</option>
                                <option value="THB">üáπüá≠ Ê≥∞Èäñ (THB)</option>
                                <option value="SGD">üá∏üá¨ Êñ∞Âπ£ (SGD)</option>
                                <option value="VND">üáªüá≥ Ë∂äÁõæ (VND)</option>
                                <option value="HKD">üá≠üá∞ Ê∏ØÂπ£ (HKD)</option>
                                <option value="MOP">üá≤üá¥ Êæ≥ÈñÄÂπ£ (MOP)</option>
                                <option value="MYR">üá≤üáæ È¶¨Âπ£ (MYR)</option>
                                <option value="IDR">üáÆüá© Âç∞Â∞ºÁõæ (IDR)</option>
                                <option value="PHP">üáµüá≠ Êä´Á¥¢ (PHP)</option>
                                <option value="CNY">üá®üá≥ ‰∫∫Ê∞ëÂπ£ (CNY)</option>
                            </optgroup>
                            <optgroup label="üåç Ê≠êÊ¥≤">
                                <option value="EUR">üá™üá∫ Ê≠êÂÖÉ (EUR)</option>
                                <option value="GBP">üá¨üáß Ëã±Èéä (GBP)</option>
                                <option value="CHF">üá®üá≠ ÁëûÂ£´Ê≥ïÈÉé (CHF)</option>
                                <option value="CZK">üá®üáø Êç∑ÂÖãÂÖãÊúó (CZK)</option>
                            </optgroup>
                            <optgroup label="üåé ÁæéÊ¥≤/Â§ßÊ¥ãÊ¥≤">
                                <option value="USD">üá∫üá∏ ÁæéÈáë (USD)</option>
                                <option value="CAD">üá®üá¶ Âä†Âπ£ (CAD)</option>
                                <option value="MXN">üá≤üáΩ Â¢®Ë•øÂì•Êä´Á¥¢ (MXN)</option>
                                <option value="AUD">üá¶üá∫ Êæ≥Âπ£ (AUD)</option>
                                <option value="NZD">üá≥üáø Á¥êÂπ£ (NZD)</option>
                            </optgroup>
                            <optgroup label="üåç ÈùûÊ¥≤">
                                <option value="ZAR">üáøüá¶ ÂçóÈùûËò≠Áâπ (ZAR)</option>
                                <option value="EGP">üá™üá¨ ÂüÉÂèäÈéä (EGP)</option>
                                <option value="MAD">üá≤üá¶ Êë©Ê¥õÂì•Ëø™ÊãâÂßÜ (MAD)</option>
                                <option value="KES">üá∞üá™ ËÇØ‰∫ûÂÖà‰ª§ (KES)</option>
                            </optgroup>
                            <optgroup label="üáπüáº Âè∞ÁÅ£">
                                <option value="TWD">üáπüáº Âè∞Âπ£ (TWD)</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                
                <!-- üÜï Ëá™ÂãïÁî¢ÁîüË°åÁ®ãÊåâÈàï -->
                <button class="btn auto-generate-btn" onclick="showAutoGenerateModal()">
                    ‚ú® Ëá™ÂãïÁî¢ÁîüÂª∫Ë≠∞Ë°åÁ®ã
                </button>
                
                <!-- üÜï ÊâãÂãïÂª∫Á´ãË°åÁ®ãË°®ÊåâÈàï -->
                <button class="btn btn-outline" style="width:100%;margin-top:10px;" onclick="manualGenerateDays()">
                    üìÖ Âª∫Á´ã/Êõ¥Êñ∞Ë°åÁ®ãË°®
                </button>
                
                <!-- üÜï Ê∏ÖÈô§Ê≠§Ê¨°ÊóÖË°åÊåâÈàï -->
                <button class="btn btn-outline" style="width:100%;margin-top:10px;border-color:#ef4444;color:#ef4444;" onclick="clearCurrentTrip()">
                    üóëÔ∏è Ê∏ÖÈô§Ê≠§Ê¨°ÊóÖË°åÔºàÈñãÂßãÊñ∞ÊóÖÈÅäÔºâ
                </button>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon purple">‚ö°</div>
                        <div><div class="card-title">Âø´ÈÄüÂäüËÉΩ</div></div>
                    </div>
                    <div class="stats-row" style="margin-bottom:0;">
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('itinerary')">
                            <div style="font-size:1.5em;">üìÖ</div>
                            <div class="stat-label">Ë°åÁ®ã</div>
                        </div>
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('expense')">
                            <div style="font-size:1.5em;">üí∞</div>
                            <div class="stat-label">Ë®òÂ∏≥</div>
                        </div>
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('shopping')">
                            <div style="font-size:1.5em;">üõí</div>
                            <div class="stat-label">Ë≥ºÁâ©</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ë°åÁ®ãÈ†ÅÈù¢ -->
            <div id="page-itinerary" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">üìÖ</div>
                        <div><div class="card-title">ÊØèÊó•Ë°åÁ®ã</div><div class="card-subtitle">Ë¶èÂäÉÊÇ®ÁöÑÊóÖÈÅäË°åÁ®ã</div></div>
                    </div>
                    <div class="action-row" style="margin-bottom:10px;">
                        <button class="btn btn-primary btn-sm" onclick="showAddScheduleModalGlobal()" style="flex:1;">‚ûï Êñ∞Â¢ûË°åÁ®ã</button>
                    </div>
                    <div class="action-row" style="margin-bottom:0;">
                        <button class="btn btn-outline btn-sm" onclick="showBatchReminderModal()">üîî ÊâπÊ¨°Ë®≠ÂÆöÊèêÈÜí</button>
                        <button class="btn btn-secondary btn-sm" onclick="syncAllToGoogleCalendar()">üìÜ ÂêåÊ≠•ÂÖ®ÈÉ®</button>
                    </div>
                </div>
                
                <div id="itineraryList"></div>
                
                <button class="btn btn-outline" onclick="showAddDayModal()" style="margin-top:10px;">‚ûï Êñ∞Â¢û‰∏ÄÂ§©</button>
            </div>
            
            <!-- Ë®òÂ∏≥È†ÅÈù¢ -->
            <div id="page-expense" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon orange">üí∞</div>
                        <div><div class="card-title">ÊóÖÈÅäË®òÂ∏≥</div><div class="card-subtitle">Ë®òÈåÑÊÇ®ÁöÑËä±Ë≤ªÔºåËá™ÂãïÊèõÁÆóÂè∞Âπ£</div></div>
                    </div>
                    
                    <!-- üí∞ È†êÁÆóÂÆàË≠∑Áí∞ Budget Ring -->
                    <div class="budget-ring-section">
                        <div class="budget-ring-container">
                            <svg class="budget-ring" viewBox="0 0 100 100">
                                <circle class="ring-bg" cx="50" cy="50" r="42" />
                                <circle class="ring-progress" id="budgetRingProgress" cx="50" cy="50" r="42" />
                            </svg>
                            <div class="ring-center">
                                <div class="ring-percent" id="budgetPercent">0%</div>
                                <div class="ring-label">Â∑≤‰ΩøÁî®</div>
                            </div>
                        </div>
                        <div class="budget-info">
                            <div class="budget-row">
                                <span>üíé Á∏ΩÈ†êÁÆó</span>
                                <span class="budget-value" id="budgetTotal">NT$0</span>
                            </div>
                            <div class="budget-row">
                                <span>üí∏ Â∑≤Ëä±Ë≤ª</span>
                                <span class="budget-value spent" id="budgetSpent">NT$0</span>
                            </div>
                            <div class="budget-row">
                                <span>üí∞ Ââ©È§ò</span>
                                <span class="budget-value remain" id="budgetRemain">NT$0</span>
                            </div>
                            <button class="btn btn-sm" onclick="showBudgetModal()" style="margin-top:8px;width:100%;">‚öôÔ∏è Ë®≠ÂÆöÈ†êÁÆó</button>
                        </div>
                    </div>
                    
                    <div class="stats-row">
                        <div class="stat-card">
                            <div class="stat-value orange" id="expenseJPY">¬•0</div>
                            <div class="stat-label" id="expenseForeignLabel">Â§ñÂπ£</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value emerald" id="expenseTWD">NT$0</div>
                            <div class="stat-label">‚âà Âè∞Âπ£Á∏ΩË®à</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value pink" id="expenseCount">0</div>
                            <div class="stat-label">Á≠Ü</div>
                        </div>
                    </div>
                    
                    <!-- ÊîØ‰ªòÊñπÂºèÁµ±Ë®à -->
                    <div id="paymentSummary" style="display:none;margin-bottom:12px;">
                        <div style="font-size:0.85em;color:var(--text-dim);margin-bottom:8px;">üìä ÊîØ‰ªòÊñπÂºèÁµ±Ë®à</div>
                        <div id="paymentBreakdown" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
                    </div>
                    
                    <div class="input-group">
                        <select class="input-field" id="expenseFilterDate" onchange="renderExpenses()">
                            <option value="all">ÂÖ®ÈÉ®Êó•Êúü</option>
                        </select>
                    </div>
                </div>
                
                <!-- üë• ÂàÜÂ∏≥ÁµêÁÆóÂçÄÂ°ä -->
                <div class="card" id="splitSummaryCard" style="display:none;">
                    <div class="card-header">
                        <div class="card-icon orange">üë•</div>
                        <div><div class="card-title">ÂàÜÂ∏≥ÁµêÁÆó</div><div class="card-subtitle">Ë™∞Ë©≤Áµ¶Ë™∞Â§öÂ∞ëÈå¢</div></div>
                    </div>
                    <div id="splitSummary"></div>
                </div>
                
                <div id="expenseList"></div>
                <button class="fab" onclick="showAddExpenseModal()">‚ûï</button>
            </div>
            
            <!-- Ë≥ºÁâ©Ê∏ÖÂñÆÈ†ÅÈù¢ -->
            <div id="page-shopping" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon pink">üõí</div>
                        <div><div class="card-title">Ë≥ºÁâ©Ê∏ÖÂñÆ</div><div class="card-subtitle">ÊÉ≥Ë≤∑ÁöÑÊù±Ë•ø</div></div>
                    </div>
                    <div style="display:flex;justify-content:space-between;font-size:0.85em;color:var(--text-dim);">
                        <span>ÂÆåÊàêÈÄ≤Â∫¶</span>
                        <span id="shoppingProgress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="shoppingProgressBar" style="width:0%"></div>
                    </div>
                </div>
                <div id="shoppingList"></div>
                <button class="fab" onclick="showAddShoppingModal()">‚ûï</button>
            </div>
            
            <!-- üì∏ ÊôØÈªûÊâìÂç°È†ÅÈù¢ -->
            <div id="page-checkin" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon pink">üì∏</div>
                        <div><div class="card-title">ÊôØÈªûÊâìÂç°</div><div class="card-subtitle">Ë®òÈåÑÊóÖÈÄî‰∏≠ÁöÑÊØè‰∏ÄÂàª</div></div>
                    </div>
                    
                    <!-- Áµ±Ë®àÂç°Áâá -->
                    <div class="checkin-stats">
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">üì∑</div>
                            <div class="checkin-stat-value pink" id="checkinPhotoCount">0</div>
                            <div class="checkin-stat-label">ÂºµÁÖßÁâá</div>
                        </div>
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">üìç</div>
                            <div class="checkin-stat-value gold" id="checkinSpotCount">0/0</div>
                            <div class="checkin-stat-label">ÊôØÈªûÊâìÂç°</div>
                        </div>
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">üèÜ</div>
                            <div class="checkin-stat-value cyan" id="checkinBadgeCount">0</div>
                            <div class="checkin-stat-label">ÊàêÂ∞±</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÂàÜÈ†ÅÊ®ôÁ±§ -->
                <div class="checkin-tab-bar">
                    <button class="checkin-tab active" onclick="switchCheckinTab('spots')">üìç ÊôØÈªû</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('photos')">üì∑ ÁÖßÁâá</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('badges')">üèÜ ÊàêÂ∞±</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('memoir')">üìñ ÂõûÊÜ∂</button>
                </div>
                
                <!-- ÊôØÈªûÊ∏ÖÂñÆ -->
                <div id="checkinSectionSpots" class="checkin-section active">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                        <span style="font-weight:600;">üìç ÊàëÁöÑÊôØÈªûÊ∏ÖÂñÆ</span>
                        <button class="btn btn-primary btn-sm" onclick="showAddSpotModal()">‚ûï Êñ∞Â¢û</button>
                    </div>
                    <div id="spotList">
                        <div class="empty-state">
                            <div class="empty-icon">üìç</div>
                            <div>ÈÇÑÊ≤íÊúâÊôØÈªû</div>
                            <div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">Êñ∞Â¢ûÊÉ≥ÂéªÁöÑÊôØÈªûÈñãÂßãÊâìÂç°ÂêßÔºÅ</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÁÖßÁâáÁâÜ -->
                <div id="checkinSectionPhotos" class="checkin-section">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                        <span style="font-weight:600;">üì∑ ÊâìÂç°ÁÖßÁâá</span>
                        <button class="btn btn-primary btn-sm" onclick="showAddCheckinModal()">üì∏ ÊãçÁÖßÊâìÂç°</button>
                    </div>
                    <div id="checkinPhotoGrid" class="checkin-grid">
                        <div class="empty-state" style="grid-column:1/-1;">
                            <div class="empty-icon">üì∑</div>
                            <div>ÈÇÑÊ≤íÊúâÁÖßÁâá</div>
                            <div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">‰∏äÂÇ≥ÁÖßÁâáË®òÈåÑÁæéÂ•ΩÊôÇÂàªÔºÅ</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÊàêÂ∞±ÂæΩÁ´† -->
                <div id="checkinSectionBadges" class="checkin-section">
                    <div style="font-weight:600;margin-bottom:12px;">üèÜ ÊóÖÈÅäÊàêÂ∞±</div>
                    <div id="badgeGrid" class="badge-grid"></div>
                </div>
                
                <!-- ÂõûÊÜ∂ÈåÑ -->
                <div id="checkinSectionMemoir" class="checkin-section">
                    <div style="font-weight:600;margin-bottom:12px;">üìñ ÊóÖÈÅäÂõûÊÜ∂ÈåÑ</div>
                    <div id="memoirTimeline"></div>
                    
                    <!-- üì§ ÂåØÂá∫ÂäüËÉΩÂçÄ -->
                    <div class="card" style="margin-top:20px;">
                        <div style="font-size:0.9em;font-weight:600;margin-bottom:12px;">üì§ ÂåØÂá∫ÂõûÊÜ∂</div>
                        <div style="display:flex;flex-direction:column;gap:10px;">
                            <button class="btn btn-primary btn-sm" style="width:100%;" onclick="exportMemoirHtml()">
                                üìÑ ÂåØÂá∫ HTML ÂõûÊÜ∂ÈåÑÔºàÂê´ÁÖßÁâáÔºåÂèØÈõ¢Á∑öÔºâ
                            </button>
                            <button class="btn btn-secondary btn-sm" style="width:100%;" onclick="exportMemoirToGoogleDoc()">
                                üìù ÂåØÂá∫Âà∞ Google DocÔºàÂê´ÁÖßÁâá+ÈªûÊª¥Ôºâ
                            </button>
                            <button class="btn btn-secondary btn-sm" style="width:100%;background:linear-gradient(135deg,#ea4335,#fbbc05,#34a853,#4285f4);border:none;" onclick="exportToGooglePhotos()">
                                üñºÔ∏è ‰∏äÂÇ≥Âà∞ Google Áõ∏Á∞ø
                            </button>
                            <button class="btn btn-outline btn-sm" style="width:100%;" onclick="downloadAllPhotos()">
                                üì∏ ‰∏ãËºâÊâÄÊúâÁÖßÁâáÔºàZIP ÊâìÂåÖÔºâ
                            </button>
                        </div>
                        <p style="font-size:0.75em;color:var(--text-dim);margin-top:10px;text-align:center;">
                            üí° Google Áõ∏Á∞øÊúÉÂª∫Á´ãÂ∞àÂ±¨Áõ∏Á∞øÔºå‰øùÁïôÂéüÂßãÁï´Ë≥™
                        </p>
                    </div>
                    
                    <!-- ÂõûÊÜ∂ÁÆ°ÁêÜÂçÄ -->
                    <div class="card" style="margin-top:15px;background:var(--bg-dark);">
                        <div style="font-size:0.9em;color:var(--text-dim);margin-bottom:10px;">üì∏ ÂõûÊÜ∂ÁÆ°ÁêÜ</div>
                        <p style="font-size:0.8em;color:var(--text-dim);margin-bottom:12px;">
                            üí° ÊâìÂç°ÁÖßÁâá„ÄÅÊóÖÈÅäÈªûÊª¥ÂíåÊàêÂ∞±ÊúÉÊ∞∏‰πÖ‰øùÁïôÔºå‰∏çÊúÉÂõ†ÁÇ∫„ÄåÊ∏ÖÈô§ÊóÖÁ®ã„ÄçËÄåÊ∂àÂ§±
                        </p>
                        <button class="btn btn-outline btn-sm" style="width:100%;border-color:#ef4444;color:#ef4444;" onclick="clearCheckinMemories()">
                            üóëÔ∏è Ê∏ÖÈô§ÊâÄÊúâÊâìÂç°ÂõûÊÜ∂ÔºàÂÉÖÂú®ÈúÄË¶ÅÊôÇ‰ΩøÁî®Ôºâ
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Ë®≠ÂÆöÈ†ÅÈù¢ -->
            <div id="page-settings" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">üìÜ</div>
                        <div><div class="card-title">Google Êó•ÊõÜ</div><div class="card-subtitle">ÂêåÊ≠•Ë°åÁ®ãÂà∞ Google Calendar</div></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Google OAuth Client ID</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="googleClientId" placeholder="Ëº∏ÂÖ• Client ID" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('googleClientId')">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <button class="btn btn-outline btn-sm" onclick="handleGoogleAuthorize()">üîê ÊéàÊ¨ä Google Êó•ÊõÜ</button>
                    <button class="btn btn-outline btn-sm" onclick="reauthorizeGoogle()" style="margin-top:8px;border-color:var(--orange);color:var(--orange);">üîÑ ÈáçÊñ∞ÊéàÊ¨ä GoogleÔºàÂê´ DriveÔºâ</button>
                    <div id="googleAuthStatus" class="auth-status" style="display:none;"></div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon emerald">üîî</div>
                        <div><div class="card-title">LINE ÊèêÈÜíË®≠ÂÆö</div><div class="card-subtitle">Ë®≠ÂÆöË°åÁ®ãÊèêÈÜíÈÄöÁü•</div></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">LINE Channel Access Token</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="lineToken" placeholder="Ë≤º‰∏äÊÇ®ÁöÑ Token" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('lineToken')">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">LINE User ID</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="lineUserId" placeholder="ÊÇ®ÁöÑ LINE User ID" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('lineUserId')">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">GAS Web App URL</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="gasUrl" placeholder="https://script.google.com/..." onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('gasUrl')">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">GAS Secret Key</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="gasSecret" placeholder="ÊÇ®Ë®≠ÂÆöÁöÑÊöóËôü" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('gasSecret')">üëÅÔ∏è</button>
                        </div>
                    </div>
                    <div class="action-row">
                        <button class="btn btn-outline btn-sm" onclick="testLineNotification()">üì® Ê∏¨Ë©¶ÈÄöÁü•</button>
                        <button class="btn btn-secondary btn-sm" onclick="viewSchedules()">üìã Êü•ÁúãÊéíÁ®ã</button>
                    </div>
                    <button class="btn btn-danger btn-sm" style="margin-top:10px;" onclick="clearAllSchedules()">üóëÔ∏è Ê∏ÖÈô§ÂÖ®ÈÉ®ÊéíÁ®ã</button>
                </div>
                
                <!-- üë• ÊóÖ‰º¥ÁÆ°ÁêÜ -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon orange">üë•</div>
                        <div><div class="card-title">ÊóÖ‰º¥ÁÆ°ÁêÜ</div><div class="card-subtitle">Ë®≠ÂÆöÂàÜÂ∏≥ÊàêÂì°</div></div>
                    </div>
                    <div id="membersList" style="margin-bottom:12px;"></div>
                    <div class="input-row-btn">
                        <input type="text" class="input-field" id="newMemberName" placeholder="Ëº∏ÂÖ•ÊóÖ‰º¥ÂêçÁ®±">
                        <button class="input-btn" onclick="addMember()" style="background:var(--emerald);">‚ûï</button>
                    </div>
                    <p style="color:var(--text-dim);font-size:0.75em;margin-top:8px;">üí° Êñ∞Â¢ûÊóÖ‰º¥ÂæåÔºåË®òÂ∏≥ÊôÇÂèØÈÅ∏ÊìáÂ¢ä‰ªò‰∫∫ËàáÂàÜÊî§Â∞çË±°</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon purple">üíæ</div>
                        <div><div class="card-title">Ë≥áÊñôÁÆ°ÁêÜ</div></div>
                    </div>
                    <div class="setting-item">
                        <div style="display:flex;align-items:center;">
                            <span style="font-size:1.2em;margin-right:12px;">üíæ</span>
                            <div class="setting-info">
                                <div class="setting-label">Êú¨Ê©üÂÑ≤Â≠ò</div>
                                <div class="setting-status">Ëá™Âãï‰øùÂ≠òË≥áÊñô</div>
                            </div>
                        </div>
                        <div class="toggle active" id="storageToggle" onclick="toggleStorage()"></div>
                    </div>
                    <div class="action-row">
                        <button class="btn btn-outline btn-sm" onclick="exportToExcel()">üìä ÂåØÂá∫ Excel</button>
                        <button class="btn btn-danger btn-sm" onclick="clearAllData()">üóëÔ∏è Ê∏ÖÈô§Ë≥áÊñô</button>
                    </div>
                </div>
            </div>
            
            <!-- Ë∂£Âë≥Â∑•ÂÖ∑È†ÅÈù¢ -->
            <div id="page-funtools" class="page">
                <div class="fun-tools-grid">
                    <div class="fun-tool-card active" onclick="switchFunTool('roulette')">
                        <div class="fun-tool-icon">üé∞</div>
                        <div class="fun-tool-name">Ëº™Áõ§Ê±∫ÂÆö</div>
                        <div class="fun-tool-desc">Èö®Ê©üÊ±∫ÂÆöÂÅö‰ªÄÈ∫º</div>
                    </div>
                    <div class="fun-tool-card" onclick="switchFunTool('chemistry')">
                        <div class="fun-tool-icon">üíë</div>
                        <div class="fun-tool-name">ÈªòÂ•ëÊ∏¨Ë©¶</div>
                        <div class="fun-tool-desc">Ê∏¨Ë©¶ÊóÖ‰º¥ÈªòÂ•ë</div>
                    </div>
                    <div class="fun-tool-card" onclick="switchFunTool('price')">
                        <div class="fun-tool-icon">üí±</div>
                        <div class="fun-tool-name">Áâ©ÂÉπÊèõÁÆó</div>
                        <div class="fun-tool-desc">ÂÖ®ÁêÉË≤®Âπ£ÊèõÁÆó</div>
                    </div>
                    <div class="fun-tool-card" onclick="switchFunTool('bingo')">
                        <div class="fun-tool-icon">üéØ</div>
                        <div class="fun-tool-name">ÊóÖÈÅäBingo</div>
                        <div class="fun-tool-desc">Ë≥ìÊûúÈÄ£Á∑öÊåëÊà∞</div>
                    </div>
                    <div class="fun-tool-card" onclick="switchFunTool('weather')">
                        <div class="fun-tool-icon">üëï</div>
                        <div class="fun-tool-name">Â§©Ê∞£Á©øÊê≠</div>
                        <div class="fun-tool-desc">Á©øËëóÂª∫Ë≠∞</div>
                    </div>
                    <div class="fun-tool-card" onclick="switchFunTool('mood')">
                        <div class="fun-tool-icon">üå°Ô∏è</div>
                        <div class="fun-tool-name">ÂøÉÊÉÖÊó•Ë®ò</div>
                        <div class="fun-tool-desc">Ë®òÈåÑÊóÖÈÅäÂøÉÊÉÖ</div>
                    </div>
                </div>
                
                <!-- Ëº™Áõ§Â∑•ÂÖ∑ -->
                <div id="funPanel-roulette" class="fun-panel active">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon cyan">üé∞</div>
                            <div><div class="card-title">ÊóÖÈÅäËº™Áõ§</div><div class="card-subtitle">‰∏çÁü•ÈÅìÂÅö‰ªÄÈ∫ºÔºüËΩâ‰∏Ä‰∏ãÔºÅ</div></div>
                        </div>
                        <div class="input-row-btn" style="margin-bottom:12px;">
                            <input type="text" class="input-field" id="rouletteInput" placeholder="Ëº∏ÂÖ•ÈÅ∏È†ÖÔºå‰æãÔºöÂêÉÊãâÈ∫µ">
                            <button class="input-btn" onclick="addRouletteOption()" style="background:var(--cyan);">+</button>
                        </div>
                        <div class="tag-list" id="rouletteOptions"></div>
                        <div class="roulette-container">
                            <div style="position:relative;">
                                <div class="roulette-pointer"></div>
                                <div class="roulette-wheel" id="rouletteWheel"></div>
                                <div class="roulette-center">üéØ</div>
                            </div>
                            <button class="btn btn-primary" onclick="spinRoulette()" style="margin-top:20px;">üé≤ ËΩâÂãïËº™Áõ§</button>
                            <div class="roulette-result" id="rouletteResult">
                                <div style="font-size:0.85em;color:var(--text-muted);margin-bottom:6px;">üéâ ‰ªäÂ§©Â∞±Ê±∫ÂÆöÊòØ...</div>
                                <div class="roulette-result-text" id="rouletteResultText"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÈªòÂ•ëÊ∏¨Ë©¶ -->
                <div id="funPanel-chemistry" class="fun-panel">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon purple">üíë</div>
                            <div><div class="card-title">ÊóÖ‰º¥ÈªòÂ•ëÊ∏¨Ë©¶</div><div class="card-subtitle">ÁúãÁúã‰Ω†ÂÄëÊúâÂ§öÊúâÈªòÂ•ëÔºÅ</div></div>
                        </div>
                        <div class="player-tabs" id="playerTabs">
                            <button class="player-tab active" onclick="switchPlayer(0)">üë§ ÊóÖ‰º¥ A</button>
                            <button class="player-tab" onclick="switchPlayer(1)">üë§ ÊóÖ‰º¥ B</button>
                        </div>
                        <div id="chemistryQuestions"></div>
                        <div class="action-row">
                            <button class="btn btn-outline btn-sm" onclick="resetChemistry()">üîÑ ÈáçÊñ∞ÈñãÂßã</button>
                            <button class="btn btn-primary btn-sm" onclick="revealChemistry()">‚ú® Êè≠ÊõâÁµêÊûú</button>
                        </div>
                        <div id="chemistryResults" style="margin-top:16px;"></div>
                    </div>
                </div>
                
                <!-- Áâ©ÂÉπÊèõÁÆó -->
                <div id="funPanel-price" class="fun-panel">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon orange">üí±</div>
                            <div><div class="card-title">Áï∞ÂúãÁâ©ÂÉπÊÑüË¶∫Âô®</div><div class="card-subtitle">ÂÖ®ÁêÉ 30+ Á®ÆË≤®Âπ£Âç≥ÊôÇÊèõÁÆó</div></div>
                        </div>
                        <div class="currency-search">
                            <input type="text" class="input-field" id="currencySearch" placeholder="üîç ÊêúÂ∞ãË≤®Âπ£..." oninput="filterCurrencies()">
                        </div>
                        <div class="currency-grid" id="currencyGrid"></div>
                        <div class="input-group">
                            <input type="number" class="input-field" id="priceInput" placeholder="Ëº∏ÂÖ•Áï∂Âú∞ÂÉπÊ†º" oninput="calculatePrice()" style="font-size:1.4em;text-align:center;">
                        </div>
                        <div class="currency-display">
                            <div class="currency-amount" id="priceDisplay">NT$ 0</div>
                            <div class="currency-converted" id="priceConverted">‚âà 0 ÂÖÉÂè∞Âπ£</div>
                            <div class="currency-equivalent" id="priceEquivalent">
                                <div class="equivalent-title">üí° Âú®Âè∞ÁÅ£Â§ßÊ¶ÇÁ≠âÊñº...</div>
                                <div class="equivalent-text" id="equivalentText">Ëº∏ÂÖ•ÈáëÈ°çÁúãÁúã</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bingo -->
                <div id="funPanel-bingo" class="fun-panel">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon pink">üéØ</div>
                            <div><div class="card-title">ÊóÖÈÅä Bingo</div><div class="card-subtitle">ÂÆåÊàêÈÄ£Á∑öÂæóÂàÜÔºÅ</div></div>
                        </div>
                        <div class="bingo-grid" id="bingoGrid"></div>
                        <div class="bingo-stats">
                            <div class="bingo-stat">
                                <div class="bingo-stat-value lines" id="bingoLines">0</div>
                                <div class="bingo-stat-label">ÈÄ£Á∑öÊï∏</div>
                            </div>
                            <div class="bingo-stat">
                                <div class="bingo-stat-value checks" id="bingoChecks">0</div>
                                <div class="bingo-stat-label">ÂÆåÊàêÈ†ÖÁõÆ</div>
                            </div>
                        </div>
                        <div class="action-row">
                            <button class="btn btn-outline btn-sm" onclick="showModal('bingoCustomModal')">‚úèÔ∏è Ëá™Ë®ÇÈ†ÖÁõÆ</button>
                            <button class="btn btn-primary btn-sm" onclick="generateBingo()">üîÑ ÈáçÊñ∞Áî¢Áîü</button>
                        </div>
                    </div>
                </div>
                
                <!-- Â§©Ê∞£Á©øÊê≠ -->
                <div id="funPanel-weather" class="fun-panel">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon cyan">üëï</div>
                            <div><div class="card-title">Â§©Ê∞£Á©øÊê≠Âª∫Ë≠∞</div><div class="card-subtitle">‰ªäÂ§©Ë©≤Á©ø‰ªÄÈ∫ºÔºü</div></div>
                        </div>
                        <div class="input-row-btn" style="margin-bottom:14px;">
                            <input type="text" class="input-field" id="weatherCity" placeholder="Ëº∏ÂÖ•ÂüéÂ∏ÇÔºå‰æãÔºöÊù±‰∫¨„ÄÅÈ¶ñÁàæ">
                            <button class="input-btn" onclick="getWeather()" style="background:var(--cyan);">üîç</button>
                        </div>
                        <div id="weatherDisplay">
                            <div class="empty-state">
                                <div class="empty-icon">üå§Ô∏è</div>
                                <p>Ëº∏ÂÖ•ÂüéÂ∏ÇÊü•Ë©¢Â§©Ê∞£<br>ÊàëÂÄëÊúÉÁµ¶‰Ω†Á©øÊê≠Âª∫Ë≠∞ÔºÅ</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÂøÉÊÉÖÊ∫´Â∫¶Ë®à -->
                <div id="funPanel-mood" class="fun-panel">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon pink">üå°Ô∏è</div>
                            <div><div class="card-title">ÂøÉÊÉÖÊ∫´Â∫¶Ë®à</div><div class="card-subtitle">Ë®òÈåÑ‰ªäÂ§©ÁöÑÂøÉÊÉÖ</div></div>
                        </div>
                        <div class="mood-today">
                            <div class="mood-date" id="moodDate"></div>
                            <div class="mood-emoji" id="moodEmoji">üòä</div>
                            <div class="mood-value" id="moodValue">7</div>
                            <input type="range" class="mood-slider" id="moodSlider" min="1" max="10" value="7" oninput="updateMoodDisplay()">
                            <textarea class="mood-note" id="moodNote" placeholder="‰ªäÂ§©ÁôºÁîü‰∫Ü‰ªÄÈ∫ºÔºü" rows="2"></textarea>
                            <button class="btn btn-primary" style="margin-top:14px;" onclick="saveMood()">üíæ Ë®òÈåÑ‰ªäÂ§©ÂøÉÊÉÖ</button>
                        </div>
                        <div class="mood-chart">
                            <div class="mood-chart-title">üìä ÂøÉÊÉÖÊõ≤Á∑ö</div>
                            <div class="mood-chart-container" id="moodChart"></div>
                        </div>
                        <div class="mood-history" id="moodHistory"></div>
                    </div>
                </div>
            </div>
        </main>
        
        <nav class="bottom-nav" style="overflow-x:auto;scrollbar-width:none;">
            <button class="nav-item active" onclick="switchPage('home')">
                <span class="nav-icon">üè†</span><span class="nav-label">È¶ñÈ†Å</span>
            </button>
            <button class="nav-item" onclick="switchPage('itinerary')">
                <span class="nav-icon">üìÖ</span><span class="nav-label">Ë°åÁ®ã</span>
            </button>
            <button class="nav-item" onclick="switchPage('expense')">
                <span class="nav-icon">üí∞</span><span class="nav-label">Ë®òÂ∏≥</span>
            </button>
            <button class="nav-item" onclick="switchPage('checkin')">
                <span class="nav-icon">üì∏</span><span class="nav-label">ÊâìÂç°</span>
            </button>
            <button class="nav-item" onclick="switchPage('funtools')">
                <span class="nav-icon">üéÆ</span><span class="nav-label">Ë∂£Âë≥</span>
            </button>
            <button class="nav-item" onclick="switchPage('settings')">
                <span class="nav-icon">‚öôÔ∏è</span><span class="nav-label">Ë®≠ÂÆö</span>
            </button>
        </nav>
    </div>
    
    <!-- Bingo Ëá™Ë®ÇÂΩàÁ™ó -->
    <div class="modal-overlay" id="bingoCustomModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">‚úèÔ∏è Ëá™Ë®Ç Bingo È†ÖÁõÆ</div>
            <p style="font-size:0.85em;color:var(--text-muted);margin-bottom:14px;">ÊØèË°å‰∏ÄÂÄãÈ†ÖÁõÆÔºåËá≥Â∞ëÈúÄË¶Å 24 ÂÄã</p>
            <textarea class="input-field" id="bingoCustomItems" rows="10" placeholder="ÁúãÂà∞Á•ûÁ§æ&#10;ÂêÉÂà∞ÊãâÈ∫µ&#10;Êê≠Âú∞Èêµ&#10;ÁúãÂà∞Á©øÂíåÊúçÁöÑ‰∫∫&#10;..."></textarea>
            <div class="action-row">
                <button class="btn btn-outline btn-sm" onclick="closeModal('bingoCustomModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary btn-sm" onclick="saveBingoItems()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <!-- Modal: Ëá™ÂãïÁî¢ÁîüË°åÁ®ã -->
    <div class="modal-overlay" id="autoGenerateModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">‚ú® Ëá™ÂãïÁî¢ÁîüÂª∫Ë≠∞Ë°åÁ®ã</div>
            
            <div id="autoGenerateContent">
                <p style="color:var(--text-dim);text-align:center;padding:20px;">
                    Ë´ãÂÖàÂú®È¶ñÈ†ÅË®≠ÂÆö<strong>ÁõÆÁöÑÂú∞</strong>Âíå<strong>Êó•Êúü</strong>
                </p>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('autoGenerateModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" id="confirmAutoGenerate" onclick="confirmAutoGenerate()">üöÄ Áî¢ÁîüË°åÁ®ã</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Êñ∞Â¢ûË°åÁ®ãÔºàÂê´Âª∫Ë≠∞ÈÅ∏ÂñÆÔºâ -->
    <div class="modal-overlay" id="scheduleModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üìç Êñ∞Â¢ûË°åÁ®ã</div>
            
            <!-- üÜï Âª∫Ë≠∞ÊôØÈªûÂçÄ -->
            <div class="suggest-section" id="suggestSection">
                <div class="suggest-title">üí° ÁÜ±ÈñÄÊôØÈªûÊé®Ëñ¶</div>
                <div class="suggest-chips" id="suggestChips"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label">ÈÅ∏ÊìáÊó•Êúü</label>
                <select class="input-field" id="scheduleDay"></select>
            </div>
            
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group">
                    <label class="input-label">ÈñãÂßãÊôÇÈñì</label>
                    <input type="time" class="input-field" id="scheduleStartTime" value="09:00">
                </div>
                <div class="input-group">
                    <label class="input-label">ÁµêÊùüÊôÇÈñì</label>
                    <input type="time" class="input-field" id="scheduleEndTime" value="10:00">
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label">Ê¥ªÂãïÂêçÁ®±</label>
                <input type="text" class="input-field" id="scheduleTitle" placeholder="‰æãÔºöÂèÉËßÄÊù±‰∫¨ÈêµÂ°î">
            </div>
            
            <div class="input-group">
                <label class="input-label">È°ûÂûã</label>
                <select class="input-field" id="scheduleType">
                    <option value="ÊôØÈªû">üèõÔ∏è ÊôØÈªû</option>
                    <option value="ÁæéÈ£ü">üçú ÁæéÈ£ü</option>
                    <option value="‰∫§ÈÄö">üöÉ ‰∫§ÈÄö</option>
                    <option value="‰ΩèÂÆø">üè® ‰ΩèÂÆø</option>
                    <option value="Ë≥ºÁâ©">üõçÔ∏è Ë≥ºÁâ©</option>
                    <option value="ÂÖ∂‰ªñ">üìå ÂÖ∂‰ªñ</option>
                </select>
            </div>
            
            <div class="input-group">
                <label class="input-label">Âú∞Èªû (ÈÅ∏Â°´)</label>
                <input type="text" class="input-field" id="scheduleLocation" placeholder="‰æãÔºöÊù±‰∫¨ÈÉΩÊ∏ØÂçÄ">
            </div>
            
            <div class="input-group">
                <label class="input-label">ÂÇôË®ª (ÈÅ∏Â°´)</label>
                <textarea class="input-field" id="scheduleNote" placeholder="ÂÖ∂‰ªñÂÇôË®ª..." style="min-height:60px;"></textarea>
            </div>
            
            <div class="input-group">
                <label class="input-label">üîî LINE ÊèêÈÜí</label>
                <div class="reminder-grid">
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â§©</span>
                        <input type="checkbox" value="1440">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 2 Â∞èÊôÇ</span>
                        <input type="checkbox" value="120">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â∞èÊôÇ</span>
                        <input type="checkbox" value="60">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 30 ÂàÜÈêò</span>
                        <input type="checkbox" value="30">
                    </label>
                </div>
            </div>
            
            <div class="input-group">
                <label class="reminder-option" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">‚úì</div>
                    <span>üìÜ ÂêåÊ≠•Âà∞ Google Êó•ÊõÜ</span>
                    <input type="checkbox" id="syncToGoogle" value="google">
                </label>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('scheduleModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="saveSchedule()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: ÂÖ∂‰ªñ (Ë®òÂ∏≥„ÄÅË≥ºÁâ©„ÄÅÂ§©Êï∏„ÄÅÂåØÂá∫) -->
    <div class="modal-overlay" id="expenseModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üí∞ Êñ∞Â¢ûËä±Ë≤ª</div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">Êó•Êúü</label><select class="input-field" id="expenseDay"></select></div>
                <div class="input-group"><label class="input-label">È°ûÂà•</label>
                    <select class="input-field" id="expenseCategory">
                        <option value="È£≤È£ü">üçú È£≤È£ü</option><option value="‰∫§ÈÄö">üöÉ ‰∫§ÈÄö</option><option value="‰ΩèÂÆø">üè® ‰ΩèÂÆø</option>
                        <option value="Ë≥ºÁâ©">üõçÔ∏è Ë≥ºÁâ©</option><option value="ÈñÄÁ•®">üé´ ÈñÄÁ•®</option><option value="ÂÖ∂‰ªñ">üìå ÂÖ∂‰ªñ</option>
                    </select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">È†ÖÁõÆÂêçÁ®±</label><input type="text" class="input-field" id="expenseItem" placeholder="‰æãÔºöÊãâÈ∫µÂçàÈ§ê"></div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">ÈáëÈ°ç</label><input type="number" class="input-field" id="expenseAmount" placeholder="0"></div>
                <div class="input-group"><label class="input-label">Âπ£Âà•</label>
                    <select class="input-field" id="expenseCurrency">
                        <optgroup label="‰∫ûÊ¥≤">
                            <option value="JPY">üáØüáµ JPY</option>
                            <option value="KRW">üá∞üá∑ KRW</option>
                            <option value="THB">üáπüá≠ THB</option>
                            <option value="SGD">üá∏üá¨ SGD</option>
                            <option value="VND">üáªüá≥ VND</option>
                            <option value="HKD">üá≠üá∞ HKD</option>
                            <option value="MOP">üá≤üá¥ MOP</option>
                            <option value="MYR">üá≤üáæ MYR</option>
                            <option value="IDR">üáÆüá© IDR</option>
                            <option value="PHP">üáµüá≠ PHP</option>
                            <option value="CNY">üá®üá≥ CNY</option>
                        </optgroup>
                        <optgroup label="Ê≠êÊ¥≤">
                            <option value="EUR">üá™üá∫ EUR</option>
                            <option value="GBP">üá¨üáß GBP</option>
                            <option value="CHF">üá®üá≠ CHF</option>
                            <option value="CZK">üá®üáø CZK</option>
                        </optgroup>
                        <optgroup label="ÁæéÊ¥≤/Â§ßÊ¥ãÊ¥≤">
                            <option value="USD">üá∫üá∏ USD</option>
                            <option value="CAD">üá®üá¶ CAD</option>
                            <option value="MXN">üá≤üáΩ MXN</option>
                            <option value="AUD">üá¶üá∫ AUD</option>
                            <option value="NZD">üá≥üáø NZD</option>
                        </optgroup>
                        <optgroup label="ÈùûÊ¥≤">
                            <option value="ZAR">üáøüá¶ ZAR</option>
                            <option value="EGP">üá™üá¨ EGP</option>
                            <option value="MAD">üá≤üá¶ MAD</option>
                            <option value="KES">üá∞üá™ KES</option>
                        </optgroup>
                        <optgroup label="Âè∞ÁÅ£">
                            <option value="TWD">üáπüáº TWD</option>
                        </optgroup>
                    </select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">ÊîØ‰ªòÊñπÂºè</label>
                <select class="input-field" id="expensePayment">
                    <optgroup label="üíµ ÁèæÈáë">
                        <option value="ÁèæÈáë">üíµ ÁèæÈáë</option>
                    </optgroup>
                    <optgroup label="üí≥ ‰ø°Áî®Âç°">
                        <option value="‰ø°Áî®Âç°">üí≥ ‰ø°Áî®Âç°</option>
                        <option value="Á∞ΩÂ∏≥ÈáëËûçÂç°">üí≥ Á∞ΩÂ∏≥ÈáëËûçÂç°</option>
                    </optgroup>
                    <optgroup label="üì± ÈõªÂ≠êÊîØ‰ªò">
                        <option value="Apple Pay">üì± Apple Pay</option>
                        <option value="Google Pay">üì± Google Pay</option>
                        <option value="LINE Pay">üì± LINE Pay</option>
                        <option value="Ë°óÂè£ÊîØ‰ªò">üì± Ë°óÂè£ÊîØ‰ªò</option>
                        <option value="PayPay">üì± PayPay</option>
                        <option value="ÂæÆ‰ø°/ÊîØ‰ªòÂØ∂">üì± ÂæÆ‰ø°/ÊîØ‰ªòÂØ∂</option>
                    </optgroup>
                    <optgroup label="üöÉ ‰∫§ÈÄöÂç°">
                        <option value="Suica/ICOCA">üöÉ Suica/ICOCA</option>
                        <option value="ÊÇ†ÈÅäÂç°">üöÉ ÊÇ†ÈÅäÂç°</option>
                        <option value="T-money">üöÉ T-money</option>
                        <option value="ÂÖ´ÈÅîÈÄö">üöÉ ÂÖ´ÈÅîÈÄö</option>
                    </optgroup>
                    <optgroup label="üìå ÂÖ∂‰ªñ">
                        <option value="ÂÖ∂‰ªñ">üìå ÂÖ∂‰ªñ</option>
                    </optgroup>
                </select>
            </div>
            
            <!-- üë• ÂàÜÂ∏≥Ë®≠ÂÆö -->
            <div class="split-section" style="background:var(--bg-dark);border-radius:10px;padding:12px;margin-bottom:14px;">
                <div style="font-size:0.85em;color:var(--orange);margin-bottom:10px;display:flex;align-items:center;gap:6px;">üë• ÂàÜÂ∏≥Ë®≠ÂÆö</div>
                <div class="input-row" style="margin-bottom:10px;">
                    <div class="input-group" style="flex:1;">
                        <label class="input-label">üí≥ Â¢ä‰ªò‰∫∫</label>
                        <select class="input-field" id="expensePaidBy"></select>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">üë´ ÂàÜÊî§Â∞çË±°ÔºàÂèØÂ§öÈÅ∏Ôºâ</label>
                    <div id="splitWithCheckboxes" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;"></div>
                </div>
            </div>
            
            <div class="input-group"><label class="input-label">ÂÇôË®ª (ÈÅ∏Â°´)</label><input type="text" class="input-field" id="expenseNote" placeholder="ÂÇôË®ª..."></div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('expenseModal')">ÂèñÊ∂à</button>
                <button class="btn btn-orange" onclick="saveExpense()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="shoppingModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üõí Êñ∞Â¢ûË≥ºÁâ©È†ÖÁõÆ</div>
            <div class="input-group"><label class="input-label">ÂïÜÂìÅÂêçÁ®±</label><input type="text" class="input-field" id="shopItem" placeholder="‰æãÔºöËó•Â¶ù„ÄÅÈõ∂È£ü..."></div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">È†êÁÆó</label><input type="number" class="input-field" id="shopBudget" placeholder="0"></div>
                <div class="input-group"><label class="input-label">ÂÑ™ÂÖàÂ∫¶</label>
                    <select class="input-field" id="shopPriority"><option value="high">üî¥ ÂøÖË≤∑</option><option value="medium">üü° ÊÉ≥Ë≤∑</option><option value="low">üü¢ Èö®ÊÑè</option></select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">Ë≥ºË≤∑Âú∞Èªû (ÈÅ∏Â°´)</label>
                <select class="input-field" id="shopStore">
                    <option value="">Êú™ÊåáÂÆö</option><option value="Ëó•Â¶ùÂ∫ó">üíä Ëó•Â¶ùÂ∫ó</option><option value="‰æøÂà©ÂïÜÂ∫ó">üè™ ‰æøÂà©ÂïÜÂ∫ó</option>
                    <option value="ÁôæË≤®ÂÖ¨Âè∏">üè¨ ÁôæË≤®ÂÖ¨Âè∏</option><option value="Outlet">üõçÔ∏è Outlet</option><option value="Ê©üÂ†¥ÂÖçÁ®Ö">‚úàÔ∏è Ê©üÂ†¥ÂÖçÁ®Ö</option>
                </select>
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('shoppingModal')">ÂèñÊ∂à</button>
                <button class="btn btn-pink" onclick="saveShopping()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="dayModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üìÖ Êñ∞Â¢ûË°åÁ®ãÊó•</div>
            <div class="input-group"><label class="input-label">Êó•Êúü</label><input type="date" class="input-field" id="newDayDate"></div>
            <div class="input-group"><label class="input-label">Ê®ôÈ°å (ÈÅ∏Â°´)</label><input type="text" class="input-field" id="newDayTitle" placeholder="‰æãÔºöÊäµÈÅîÊó•"></div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('dayModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="saveNewDay()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="exportModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üìä ÂåØÂá∫Ë≥áÊñô</div>
            <div style="text-align:center;padding:20px 0;"><div style="font-size:3em;margin-bottom:12px;">üìä</div><p style="color:var(--text-dim);">ÂåØÂá∫ÂÆåÊï¥ÁöÑÊóÖÈÅäÁ¥ÄÈåÑ</p></div>
            <button class="btn btn-secondary" onclick="exportToExcel()">üì• ‰∏ãËºâ Excel (.xlsx)</button>
            <button class="btn btn-primary" style="margin-top:10px;" id="btnExportGoogleDoc">üìù ÂåØÂá∫ÊóÖÈÅäÁ¥ÄÈåÑ (Google Doc)</button>
            <button class="btn btn-outline" style="margin-top:10px;" onclick="closeModal('exportModal')">ÂèñÊ∂à</button>
        </div>
    </div>
    
    <!-- Modal: ÊØèÊó•ÊóÖÈÅäÈªûÊª¥ -->
    <div class="modal-overlay" id="dailyNotesModal">
        <div class="modal" style="max-height:95vh;">
            <div class="modal-handle"></div>
            <div class="modal-title">‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥</div>
            
            <div class="notes-day-header">
                <div class="notes-day-title" id="notesModalDayTitle">Day 1</div>
                <div class="notes-day-date" id="notesModalDayDate">2025/01/01</div>
            </div>
            
            <!-- Êñ∞Â¢ûÂøÉÂæóÂçÄ -->
            <div class="card" style="margin-bottom:15px;">
                <div class="input-group">
                    <label class="input-label">ÈÅ∏ÊìáÂøÉÊÉÖ</label>
                    <div class="mood-picker" id="moodPicker">
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üòä">üòä</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üòç">üòç</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ü•∞">ü•∞</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üòã">üòã</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ü§©">ü§©</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üòé">üòé</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ü•±">ü•±</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üòÖ">üòÖ</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üò¢">üò¢</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="üåßÔ∏è">üåßÔ∏è</div>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">Ë®òÈåÑÁï∂‰∏ãÁöÑÂøÉÊÉÖËàáÊÑüÂèó</label>
                    <textarea class="input-field" id="noteContent" rows="4" placeholder="‰ªäÂ§©Âéª‰∫ÜÂì™Ë£°ÔºüÂêÉ‰∫Ü‰ªÄÈ∫ºÔºüÊúâ‰ªÄÈ∫ºÈõ£ÂøòÁöÑÁû¨ÈñìÔºü&#10;&#10;ÂØ´‰∏ãÊóÖÈÄî‰∏≠ÁöÑÈªûÈªûÊª¥Êª¥..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="addDailyNote()">‚úçÔ∏è Êñ∞Â¢ûÈªûÊª¥</button>
            </div>
            
            <!-- Â∑≤ÊúâÂøÉÂæóÂàóË°® -->
            <div id="dailyNotesList">
                <!-- ÂãïÊÖãÂ°´ÂÖ• -->
            </div>
            
            <input type="hidden" id="currentNoteDate" value="">
            <input type="hidden" id="currentNoteDayTitle" value="">
            <input type="hidden" id="selectedMood" value="üòä">
            
            <button class="btn btn-outline" style="margin-top:10px;" onclick="closeModal('dailyNotesModal')">ÈóúÈñâ</button>
        </div>
    </div>
    
    <!-- Modal: ÊâπÊ¨°Ë®≠ÂÆöÊèêÈÜí -->
    <div class="modal-overlay" id="batchReminderModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üîî ÊâπÊ¨°Ë®≠ÂÆö LINE ÊèêÈÜí</div>
            
            <p style="color:var(--text-dim);font-size:0.9em;text-align:center;margin-bottom:15px;">
                ÁÇ∫ÊâÄÊúâ<strong>Â∞öÊú™Ë®≠ÂÆöÊèêÈÜí</strong>ÁöÑË°åÁ®ãÂä†ÂÖ• LINE ÊèêÈÜí
            </p>
            
            <div id="batchReminderStats" style="background:var(--bg-dark);border-radius:10px;padding:12px;margin-bottom:15px;text-align:center;">
                <!-- ÂãïÊÖãÂ°´ÂÖ•Áµ±Ë®à -->
            </div>
            
            <div class="input-group">
                <label class="input-label">ÈÅ∏ÊìáÊèêÈÜíÊôÇÈñì</label>
                <div class="reminder-grid" id="batchReminderOptions">
                    <label class="reminder-option checked" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â§©</span>
                        <input type="checkbox" value="1440" checked>
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 2 Â∞èÊôÇ</span>
                        <input type="checkbox" value="120">
                    </label>
                    <label class="reminder-option checked" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â∞èÊôÇ</span>
                        <input type="checkbox" value="60" checked>
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">‚úì</div><span>Ââç 30 ÂàÜÈêò</span>
                        <input type="checkbox" value="30">
                    </label>
                </div>
            </div>
            
            <div class="input-group" style="margin-top:10px;">
                <label class="reminder-option checked" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">‚úì</div>
                    <span>Ë¶ÜËìãÂ∑≤ÊúâÊèêÈÜíË®≠ÂÆöÁöÑË°åÁ®ã</span>
                    <input type="checkbox" id="overwriteReminders" value="overwrite" checked>
                </label>
            </div>
            
            <div class="input-group" style="margin-top:10px;">
                <label class="reminder-option checked" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">‚úì</div>
                    <span>üóëÔ∏è ÂÖàÊ∏ÖÈô§ GAS Ë≥áÊñôÂ∫´‰∏≠ÁöÑËàäÊéíÁ®ã</span>
                    <input type="checkbox" id="clearOldSchedules" value="clear" checked>
                </label>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('batchReminderModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="applyBatchReminders()">üîî Â•óÁî®ÊèêÈÜí</button>
            </div>
        </div>
    </div>
    
    <!-- üìù Google Doc ÈÄ£Áµê Modal -->
    <div class="modal-overlay" id="docLinkModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">‚úÖ Google Doc Â∑≤Âª∫Á´ã</div>
            <div style="text-align:center;padding:20px 0;">
                <div style="font-size:3em;margin-bottom:15px;">üìÑ</div>
                <p id="docLinkTitle" style="color:var(--text);margin-bottom:20px;font-weight:600;"></p>
                <a id="docLinkUrl" href="#" target="_blank" rel="noopener noreferrer" 
                   style="display:inline-block;background:linear-gradient(135deg,var(--cyan),var(--emerald));color:white;padding:15px 30px;border-radius:12px;text-decoration:none;font-weight:600;font-size:1.1em;">
                    üìù ÈñãÂïü Google Doc
                </a>
                <p style="color:var(--text-dim);font-size:0.85em;margin-top:15px;">
                    ÈªûÊìä‰∏äÊñπÊåâÈàïÈñãÂïüÊñá‰ª∂
                </p>
            </div>
            <div id="docLinkActions">
                <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">ÈóúÈñâ</button>
            </div>
        </div>
    </div>
    
    <!-- üí∞ È†êÁÆóË®≠ÂÆö Modal -->
    <div class="modal-overlay" id="budgetModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üíé Ë®≠ÂÆöÊóÖÈÅäÈ†êÁÆó</div>
            <div class="input-group">
                <label class="input-label">Á∏ΩÈ†êÁÆóÔºàÂè∞Âπ£ NT$Ôºâ</label>
                <input type="number" class="input-field" id="budgetAmount" placeholder="‰æãÔºö50000">
            </div>
            <p style="color:var(--text-dim);font-size:0.8em;text-align:center;margin:10px 0;">
                ÊâÄÊúâË≤®Âπ£Â∞áËá™ÂãïÊèõÁÆóÁÇ∫Âè∞Âπ£ÈÄ≤Ë°åÈ†êÁÆóÁõ£Êéß
            </p>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('budgetModal')">ÂèñÊ∂à</button>
                <button class="btn btn-orange" onclick="saveBudget()">üíæ ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <!-- üì∏ ÊØèÊó•Â∞ÅÈù¢ÁÖßÁâá Modal -->
    <div class="modal-overlay" id="photoModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üì∏ Ë®≠ÂÆöÊú¨Êó•Â∞ÅÈù¢</div>
            <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="handlePhotoSelect(event)">
            <div id="photoPreview" style="width:100%;aspect-ratio:16/9;background:var(--bg-dark);border-radius:12px;margin-bottom:15px;display:flex;align-items:center;justify-content:center;overflow:hidden;cursor:pointer;" onclick="document.getElementById('photoInput').click()">
                <div style="text-align:center;color:var(--text-dim);">
                    <div style="font-size:2em;">üì∑</div>
                    <div>ÈªûÊìäÈÅ∏ÊìáÁÖßÁâá</div>
                </div>
            </div>
            <p style="color:var(--text-dim);font-size:0.75em;text-align:center;margin-bottom:10px;">
                Âª∫Ë≠∞‰ΩøÁî®Ê©´ÂêëÁÖßÁâáÔºåÊúÉËá™ÂãïÂ£ìÁ∏Æ‰ª•ÁØÄÁúÅÁ©∫Èñì
            </p>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('photoModal')">ÂèñÊ∂à</button>
                <button class="btn btn-outline" onclick="removeDayCover()" style="color:var(--pink);">üóëÔ∏è ÁßªÈô§</button>
                <button class="btn btn-primary" onclick="saveDayCover()">üíæ ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <!-- üìç Êñ∞Â¢ûÊôØÈªû Modal -->
    <div class="modal-overlay" id="spotModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">üìç Êñ∞Â¢ûÊôØÈªû</div>
            <div class="input-group">
                <label class="input-label">ÊôØÈªûÂêçÁ®±</label>
                <input type="text" class="input-field" id="newSpotName" placeholder="‰æãÔºöÊù±‰∫¨ÈêµÂ°î">
            </div>
            <div class="input-group">
                <label class="input-label">È°ûÂûã</label>
                <select class="input-field" id="newSpotType">
                    <option value="ÊôØÈªû">üèõÔ∏è ÊôØÈªû</option>
                    <option value="ÁæéÈ£ü">üçú ÁæéÈ£ü</option>
                    <option value="Ë≥ºÁâ©">üõçÔ∏è Ë≥ºÁâ©</option>
                    <option value="‰ΩèÂÆø">üè® ‰ΩèÂÆø</option>
                    <option value="‰∫§ÈÄö">üöÉ ‰∫§ÈÄö</option>
                    <option value="ÂÖ∂‰ªñ">üìå ÂÖ∂‰ªñ</option>
                </select>
            </div>
            <div class="input-group">
                <label class="input-label">ÂÇôË®ªÔºàÈÅ∏Â°´Ôºâ</label>
                <input type="text" class="input-field" id="newSpotNote" placeholder="ÁáüÊ•≠ÊôÇÈñì„ÄÅÂú∞ÂùÄÁ≠â">
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('spotModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="addSpot()">‚ûï Êñ∞Â¢û</button>
            </div>
        </div>
    </div>
    
    <!-- üì∏ ÊãçÁÖßÊâìÂç° Modal -->
    <div class="modal-overlay" id="checkinModal">
        <div class="modal" style="max-width:400px;">
            <div class="modal-handle"></div>
            <div class="modal-title">üì∏ ÊãçÁÖßÊâìÂç°</div>
            
            <!-- ÊãçÁÖßÊ®°ÂºèÈÅ∏Êìá -->
            <div class="camera-mode-selector">
                <div class="camera-mode-btn active" id="modeNormal" onclick="selectCameraMode('normal')">
                    <div class="camera-mode-icon">üì∑</div>
                    <div class="camera-mode-label">‰∏ÄËà¨ÊãçÁÖß</div>
                </div>
                <div class="camera-mode-btn" id="modePolaroid" onclick="selectCameraMode('polaroid')">
                    <div class="camera-mode-icon">üì∏</div>
                    <div class="camera-mode-label">ÊãçÁ´ãÂæó</div>
                </div>
            </div>
            
            <input type="file" id="checkinPhotoInput" accept="image/*" capture="environment" style="display:none" onchange="handleCheckinPhoto(event)">
            <div class="photo-upload-area" id="checkinUploadArea" onclick="document.getElementById('checkinPhotoInput').click()">
                <div class="photo-upload-icon">üì∑</div>
                <div class="photo-upload-text">ÈªûÊìä‰∏äÂÇ≥ÁÖßÁâáÊàñÊãçÁÖß</div>
            </div>
            <div class="input-group">
                <label class="input-label">ÈÅ∏ÊìáÊôØÈªûÔºàÈÅ∏Â°´Ôºâ</label>
                <select class="input-field" id="checkinSpot">
                    <option value="">-- ‰∏çÈÅ∏Êìá --</option>
                </select>
            </div>
            <div class="input-group">
                <label class="input-label">Êó•Êúü</label>
                <input type="date" class="input-field" id="checkinDate">
            </div>
            <div class="input-group">
                <label class="input-label">ÂøÉÊÉÖÁ≠ÜË®òÔºàÈÅ∏Â°´Ôºâ</label>
                <textarea class="input-field" id="checkinNote" placeholder="Ë®òÈåÑÈÄô‰∏ÄÂàªÁöÑÊÑüÂèó..." rows="2"></textarea>
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('checkinModal')">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="saveCheckin()">‚úì ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>
    
    <!-- üì∏ ÊãçÁ´ãÂæóÁõ∏Ê©ü‰ªãÈù¢ -->
    <div class="polaroid-overlay" id="polaroidOverlay">
        <!-- ÈñÉÂÖâÁáàÊïàÊûú -->
        <div class="cam-flash-overlay" id="camFlashOverlay"></div>
        
        <!-- Èö±ËóèÁöÑ Canvas -->
        <canvas id="polaroidCanvas" style="display:none;"></canvas>
        
        <!-- È†ÇÈÉ®Ê®ôÈ°åÂàó -->
        <div class="polaroid-header">
            <div class="polaroid-title">üì∏ Retro Camera</div>
            <button class="polaroid-close-btn" onclick="closePolaroidCamera()">‚úï</button>
        </div>
        
        <!-- Áõ∏Ê©ü‰∏ªÈ´îÂçÄÂüü -->
        <div style="position:relative;flex:1;display:flex;align-items:center;justify-content:center;width:100%;">
            
            <!-- Êï£ËêΩÁÖßÁâáÂÆπÂô® -->
            <div class="polaroid-photos-container" id="polaroidPhotosContainer"></div>
            
            <!-- 3D Áõ∏Ê©ü -->
            <div class="camera-body">
                <div class="camera-grip"></div>
                <div class="cam-flash"></div>
                <div class="cam-viewfinder"></div>
                <div class="cam-sensor-dots">
                    <div class="cam-dot"></div>
                    <div class="cam-dot"></div>
                </div>
                
                <!-- Âø´ÈñÄÊåâÈàï -->
                <div class="shutter-socket">
                    <button id="polaroidShutterBtn" class="shutter-btn" onclick="takePolaroidPhoto()">
                        <div class="shutter-inner"></div>
                    </button>
                </div>
                
                <!-- Èè°È†≠ÁµÑ‰ª∂ -->
                <div class="lens-mount">
                    <div class="lens-ring-outer">
                        <div class="lens-text">
                            <svg viewBox="0 0 200 200">
                                <path id="lensCurve" d="M 100, 100 m -70, 0 a 70,70 0 1,1 140,0 a 70,70 0 1,1 -140,0" />
                                <text><textPath href="#lensCurve">INSTAX LENS 60mm FOCUS 0.3m~‚àû</textPath></text>
                            </svg>
                        </div>
                        <div class="lens-glass">
                            <video id="polaroidVideo" autoplay playsinline muted></video>
                        </div>
                    </div>
                </div>
                
                <div class="cam-brand">
                    <div class="cam-brand-name">instax</div>
                    <div class="cam-brand-model">mini 12</div>
                </div>
            </div>
            
            <!-- ÈÄÄÂá∫ÁöÑÂ∫ïÁâáÂãïÁï´ÂÖÉÁ¥† -->
            <div id="polaroidFilm" class="polaroid-film frame-white">
                <div class="polaroid-image-area">
                    <img id="polaroidFilmImage" src="" alt="Developing Photo">
                </div>
                <div id="polaroidFilmText" class="polaroid-photo-text" style="color:#999;">Memories</div>
            </div>
        </div>
        
        <!-- Â∫ïÈÉ®Ëä±ÈÇäÈÅ∏ÊìáÂô® -->
        <div class="frame-selector" style="position:relative;z-index:200;">
            <span class="frame-selector-label">Ëä±ÈÇä</span>
            <div class="frame-options">
                <div class="frame-option frame-white selected" onclick="selectPolaroidFrame('white', this)" title="Á∂ìÂÖ∏ÁôΩ"></div>
                <div class="frame-option frame-black" onclick="selectPolaroidFrame('black', this)" title="ÂÑ™ÈõÖÈªë"></div>
                <div class="frame-option frame-mint" onclick="selectPolaroidFrame('mint', this)" title="ËñÑËç∑Á∂†"></div>
                <div class="frame-option frame-pink" onclick="selectPolaroidFrame('pink', this)" title="ÁîúÁæéÁ≤â"></div>
                <div class="frame-option frame-floral" onclick="selectPolaroidFrame('floral', this)" title="Âæ©Âè§Ëä±Âçâ"></div>
                <div class="frame-option frame-plaid" onclick="selectPolaroidFrame('plaid', this)" title="ËóçËâ≤Ê†ºÁ¥ã"></div>
                <div class="frame-option frame-gradient" onclick="selectPolaroidFrame('gradient', this)" title="ÂΩ©ËôπÊº∏Â±§"></div>
            </div>
            <!-- Áõ∏Ê©üÂàáÊèõÊåâÈàï -->
            <button class="camera-switch-btn" onclick="switchCamera()" title="ÂàáÊèõÂâçÂæåÈè°È†≠">
                üîÑ
            </button>
        </div>
        
        <!-- Â∫ïÈÉ®Êìç‰ΩúÊåâÈàï -->
        <div style="display:flex;gap:10px;margin-top:15px;width:100%;max-width:350px;">
            <button class="btn btn-outline" style="flex:1;background:rgba(255,255,255,0.8);color:#333;border-color:rgba(0,0,0,0.2);" onclick="closePolaroidCamera()">ËøîÂõû</button>
            <button class="btn btn-primary" style="flex:1;" onclick="savePolaroidToCheckin()">üíæ ÂÑ≤Â≠òÂà∞ÊâìÂç°</button>
        </div>
    </div>
    
    <!-- üì∑ ÁÖßÁâáÊ™¢Ë¶ñÂô® -->
    <div class="photo-viewer-overlay" id="photoViewerOverlay">
        <div class="photo-viewer-header">
            <div></div>
            <button class="photo-viewer-close" onclick="closePhotoViewer()">‚úï</button>
        </div>
        <div class="photo-viewer-content">
            <img id="viewerPhoto" src="" alt="">
        </div>
        <div class="photo-viewer-info">
            <div class="photo-viewer-spot" id="viewerSpot"></div>
            <div class="photo-viewer-note" id="viewerNote"></div>
        </div>
    </div>
    
    <script>
        // ============================================
        // ÊôØÈªûË≥áÊñôÂ∫´ÔºàÂèØÊì¥ÂÖÖÔºâ
        // ============================================
const ATTRACTIONS_DB = {
    // ============ ‰∫ûÊ¥≤ (Asia) ============
    'üáØüáµ Êù±‰∫¨': {
        country: 'Êó•Êú¨', continent: '‰∫ûÊ¥≤', currency: 'JPY',
        spots: [
            { name: 'Êù±‰∫¨ÈêµÂ°î', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÊ∏ØÂçÄ', time: '09:00-11:00' },
            { name: 'Ê∑∫ËçâÂØ∫', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÂè∞Êù±ÂçÄ', time: '10:00-12:00' },
            { name: 'Êô¥Á©∫Â°î', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÂ¢®Áî∞ÂçÄ', time: '14:00-16:00' },
            { name: 'Ê∂âË∞∑ÂçÅÂ≠óË∑ØÂè£', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑ÂçÄ', time: '15:00-17:00' },
            { name: 'Êñ∞ÂÆøÂæ°Ëãë', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÊñ∞ÂÆøÂçÄ', time: '09:00-11:00' },
            { name: 'ÊòéÊ≤ªÁ•ûÂÆÆ', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÊ∏ãË∞∑ÂçÄ', time: '08:00-10:00' },
            { name: 'ÁßãËëâÂéüÈõªÂô®Ë°ó', type: 'Ë≥ºÁâ©', location: 'Êù±‰∫¨ÈÉΩÂçÉ‰ª£Áî∞ÂçÄ', time: '13:00-17:00' },
            { name: '‰∏äÈáéÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÂè∞Êù±ÂçÄ', time: '09:30-14:00' },
            { name: 'ÁØâÂú∞Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Êù±‰∫¨ÈÉΩ‰∏≠Â§ÆÂçÄ', time: '07:00-10:00' },
            { name: 'Âè∞Â†¥Êµ∑Êø±ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Êù±‰∫¨ÈÉΩÊ∏ØÂçÄ', time: '14:00-18:00' }
        ],
        foods: ['‰∏ÄËò≠ÊãâÈ∫µ', 'Â£ΩÂè∏Â§ß', 'Áâõ„Ç´„ÉÑ„ÇÇ„Å®Êùë', 'ÊïòÊïòËãëÁáíËÇâ', 'AFURIÊüöÂ≠êÊãâÈ∫µ', 'Â§©‰∏º„Å¶„Çì„ÇÑ', 'È∞ªÈ≠öÈ£Ø', 'Ë¶™Â≠ê‰∏º', 'ÊäπËå∂ÁîúÈªû', 'Á´†È≠öÁáí'],
        defaultSchedule: [{ title: 'ÊäµÈÅîÊàêÁî∞/ÁæΩÁî∞Ê©üÂ†¥', type: '‰∫§ÈÄö', time: '12:00-14:00' }, { title: 'È£ØÂ∫ó Check-in', type: '‰ΩèÂÆø', time: '15:00-16:00' }]
    },
    'üáØüáµ Â§ßÈò™': {
        country: 'Êó•Êú¨', continent: '‰∫ûÊ¥≤', currency: 'JPY',
        spots: [
            { name: 'Â§ßÈò™Âüé', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏Ç‰∏≠Â§ÆÂçÄ', time: '09:00-12:00' },
            { name: 'ÈÅìÈ†ìÂ†Ä', type: 'ÁæéÈ£ü', location: 'Â§ßÈò™Â∏Ç‰∏≠Â§ÆÂçÄ', time: '17:00-21:00' },
            { name: 'ÂøÉÈΩãÊ©ã', type: 'Ë≥ºÁâ©', location: 'Â§ßÈò™Â∏Ç‰∏≠Â§ÆÂçÄ', time: '13:00-17:00' },
            { name: 'ÈÄöÂ§©Èñ£', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏ÇÊµ™ÈÄüÂçÄ', time: '10:00-12:00' },
            { name: 'ÈªëÈñÄÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Â§ßÈò™Â∏Ç‰∏≠Â§ÆÂçÄ', time: '08:00-11:00' },
            { name: 'Áí∞ÁêÉÂΩ±Âüé', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏ÇÊ≠§Ëä±ÂçÄ', time: '09:00-20:00' },
            { name: 'Êµ∑ÈÅäÈ§®', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏ÇÊ∏ØÂçÄ', time: '10:00-15:00' },
            { name: 'Ê¢ÖÁî∞Á©∫‰∏≠Â∫≠Âúí', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏ÇÂåóÂçÄ', time: '18:00-21:00' },
            { name: 'Â§©ÁéãÂØ∫ÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Â§ßÈò™Â∏ÇÂ§©ÁéãÂØ∫ÂçÄ', time: '09:30-14:00' },
            { name: 'Èõ£Ê≥¢ÂÖ¨Âúí', type: 'Ë≥ºÁâ©', location: 'Â§ßÈò™Â∏ÇÊµ™ÈÄüÂçÄ', time: '11:00-18:00' }
        ],
        foods: ['Á´†È≠öÁáí', 'Â§ßÈò™Ááí', '‰∏≤„Ç´„ÉÑ„Å†„Çã„Åæ', 'ËüπÈÅìÊ®Ç', '‰∏ÄËò≠ÊãâÈ∫µ', 'ÈáëÈæçÊãâÈ∫µ', '551Ëì¨ËêäËÇâÂåÖ', 'Ëá™Áî±ËªíÂíñÂì©', 'ÁÇ∏Ë±¨Êéí', 'ÁÉèÈæçÈ∫µ'],
        defaultSchedule: [{ title: 'ÊäµÈÅîÈóúË•øÊ©üÂ†¥', type: '‰∫§ÈÄö', time: '12:00-14:00' }]
    },
    'üáØüáµ ‰∫¨ÈÉΩ': {
        country: 'Êó•Êú¨', continent: '‰∫ûÊ¥≤', currency: 'JPY',
        spots: [
            { name: 'Ê∏ÖÊ∞¥ÂØ∫', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÊù±Â±±ÂçÄ', time: '06:00-09:00' },
            { name: '‰ºèË¶ãÁ®ªËç∑Â§ßÁ§æ', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏Ç‰ºèË¶ãÂçÄ', time: '08:00-11:00' },
            { name: 'ÈáëÈñ£ÂØ∫', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÂåóÂçÄ', time: '09:00-11:00' },
            { name: 'ÂµêÂ±±Á´πÊûó', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÂè≥‰∫¨ÂçÄ', time: '08:00-12:00' },
            { name: '‰∫åÊ¢ùÂüé', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏Ç‰∏≠‰∫¨ÂçÄ', time: '09:00-11:00' },
            { name: 'Á•áÂúíËä±Ë¶ãÂ∞èË∑Ø', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÊù±Â±±ÂçÄ', time: '16:00-19:00' },
            { name: 'ÂÖ´ÂùÇÁ•ûÁ§æ', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÊù±Â±±ÂçÄ', time: '09:00-10:00' },
            { name: 'Èå¶Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: '‰∫¨ÈÉΩÂ∏Ç‰∏≠‰∫¨ÂçÄ', time: '10:00-13:00' },
            { name: 'ÈäÄÈñ£ÂØ∫', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÂ∑¶‰∫¨ÂçÄ', time: '09:00-11:00' },
            { name: 'Âì≤Â≠∏‰πãÈÅì', type: 'ÊôØÈªû', location: '‰∫¨ÈÉΩÂ∏ÇÂ∑¶‰∫¨ÂçÄ', time: '14:00-16:00' }
        ],
        foods: ['ÊπØË±ÜËÖê', 'ÊäπËå∂ÁîúÈªû', '‰∫¨ÈÉΩÊãâÈ∫µ', 'Êá∑Áü≥ÊñôÁêÜ', 'Êº¨Áâ©', 'ÂÖ´Ê©ãÈ§Ö', 'ÂÆáÊ≤ªÊäπËå∂', 'ÈØñÈ≠öÂ£ΩÂè∏', 'ÊπØËëâ', '‰∫¨ÈáéËèú'],
        defaultSchedule: []
    },
    'üáØüáµ ÂåóÊµ∑ÈÅì': {
        country: 'Êó•Êú¨', continent: '‰∫ûÊ¥≤', currency: 'JPY',
        spots: [
            { name: 'Â∞èÊ®ΩÈÅãÊ≤≥', type: 'ÊôØÈªû', location: 'Â∞èÊ®ΩÂ∏Ç', time: '10:00-14:00' },
            { name: 'Â§ßÈÄöÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Êú≠ÂπåÂ∏Ç‰∏≠Â§ÆÂçÄ', time: '09:00-11:00' },
            { name: 'Êú≠ÂπåÈõªË¶ñÂ°î', type: 'ÊôØÈªû', location: 'Êú≠ÂπåÂ∏Ç‰∏≠Â§ÆÂçÄ', time: '11:00-13:00' },
            { name: 'ÁôΩËâ≤ÊàÄ‰∫∫ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Êú≠ÂπåÂ∏ÇË•øÂçÄ', time: '09:00-12:00' },
            { name: 'Áã∏Â∞èË∑ØÂïÜÂ∫óË°ó', type: 'Ë≥ºÁâ©', location: 'Êú≠ÂπåÂ∏Ç‰∏≠Â§ÆÂçÄ', time: '14:00-18:00' },
            { name: '‰∫åÊ¢ùÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Êú≠ÂπåÂ∏Ç‰∏≠Â§ÆÂçÄ', time: '07:00-10:00' },
            { name: 'ÂØåËâØÈáéËä±Áî∞', type: 'ÊôØÈªû', location: 'ÂØåËâØÈáéÂ∏Ç', time: '09:00-15:00' },
            { name: 'ÁæéÁëõÈùíÊ±†', type: 'ÊôØÈªû', location: 'ÁæéÁëõÁî∫', time: '10:00-12:00' },
            { name: 'ÂáΩÈ§®Â±±Â§úÊôØ', type: 'ÊôØÈªû', location: 'ÂáΩÈ§®Â∏Ç', time: '18:00-21:00' },
            { name: 'ÁôªÂà•Âú∞ÁçÑË∞∑', type: 'ÊôØÈªû', location: 'ÁôªÂà•Â∏Ç', time: '09:00-12:00' }
        ],
        foods: ['ÊàêÂêâÊÄùÊ±óÁÉ§ËÇâ', 'Âë≥ÂôåÊãâÈ∫µ', 'Êµ∑ÈÆÆ‰∏º', 'ÊπØÂíñÂì©', 'ËûÉËüπÊñôÁêÜ', 'ÁôΩËâ≤ÊàÄ‰∫∫', 'Â§ïÂºµÂìàÂØÜÁìú', 'ÁÉ§ÁéâÁ±≥', 'Â•∂Ê≤πÈ¶¨Èà¥ËñØ', 'Êµ∑ËÜΩ'],
        defaultSchedule: []
    },
    'üáØüáµ Ê≤ñÁπ©': {
        country: 'Êó•Êú¨', continent: '‰∫ûÊ¥≤', currency: 'JPY',
        spots: [
            { name: 'È¶ñÈáåÂüé', type: 'ÊôØÈªû', location: 'ÈÇ£Èú∏Â∏Ç', time: '09:00-12:00' },
            { name: 'ÂúãÈöõÈÄö', type: 'Ë≥ºÁâ©', location: 'ÈÇ£Èú∏Â∏Ç', time: '14:00-18:00' },
            { name: 'ÁæéÈ∫óÊµ∑Ê∞¥ÊóèÈ§®', type: 'ÊôØÈªû', location: 'Êú¨ÈÉ®Áî∫', time: '09:00-15:00' },
            { name: 'Âè§ÂÆáÂà©Â≥∂', type: 'ÊôØÈªû', location: '‰ªäÊ≠∏‰ªÅÊùë', time: '10:00-14:00' },
            { name: 'Ëê¨Â∫ßÊØõ', type: 'ÊôØÈªû', location: 'ÊÅ©Á¥çÊùë', time: '15:00-17:00' },
            { name: 'Ê≥¢‰∏äÂÆÆ', type: 'ÊôØÈªû', location: 'ÈÇ£Èú∏Â∏Ç', time: '09:00-10:00' },
            { name: 'Áü≥Âû£Â≥∂', type: 'ÊôØÈªû', location: 'Áü≥Âû£Â∏Ç', time: '09:00-17:00' },
            { name: 'Èùí‰πãÊ¥ûÁ™ü', type: 'ÊôØÈªû', location: 'ÊÅ©Á¥çÊùë', time: '10:00-12:00' },
            { name: 'ÁéâÊ≥âÊ¥û', type: 'ÊôØÈªû', location: 'ÂçóÂüéÂ∏Ç', time: '09:00-12:00' },
            { name: 'ÁÄ®Èï∑Â≥∂', type: 'ÊôØÈªû', location: 'Ë±êË¶ãÂüéÂ∏Ç', time: '16:00-19:00' }
        ],
        foods: ['Ê≤ñÁπ©È∫µ', 'Êµ∑Ëë°ËêÑ', 'Â°îÂèØÈ£Ø', 'Áü≥Âû£Áâõ', 'Ëã¶ÁìúÁÇíËõã', 'Á¥ÖËäãÂ°î', 'Ê≥°Áõõ', 'Ë±¨ËÖ≥', 'Ê≤ñÁπ©ÈªëÁ≥ñ', 'Êµ∑ÈÆÆ'],
        defaultSchedule: []
    },
    'üá∞üá∑ È¶ñÁàæ': {
        country: 'ÈüìÂúã', continent: '‰∫ûÊ¥≤', currency: 'KRW',
        spots: [
            { name: 'ÊôØÁ¶èÂÆÆ', type: 'ÊôØÈªû', location: 'È¶ñÁàæÈêòË∑ØÂçÄ', time: '09:00-12:00' },
            { name: 'ÂåóÊùëÈüìÂ±ãÊùë', type: 'ÊôØÈªû', location: 'È¶ñÁàæÈêòË∑ØÂçÄ', time: '10:00-12:00' },
            { name: 'ÊòéÊ¥û', type: 'Ë≥ºÁâ©', location: 'È¶ñÁàæ‰∏≠ÂçÄ', time: '14:00-18:00' },
            { name: 'NÈ¶ñÁàæÂ°î', type: 'ÊôØÈªû', location: 'È¶ñÁàæÈæçÂ±±ÂçÄ', time: '18:00-21:00' },
            { name: 'ÂºòÂ§ß', type: 'Ë≥ºÁâ©', location: 'È¶ñÁàæÈ∫ªÊµ¶ÂçÄ', time: '15:00-20:00' },
            { name: 'Êù±Â§ßÈñÄ', type: 'Ë≥ºÁâ©', location: 'È¶ñÁàæ‰∏≠ÂçÄ', time: '20:00-24:00' },
            { name: 'Âª£ËóèÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'È¶ñÁàæÈêòË∑ØÂçÄ', time: '10:00-13:00' },
            { name: 'Ê¢®Ëä±Â•≥Â≠êÂ§ßÂ≠∏', type: 'ÊôØÈªû', location: 'È¶ñÁàæË•øÂ§ßÈñÄÂçÄ', time: '14:00-16:00' },
            { name: 'ÊòåÂæ∑ÂÆÆ', type: 'ÊôØÈªû', location: 'È¶ñÁàæÈêòË∑ØÂçÄ', time: '09:00-11:00' },
            { name: 'Ê±ùÁü£Â≥∂', type: 'ÊôØÈªû', location: 'È¶ñÁàæÊ∞∏ÁôªÊµ¶ÂçÄ', time: '15:00-18:00' }
        ],
        foods: ['ÈüìÂºèÁÉ§ËÇâ', 'ÈÉ®ÈöäÈçã', 'ÁÇ∏ÈõûÂï§ÈÖí', '‰∫∫ËîòÈõûÊπØ', 'Ëæ£ÁÇíÂπ¥Á≥ï', 'Áü≥ÈçãÊãåÈ£Ø', 'ÂÜ∑È∫µ', 'Ë±¨ËÖ≥', 'ÈüìÂºèÁÇ∏ÈÜ¨È∫µ', 'Á¥´ËèúÈ£ØÊç≤'],
        defaultSchedule: [{ title: 'ÊäµÈÅî‰ªÅÂ∑ùÊ©üÂ†¥', type: '‰∫§ÈÄö', time: '12:00-14:00' }]
    },
    'üá∞üá∑ ÈáúÂ±±': {
        country: 'ÈüìÂúã', continent: '‰∫ûÊ¥≤', currency: 'KRW',
        spots: [
            { name: 'Êµ∑Èõ≤Âè∞Êµ∑Ê∞¥Êµ¥Â†¥', type: 'ÊôØÈªû', location: 'ÈáúÂ±±Êµ∑Èõ≤Âè∞ÂçÄ', time: '09:00-12:00' },
            { name: 'ÁîòÂ∑ùÊñáÂåñÊùë', type: 'ÊôØÈªû', location: 'ÈáúÂ±±Ê≤ô‰∏ãÂçÄ', time: '10:00-13:00' },
            { name: 'Ë•øÈù¢', type: 'Ë≥ºÁâ©', location: 'ÈáúÂ±±ÈáúÂ±±ÈéÆÂçÄ', time: '14:00-18:00' },
            { name: 'Êú≠ÂòéÂÖ∂Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'ÈáúÂ±±‰∏≠ÂçÄ', time: '08:00-11:00' },
            { name: 'Âª£ÂÆâÂ§ßÊ©ã', type: 'ÊôØÈªû', location: 'ÈáúÂ±±Ê∞¥ÁáüÂçÄ', time: '18:00-21:00' },
            { name: 'ÈæçÈ†≠Â±±ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÈáúÂ±±‰∏≠ÂçÄ', time: '09:00-11:00' },
            { name: 'Â§™ÂÆóÂè∞', type: 'ÊôØÈªû', location: 'ÈáúÂ±±ÂΩ±Â≥∂ÂçÄ', time: '10:00-14:00' },
            { name: 'Êµ∑Êù±ÈæçÂÆÆÂØ∫', type: 'ÊôØÈªû', location: 'ÈáúÂ±±Ê©üÂºµÈÉ°', time: '08:00-11:00' },
            { name: 'Ê¢µÈ≠öÂØ∫', type: 'ÊôØÈªû', location: 'ÈáúÂ±±Èáë‰∫ïÂçÄ', time: '09:00-12:00' },
            { name: 'BIFFÂª£Â†¥', type: 'Ë≥ºÁâ©', location: 'ÈáúÂ±±‰∏≠ÂçÄ', time: '15:00-19:00' }
        ],
        foods: ['Ë±¨ËÇâÊπØÈ£Ø', 'ÁîüÈ≠öÁâá', 'ÁÉ§ËÖ∏', 'È≠öÁ≥ï', 'ÈªëËº™', 'Êµ∑ÈÆÆÁÖéÈ§Ö', 'ÁÉ§ÈØñÈ≠ö', 'ÂàÄÂâäÈ∫µ', 'Á¥ÖË±ÜÂÜ∞', 'Â•∂Â•∂ÊπØÈ£Ø'],
        defaultSchedule: []
    },
    'üá∞üá∑ ÊøüÂ∑ûÂ≥∂': {
        country: 'ÈüìÂúã', continent: '‰∫ûÊ¥≤', currency: 'KRW',
        spots: [
            { name: 'ÂüéÂ±±Êó•Âá∫Â≥∞', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûË•øÊ≠∏Êµ¶Â∏Ç', time: '05:00-08:00' },
            { name: 'Êº¢ÊãèÂ±±', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûÂ∏Ç', time: '06:00-14:00' },
            { name: 'Â§©Â∏ùÊ∑µÁÄëÂ∏É', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûË•øÊ≠∏Êµ¶Â∏Ç', time: '09:00-11:00' },
            { name: 'ÁâõÂ≥∂', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûÂ∏Ç', time: '09:00-16:00' },
            { name: 'Ê∂âÂú∞ÂèØÊîØ', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûË•øÊ≠∏Êµ¶Â∏Ç', time: '09:00-12:00' },
            { name: 'Êù±ÈñÄÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'ÊøüÂ∑ûÂ∏Ç', time: '10:00-13:00' },
            { name: 'Ëê¨‰∏àÁ™ü', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûÂ∏Ç', time: '09:00-11:00' },
            { name: '‰∏≠ÊñáËßÄÂÖâÂúíÂçÄ', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûË•øÊ≠∏Êµ¶Â∏Ç', time: '10:00-16:00' },
            { name: 'Â±±Âêõ‰∏çÈõ¢', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûÂ∏Ç', time: '09:00-11:00' },
            { name: 'ÈæçÈ†≠Â≤©', type: 'ÊôØÈªû', location: 'ÊøüÂ∑ûÂ∏Ç', time: '16:00-18:00' }
        ],
        foods: ['ÈªëË±¨ËÇâÁÉ§ËÇâ', 'Êµ∑ÈÆÆÈçã', 'ÈÆëÈ≠öÁ≤•', 'Ê©òÂ≠ê', 'ÁîüÈ≠öÁâá', 'Â∏∂È≠ö', 'ÁÉ§Â∏∂È≠ö', 'Êµ∑ËÜΩÊπØ', 'Ë±¨ËÇâÈ∫µ', 'Á∂†Ëå∂'],
        defaultSchedule: []
    },
    'üáπüá≠ ÊõºË∞∑': {
        country: 'Ê≥∞Âúã', continent: '‰∫ûÊ¥≤', currency: 'THB',
        spots: [
            { name: 'Â§ßÁöáÂÆÆ', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '08:30-12:00' },
            { name: 'ÈÑ≠ÁéãÂªü', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '08:00-10:00' },
            { name: 'ÊÅ∞ÂúñÊÅ∞ÈÄ±Êú´Â∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'ÊõºË∞∑', time: '09:00-17:00' },
            { name: 'ËÄÉÂ±±Ë∑Ø', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '18:00-23:00' },
            { name: 'ÂõõÈù¢‰Ωõ', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '09:00-10:00' },
            { name: 'Terminal 21', type: 'Ë≥ºÁâ©', location: 'ÊõºË∞∑', time: '11:00-20:00' },
            { name: 'Ê∞¥‰∏äÂ∏ÇÂ†¥', type: 'ÊôØÈªû', location: 'ÊõºË∞∑ËøëÈÉä', time: '07:00-12:00' },
            { name: 'Ëá•‰ΩõÂØ∫', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '08:00-10:00' },
            { name: 'AsiatiqueÊ≤≥Êø±Â§úÂ∏Ç', type: 'Ë≥ºÁâ©', location: 'ÊõºË∞∑', time: '17:00-23:00' },
            { name: 'ÈáëÂ±±ÂØ∫', type: 'ÊôØÈªû', location: 'ÊõºË∞∑', time: '08:00-10:00' }
        ],
        foods: ['Ê≥∞ÂºèÁÇíÊ≤≥Á≤â', 'Á∂†ÂíñÂì©', 'ËäíÊûúÁ≥ØÁ±≥È£Ø', 'ÂÜ¨Ëî≠ÂäüÊπØ', 'Ê≥∞ÂºèÂ•∂Ëå∂', 'ÊâìÊããË±¨ËÇâÈ£Ø', 'Ê§∞Â≠êÂÜ∞Ê∑áÊ∑ã', 'ÁÉ§ËÇâ‰∏≤', 'ÈùíÊú®ÁìúÊ≤ôÊãâ', 'È¶ôËïâÁÖéÈ§Ö'],
        defaultSchedule: []
    },
    'üáπüá≠ Ê∏ÖÈÇÅ': {
        country: 'Ê≥∞Âúã', continent: '‰∫ûÊ¥≤', currency: 'THB',
        spots: [
            { name: 'Á¥†Â∏ñÂ±±ÈõôÈæçÂØ∫', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '08:00-11:00' },
            { name: 'Ê∏ÖÈÇÅÂè§Âüé', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '09:00-12:00' },
            { name: 'ÈÄ±Êó•Â§úÂ∏Ç', type: 'Ë≥ºÁâ©', location: 'Ê∏ÖÈÇÅ', time: '16:00-22:00' },
            { name: 'Â§ßË±°Ëá™ÁÑ∂ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '08:00-15:00' },
            { name: 'ÂØßÊõºË∑Ø', type: 'Ë≥ºÁâ©', location: 'Ê∏ÖÈÇÅ', time: '11:00-20:00' },
            { name: 'Â•ëËø™ÈæçÂØ∫', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '08:00-10:00' },
            { name: 'Ê∏ÖÈÇÅÂ§úÈñìÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '18:00-22:00' },
            { name: 'Â∏ïËæõÂØ∫', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '06:00-08:00' },
            { name: 'Áì¶Ê¥õÊ¥õÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Ê∏ÖÈÇÅ', time: '06:00-12:00' },
            { name: 'Ëí≤Â±èÁöáÂÆÆ', type: 'ÊôØÈªû', location: 'Ê∏ÖÈÇÅ', time: '09:00-12:00' }
        ],
        foods: ['ÂíñÂì©È∫µ', 'ÁÇ∏Ë±¨ÁöÆ', 'ÈùíËæ£Ê§íÈÜ¨', 'È¶ôËÖ∏', 'Ê≥∞ÂåóÁÉ§Èõû', 'Á´πÁ≠íÈ£Ø', 'Ê∂ºÊãåËÇâÊú´', 'Ê≥∞ÂºèÁ±≥Á≤âÊπØ', 'Ê∏ÖÈÇÅÊ≤ôÂó≤', 'ËäíÊûúÂÜ∞Ê≤ô'],
        defaultSchedule: []
    },
    'üáπüá≠ ÊôÆÂêâÂ≥∂': {
        country: 'Ê≥∞Âúã', continent: '‰∫ûÊ¥≤', currency: 'THB',
        spots: [
            { name: 'Â∑¥Êù±Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '09:00-17:00' },
            { name: 'Âç°ÂÄ´Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '09:00-17:00' },
            { name: 'ÊôÆÂêâËÄÅÂüéÂçÄ', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '10:00-14:00' },
            { name: 'Êü•ÈæçÂØ∫', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '08:00-10:00' },
            { name: 'Ëä≠Êù±Â§úÂ∏Ç', type: 'Ë≥ºÁâ©', location: 'ÊôÆÂêâÂ≥∂', time: '18:00-23:00' },
            { name: 'ÊîÄÁâôÁÅ£', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '08:00-16:00' },
            { name: 'ÁöÆÁöÆÂ≥∂', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '07:00-17:00' },
            { name: 'Âç°Â°îÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '09:00-17:00' },
            { name: 'ÊôÆÂêâÂ§ß‰Ωõ', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '08:00-10:00' },
            { name: 'ÂπªÂ§öÂ•áÊ®ÇÂúí', type: 'ÊôØÈªû', location: 'ÊôÆÂêâÂ≥∂', time: '17:00-23:00' }
        ],
        foods: ['Êµ∑ÈÆÆÂ§ßÈ§ê', 'Ê≥∞ÂºèÁÇíÈ£Ø', 'È≥≥Ê¢®ÁÇíÈ£Ø', 'ÁÉ§Êµ∑ÈÆÆ', 'Ê§∞Â≠êÂÜ∞', 'Ê∂ºÊãåÊµ∑ÈÆÆ', 'ÂíñÂì©Ëüπ', 'ÁÇíÁ©∫ÂøÉËèú', 'Ê§∞ÊºøÈõûÊπØ', 'Ê≥∞ÂºèÊò•Êç≤'],
        defaultSchedule: []
    },
    'üá∏üá¨ Êñ∞Âä†Âù°': {
        country: 'Êñ∞Âä†Âù°', continent: '‰∫ûÊ¥≤', currency: 'SGD',
        spots: [
            { name: 'È≠öÂ∞æÁçÖÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Êø±Êµ∑ÁÅ£', time: '09:00-11:00' },
            { name: 'Êø±Êµ∑ÁÅ£ÈáëÊ≤ô', type: 'ÊôØÈªû', location: 'Êø±Êµ∑ÁÅ£', time: '11:00-14:00' },
            { name: 'ËÅñÊ∑òÊ≤ôÂ≥∂', type: 'ÊôØÈªû', location: 'ËÅñÊ∑òÊ≤ô', time: '09:00-18:00' },
            { name: 'ÁâõËªäÊ∞¥', type: 'ÁæéÈ£ü', location: 'ÁâõËªäÊ∞¥', time: '11:00-14:00' },
            { name: 'Â∞èÂç∞Â∫¶', type: 'ÊôØÈªû', location: 'Â∞èÂç∞Â∫¶', time: '10:00-12:00' },
            { name: 'ÁÉèÁØÄË∑Ø', type: 'Ë≥ºÁâ©', location: 'ÁÉèÁØÄ', time: '14:00-19:00' },
            { name: 'Êø±Êµ∑ÁÅ£Ëä±Âúí', type: 'ÊôØÈªû', location: 'Êø±Êµ∑ÁÅ£', time: '18:00-21:00' },
            { name: 'ÂÖãÊãâÁ¢ºÈ†≠', type: 'ÁæéÈ£ü', location: 'ÂÖãÊãâÁ¢ºÈ†≠', time: '18:00-22:00' },
            { name: 'Êñ∞Âä†Âù°ÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Ëê¨Á¶Æ', time: '08:30-16:00' },
            { name: 'Áí∞ÁêÉÂΩ±Âüé', type: 'ÊôØÈªû', location: 'ËÅñÊ∑òÊ≤ô', time: '10:00-19:00' }
        ],
        foods: ['Êµ∑ÂçóÈõûÈ£Ø', 'Ëæ£Ê§íËûÉËüπ', 'ËÇâÈ™®Ëå∂', 'Ê≤ôÂó≤', 'ÂèªÊ≤ô', 'ÁÇíÁ≤øÊ¢ù', 'ÂíñÊ§∞ÂêêÂè∏', 'Ê¶¥Êß§', 'ÁæÖÊÉπ', 'Á¶èÂª∫Ëù¶È∫µ'],
        defaultSchedule: []
    },
    'üáªüá≥ Ê≤≥ÂÖß': {
        country: 'Ë∂äÂçó', continent: '‰∫ûÊ¥≤', currency: 'VND',
        spots: [
            { name: 'ÈÇÑÂäçÊπñ', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '07:00-09:00' },
            { name: 'ËÉ°ÂøóÊòéÁ¥ÄÂøµÂ†Ç', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '08:00-11:00' },
            { name: '‰∏âÂçÅÂÖ≠Âè§Ë°ó', type: 'Ë≥ºÁâ©', location: 'Ê≤≥ÂÖß', time: '10:00-18:00' },
            { name: 'ÊñáÂªü', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '08:00-10:00' },
            { name: 'Ë•øÊπñ', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '16:00-18:00' },
            { name: 'Ê≤≥ÂÖßÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '09:00-10:00' },
            { name: 'ÁÅ´ÁàêÁõ£ÁçÑ', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '08:00-11:00' },
            { name: 'Ê≤≥ÂÖßÊ≠åÂäáÈô¢', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '19:00-21:00' },
            { name: 'Ê∞¥‰∏äÊú®ÂÅ∂Êà≤', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '17:00-18:00' },
            { name: 'ÈæçÈÇäÊ©ã', type: 'ÊôØÈªû', location: 'Ê≤≥ÂÖß', time: '18:00-20:00' }
        ],
        foods: ['Ê≤≥Á≤â', 'Êò•Êç≤', 'Ë∂äÂçóÂíñÂï°', 'Ê≥ïÂúãÈ∫µÂåÖ', 'ÁÉ§ËÇâÁ±≥Á≤â', 'ÈõûËõãÂíñÂï°', 'Ê≤≥ÂÖßÁÉ§ËÇâ', 'ËüπËÇâÁ±≥Á≤â', 'ÁÇ∏Êò•Êç≤', 'ÁîòËîóËù¶'],
        defaultSchedule: []
    },
    'üáªüá≥ ËÉ°ÂøóÊòéÂ∏Ç': {
        country: 'Ë∂äÂçó', continent: '‰∫ûÊ¥≤', currency: 'VND',
        spots: [
            { name: 'Áµ±‰∏ÄÂÆÆ', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '08:00-11:00' },
            { name: 'Êø±ÂüéÂ∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '07:00-18:00' },
            { name: 'Ë•øË≤¢ËÅñÊØçÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '08:00-10:00' },
            { name: 'Âè§ËäùÂú∞ÈÅì', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏ÇÈÉä', time: '08:00-14:00' },
            { name: 'Êà∞Áà≠ÈÅ∫Ë∑°ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '08:00-12:00' },
            { name: 'ËåÉ‰∫îËÄÅË°ó', type: 'Ë≥ºÁâ©', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '18:00-23:00' },
            { name: 'Ë•øË≤¢‰∏≠Â§ÆÈÉµÂ±Ä', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '08:00-10:00' },
            { name: 'ÈáëËûçÂ°îËßÄÊôØÂè∞', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '09:30-21:00' },
            { name: 'Âπ≥Ë•øÂ∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '06:00-18:00' },
            { name: 'Ê∞∏Âö¥ÂØ∫', type: 'ÊôØÈªû', location: 'ËÉ°ÂøóÊòéÂ∏Ç', time: '08:00-17:00' }
        ],
        foods: ['Á¢éËÇâÈ£Ø', 'ÁâõËÇâÊ≤≥Á≤â', 'Ë∂äÂçó‰∏âÊòéÊ≤ª', 'ÁîüÊò•Êç≤', 'Ë∂äÂçóÁÖéÈ§Ö', 'ÁîòËîóÊ±Å', 'Êª¥ÊºèÂíñÂï°', 'Ê∂ºÊãåÈùíÊú®Áìú', 'ËìÆÂ≠êÁîúÊπØ', 'Ê§∞Â≠êÂÜ∞Ê∑áÊ∑ã'],
        defaultSchedule: []
    },
    'üá≠üá∞ È¶ôÊ∏Ø': {
        country: 'È¶ôÊ∏Ø', continent: '‰∫ûÊ¥≤', currency: 'HKD',
        spots: [
            { name: 'Á∂≠Â§öÂà©‰∫ûÊ∏Ø', type: 'ÊôØÈªû', location: 'Â∞ñÊ≤ôÂíÄ', time: '19:00-21:00' },
            { name: 'Â§™Âπ≥Â±±È†Ç', type: 'ÊôØÈªû', location: '‰∏≠Áí∞', time: '18:00-21:00' },
            { name: 'Ëø™Â£´Â∞ºÊ®ÇÂúí', type: 'ÊôØÈªû', location: 'Â§ßÂ∂ºÂ±±', time: '10:00-20:00' },
            { name: 'Êó∫Ëßí', type: 'Ë≥ºÁâ©', location: 'Êó∫Ëßí', time: '14:00-22:00' },
            { name: 'ÂªüË°óÂ§úÂ∏Ç', type: 'Ë≥ºÁâ©', location: 'Ê≤πÈ∫ªÂú∞', time: '18:00-23:00' },
            { name: 'Â§©Â£áÂ§ß‰Ωõ', type: 'ÊôØÈªû', location: 'Â§ßÂ∂ºÂ±±', time: '10:00-14:00' },
            { name: 'Êµ∑Ê¥ãÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÂçóÂçÄ', time: '10:00-19:00' },
            { name: 'Ëò≠Ê°ÇÂùä', type: 'ÊôØÈªû', location: '‰∏≠Áí∞', time: '20:00-02:00' },
            { name: 'ÊòüÂÖâÂ§ßÈÅì', type: 'ÊôØÈªû', location: 'Â∞ñÊ≤ôÂíÄ', time: '19:00-21:00' },
            { name: 'ÈªÉÂ§ß‰ªôÁ•†', type: 'ÊôØÈªû', location: 'ÈªÉÂ§ß‰ªô', time: '07:00-17:30' }
        ],
        foods: ['ÁáíËáò', 'Ê∏ØÂºèÈªûÂøÉ', 'Èõ≤ÂêûÈ∫µ', 'Áµ≤Ë•™Â•∂Ëå∂', 'Ëè†ËòøÊ≤π', 'ËõãÊíª', 'ÁÖ≤‰ªîÈ£Ø', 'ÈÅøÈ¢®Â°òÁÇíËüπ', 'È≠öËõã', 'Ê•äÊûùÁîòÈú≤'],
        defaultSchedule: []
    },
    'üá≤üá¥ Êæ≥ÈñÄ': {
        country: 'Êæ≥ÈñÄ', continent: '‰∫ûÊ¥≤', currency: 'MOP',
        spots: [
            { name: 'Â§ß‰∏âÂ∑¥ÁâåÂùä', type: 'ÊôØÈªû', location: 'Êæ≥ÈñÄÂçäÂ≥∂', time: '09:00-18:00' },
            { name: 'Â®ÅÂ∞ºÊñØ‰∫∫', type: 'Ë≥ºÁâ©', location: 'Ë∑ØÊ∞πÂüé', time: '10:00-23:00' },
            { name: 'Ë≠∞‰∫ã‰∫≠ÂâçÂú∞', type: 'ÊôØÈªû', location: 'Êæ≥ÈñÄÂçäÂ≥∂', time: '10:00-18:00' },
            { name: 'Êæ≥ÈñÄÊóÖÈÅäÂ°î', type: 'ÊôØÈªû', location: 'ÂçóÁÅ£', time: '10:00-21:00' },
            { name: 'Â™ΩÈñ£Âªü', type: 'ÊôØÈªû', location: 'Êæ≥ÈñÄÂçäÂ≥∂', time: '07:00-18:00' },
            { name: 'ÂÆò‰πüË°ó', type: 'ÁæéÈ£ü', location: 'Ê∞π‰ªî', time: '10:00-22:00' },
            { name: 'Êñ∞Êø†Â§©Âú∞', type: 'ÊôØÈªû', location: 'Ë∑ØÊ∞πÂüé', time: '10:00-23:00' },
            { name: 'Êù±ÊúõÊ¥ãÁáàÂ°î', type: 'ÊôØÈªû', location: 'Êæ≥ÈñÄÂçäÂ≥∂', time: '09:00-17:30' },
            { name: 'ÈæçÁí∞Ëë°Èüª', type: 'ÊôØÈªû', location: 'Ê∞π‰ªî', time: '10:00-19:00' },
            { name: 'Ë∑ØÁí∞', type: 'ÊôØÈªû', location: 'Ë∑ØÁí∞', time: '10:00-18:00' }
        ],
        foods: ['Ëë°ÂºèËõãÊíª', 'Ë±¨ÊâíÂåÖ', 'Ê∞¥ËüπÁ≤•', 'Êú®Á≥†Â∏ÉÁî∏', 'Ëë°ÂúãÈõû', 'ÈùûÊ¥≤Èõû', 'Á´πÊòáÈ∫µ', 'ÈõôÁöÆÂ•∂', 'Êùè‰ªÅÈ§Ö', 'ÁâõÈõú'],
        defaultSchedule: []
    },
    'üá≤üáæ ÂêâÈöÜÂù°': {
        country: 'È¶¨‰æÜË•ø‰∫û', continent: '‰∫ûÊ¥≤', currency: 'MYR',
        spots: [
            { name: 'ÈõôÂ≥∞Â°î', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '09:00-21:00' },
            { name: 'Ëå®Âª†Ë°ó', type: 'Ë≥ºÁâ©', location: 'ÂêâÈöÜÂù°', time: '10:00-22:00' },
            { name: 'ÈªëÈ¢®Ê¥û', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '06:00-19:00' },
            { name: 'Áç®Á´ãÂª£Â†¥', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '09:00-18:00' },
            { name: 'ÈòøÁæÖË°ó', type: 'ÁæéÈ£ü', location: 'ÂêâÈöÜÂù°', time: '17:00-02:00' },
            { name: 'ÂúãÂÆ∂Ê∏ÖÁúüÂØ∫', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '09:00-18:00' },
            { name: '‰∏≠Â§ÆËóùË°ìÂùä', type: 'Ë≥ºÁâ©', location: 'ÂêâÈöÜÂù°', time: '10:00-21:00' },
            { name: 'ÂêâÈöÜÂù°Â°î', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '09:00-22:00' },
            { name: 'ÂúãÂÆ∂ÁöáÂÆÆ', type: 'ÊôØÈªû', location: 'ÂêâÈöÜÂù°', time: '09:00-17:00' },
            { name: 'Ê≠¶ÂêâÂÖçÁôª', type: 'Ë≥ºÁâ©', location: 'ÂêâÈöÜÂù°', time: '10:00-22:00' }
        ],
        foods: ['Ê§∞ÊºøÈ£Ø', 'Ê≤ôÂó≤', 'ËÇâÈ™®Ëå∂', 'ÁÇíÁ≤øÊ¢ù', 'ÂèªÊ≤ô', 'Èõ≤ÂêûÈ∫µ', 'Âç∞Â∫¶ÁÖéÈ§Ö', 'Ê¶¥Êß§', 'ÊãâËå∂', 'ÂíñÂì©È∫µ'],
        defaultSchedule: []
    },
    'üáÆüá© Â≥áÈáåÂ≥∂': {
        country: 'Âç∞Â∞º', continent: '‰∫ûÊ¥≤', currency: 'IDR',
        spots: [
            { name: 'ÁÉèÂ∏ÉÁöáÂÆÆ', type: 'ÊôØÈªû', location: 'ÁÉèÂ∏É', time: '08:00-17:00' },
            { name: 'Êµ∑Á•ûÂªü', type: 'ÊôØÈªû', location: 'Â°îÂ∑¥Âçó', time: '06:00-19:00' },
            { name: 'ËÅñÁå¥Ê£ÆÊûóÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÁÉèÂ∏É', time: '08:30-18:00' },
            { name: 'Âæ∑Ê†ºÊãâÊúóÊ¢ØÁî∞', type: 'ÊôØÈªû', location: 'ÁÉèÂ∏É', time: '08:00-18:00' },
            { name: 'Â∫´Â°îÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Â∫´Â°î', time: '07:00-19:00' },
            { name: 'ÁÉèÈ≠ØÁì¶ÂúñÊñ∑Â¥ñ', type: 'ÊôØÈªû', location: 'ÁÉèÈ≠ØÁì¶Âúñ', time: '09:00-19:00' },
            { name: 'Ê∞¥Á•ûÂªü', type: 'ÊôØÈªû', location: 'Â°îÂ∑¥Âçó', time: '08:00-18:00' },
            { name: 'ÈáëÂ∑¥Ëò≠Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÈáëÂ∑¥Ëò≠', time: '17:00-19:00' },
            { name: 'ËÅñÊ≥âÂØ∫', type: 'ÊôØÈªû', location: 'Âù¶Â∏ïË•øÊûó', time: '08:00-18:00' },
            { name: 'Âä™Ê≤ôÊùúÁì¶Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Âä™Ê≤ôÊùúÁì¶', time: '09:00-17:00' }
        ],
        foods: ['È´íÈ¥®È£Ø', 'Ê≤ôÂó≤', 'Âç∞Â∞ºÁÇíÈ£Ø', 'Â∑¥ÊØîË±¨ËÇãÊéí', 'Âä†Â§öÂä†Â§ö', 'ËòáÂ§öÈõûÊπØ', 'ÁÉ§‰π≥Ë±¨', 'ÈªÉËñëÈ£Ø', 'Âç∞Â∞ºÁÇíÈ∫µ', 'Ê§∞Â≠êÂÜ∞'],
        defaultSchedule: []
    },
    'üáµüá≠ Èï∑ÁÅòÂ≥∂': {
        country: 'Ëè≤ÂæãË≥ì', continent: '‰∫ûÊ¥≤', currency: 'PHP',
        spots: [
            { name: 'ÁôΩÊ≤ôÁÅò', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '06:00-18:00' },
            { name: 'D Mall', type: 'Ë≥ºÁâ©', location: 'Èï∑ÁÅòÂ≥∂', time: '10:00-22:00' },
            { name: 'ÊôÆÂç°Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '08:00-17:00' },
            { name: 'ÁõßÈúçÂ±±', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '15:00-18:00' },
            { name: 'ÊòüÊúü‰∫îÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '09:00-17:00' },
            { name: 'ÈòøÈáåÂüÉÁàæËßí', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '08:00-17:00' },
            { name: 'Ê∞¥Êô∂Ê¥û', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '09:00-15:00' },
            { name: 'ËùôËù†Ê¥û', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '16:00-18:00' },
            { name: 'TalipapaÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Èï∑ÁÅòÂ≥∂', time: '08:00-20:00' },
            { name: 'Â∏ÉÊãâÊ≥¢Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Èï∑ÁÅòÂ≥∂', time: '09:00-17:00' }
        ],
        foods: ['ÁÉ§‰π≥Ë±¨', 'ÁâõÈ™®ÊπØ', 'ÈÜãÁáúË±¨ËÇâ', 'Êµ∑ÈÆÆ', 'ËäíÊûúÂÜ∞Ê≤ô', 'ÁÇ∏È¶ôËïâ', 'Halo-Halo', 'ÁÉ§È≠∑È≠ö', 'Ëè≤ÂºèÈêµÊùø', 'Ê§∞Â≠êÊ∞¥'],
        defaultSchedule: []
    },
    'üá®üá≥ ‰∏äÊµ∑': {
        country: '‰∏≠Âúã', continent: '‰∫ûÊ¥≤', currency: 'CNY',
        spots: [
            { name: 'Â§ñÁÅò', type: 'ÊôØÈªû', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '18:00-22:00' },
            { name: 'Êù±ÊñπÊòéÁè†Â°î', type: 'ÊôØÈªû', location: '‰∏äÊµ∑Êµ¶Êù±Êñ∞ÂçÄ', time: '08:00-21:30' },
            { name: 'ÂüéÈöçÂªü', type: 'ÊôØÈªû', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '08:30-16:30' },
            { name: 'Âçó‰∫¨Ë∑ØÊ≠•Ë°åË°ó', type: 'Ë≥ºÁâ©', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '10:00-22:00' },
            { name: 'Áî∞Â≠êÂùä', type: 'Ë≥ºÁâ©', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '10:00-22:00' },
            { name: '‰∏äÊµ∑Ëø™Â£´Â∞º', type: 'ÊôØÈªû', location: '‰∏äÊµ∑Êµ¶Êù±Êñ∞ÂçÄ', time: '08:00-20:00' },
            { name: 'Ë±´Âúí', type: 'ÊôØÈªû', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '08:30-17:00' },
            { name: 'Êñ∞Â§©Âú∞', type: 'Ë≥ºÁâ©', location: '‰∏äÊµ∑ÈªÉÊµ¶ÂçÄ', time: '10:00-24:00' },
            { name: 'ÈùúÂÆâÂØ∫', type: 'ÊôØÈªû', location: '‰∏äÊµ∑ÈùúÂÆâÂçÄ', time: '07:30-17:00' },
            { name: 'Êú±ÂÆ∂ËßíÂè§ÈéÆ', type: 'ÊôØÈªû', location: '‰∏äÊµ∑ÈùíÊµ¶ÂçÄ', time: '08:00-17:00' }
        ],
        foods: ['Â∞èÁ±†ÂåÖ', 'ÁîüÁÖéÂåÖ', 'Ëî•Ê≤πÊãåÈ∫µ', 'Á¥ÖÁáíËÇâ', 'Â§ßÈñòËüπ', 'ÁôΩÊñ¨Èõû', 'Á≥ñÈÜãÊéíÈ™®', 'ÈÜ¨È¥®', 'Ê≤πÁàÜËù¶', 'ÂÖ´ÂØ∂È£Ø'],
        defaultSchedule: []
    },
    'üá®üá≥ Âåó‰∫¨': {
        country: '‰∏≠Âúã', continent: '‰∫ûÊ¥≤', currency: 'CNY',
        spots: [
            { name: 'ÊïÖÂÆÆ', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Êù±ÂüéÂçÄ', time: '08:30-17:00' },
            { name: 'Èï∑Âüé', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Âª∂ÊÖ∂ÂçÄ', time: '07:30-17:30' },
            { name: 'Â§©ÂÆâÈñÄÂª£Â†¥', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Êù±ÂüéÂçÄ', time: '05:00-22:00' },
            { name: 'È†§ÂíåÂúí', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Êµ∑Ê∑ÄÂçÄ', time: '06:30-18:00' },
            { name: 'Â§©Â£á', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Êù±ÂüéÂçÄ', time: '06:00-21:00' },
            { name: '‰ªÄÂâéÊµ∑', type: 'ÊôØÈªû', location: 'Âåó‰∫¨Ë•øÂüéÂçÄ', time: 'ÂÖ®Â§©' },
            { name: 'ÂçóÈëºÈºìÂ∑∑', type: 'Ë≥ºÁâ©', location: 'Âåó‰∫¨Êù±ÂüéÂçÄ', time: '10:00-22:00' },
            { name: '798ËóùË°ìÂçÄ', type: 'ÊôØÈªû', location: 'Âåó‰∫¨ÊúùÈôΩÂçÄ', time: '10:00-18:00' },
            { name: 'È≥•Â∑¢', type: 'ÊôØÈªû', location: 'Âåó‰∫¨ÊúùÈôΩÂçÄ', time: '09:00-21:00' },
            { name: 'ÁéãÂ∫ú‰∫ï', type: 'Ë≥ºÁâ©', location: 'Âåó‰∫¨Êù±ÂüéÂçÄ', time: '09:00-22:00' }
        ],
        foods: ['Âåó‰∫¨ÁÉ§È¥®', 'ÁÇ∏ÈÜ¨È∫µ', 'Ê∂ÆÁæäËÇâ', 'Ë±ÜÊ±Å', 'È©¢ÊâìÊªæ', 'ÂÜ∞Á≥ñËë´ËòÜ', '‰∫¨ÈÜ¨ËÇâÁµ≤', 'ÂÆÆ‰øùÈõû‰∏Å', 'È∫ªË±ÜËÖê', 'ÁàÜËÇö'],
        defaultSchedule: []
    },

    // ============ Ê≠êÊ¥≤ (Europe) ============
    'üá´üá∑ Â∑¥Èªé': {
        country: 'Ê≥ïÂúã', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ËâæËè≤ÁàæÈêµÂ°î', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨‰∏ÉÂçÄ', time: '09:00-00:00' },
            { name: 'ÁæÖÊµÆÂÆÆ', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨‰∏ÄÂçÄ', time: '09:00-18:00' },
            { name: 'Âá±ÊóãÈñÄ', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨ÂÖ´ÂçÄ', time: '10:00-22:30' },
            { name: 'È¶ôÊ¶≠È∫óËàçÂ§ßÈÅì', type: 'Ë≥ºÁâ©', location: 'Â∑¥ÈªéÁ¨¨ÂÖ´ÂçÄ', time: '10:00-20:00' },
            { name: 'ËÅñÊØçÈô¢', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨ÂõõÂçÄ', time: '08:00-18:45' },
            { name: 'ËíôÈ¶¨Áâπ', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨ÂçÅÂÖ´ÂçÄ', time: '06:00-22:30' },
            { name: 'Âá°ÁàæË≥ΩÂÆÆ', type: 'ÊôØÈªû', location: 'Âá°ÁàæË≥Ω', time: '09:00-18:30' },
            { name: 'Â°ûÁ¥çÊ≤≥ÈÅäËàπ', type: 'ÊôØÈªû', location: 'Â∑¥Èªé', time: '10:00-22:00' },
            { name: 'Â•ßË≥ΩÁæéË°ìÈ§®', type: 'ÊôØÈªû', location: 'Â∑¥ÈªéÁ¨¨‰∏ÉÂçÄ', time: '09:30-18:00' },
            { name: 'ÊãâÊ≥ïËëâÁôæË≤®', type: 'Ë≥ºÁâ©', location: 'Â∑¥ÈªéÁ¨¨‰πùÂçÄ', time: '09:30-20:30' }
        ],
        foods: ['Ê≥ïÂºèÂèØÈ†å', 'È¶¨Âç°Èæç', 'Ê≥ïÂºèÊ¥ãËî•ÊπØ', 'Á¥ÖÈÖíÁáâÁâõËÇâ', 'ÈµùËÇùÈÜ¨', 'Ê≥ïÂºèËù∏Áâõ', 'ÂèØÈ∫óÈ§Ö', 'Ê≥ïÊ£çÈ∫µÂåÖ', 'Ëµ∑Âè∏ÊãºÁõ§', 'ËàíËäôËïæ'],
        defaultSchedule: []
    },
    'üá¨üáß ÂÄ´Êï¶': {
        country: 'Ëã±Âúã', continent: 'Ê≠êÊ¥≤', currency: 'GBP',
        spots: [
            { name: 'Â§ßÁ¨®Èêò', type: 'ÊôØÈªû', location: 'Ë•øÊïèÂ∏Ç', time: 'ÂÖ®Â§©' },
            { name: 'ÁôΩÈáëÊº¢ÂÆÆ', type: 'ÊôØÈªû', location: 'Ë•øÊïèÂ∏Ç', time: '09:30-19:00' },
            { name: 'ÂÄ´Êï¶Â°î', type: 'ÊôØÈªû', location: 'Â°îÂìàÂßÜÈõ∑ÁâπÂçÄ', time: '09:00-17:30' },
            { name: 'Â§ßËã±ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Âç°ÂßÜÁôªÂçÄ', time: '10:00-17:00' },
            { name: 'ÂÄ´Êï¶Áúº', type: 'ÊôØÈªû', location: 'Ëò≠Ë≤ùÊñØÂçÄ', time: '10:00-20:30' },
            { name: 'Â°îÊ©ã', type: 'ÊôØÈªû', location: 'Â°îÂìàÂßÜÈõ∑ÁâπÂçÄ', time: '09:30-18:00' },
            { name: 'Êµ∑Âæ∑ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Ë•øÊïèÂ∏Ç', time: '05:00-00:00' },
            { name: 'ÊüØËä¨Âúí', type: 'Ë≥ºÁâ©', location: 'Ë•øÊïèÂ∏Ç', time: '10:00-20:00' },
            { name: 'ÁâõÊ¥•Ë°ó', type: 'Ë≥ºÁâ©', location: 'Ë•øÊïèÂ∏Ç', time: '09:30-21:00' },
            { name: 'Ë•øÊïèÂØ∫', type: 'ÊôØÈªû', location: 'Ë•øÊïèÂ∏Ç', time: '09:30-15:30' }
        ],
        foods: ['ÁÇ∏È≠öËñØÊ¢ù', 'Ëã±ÂºèÊó©È§ê', 'ÁÉ§ÁâõËÇâ', 'ÁâßÁæä‰∫∫Ê¥æ', 'Á¥ÑÂÖãÈÉ°Â∏É‰∏Å', 'Âè∏Â∫∑È§Ö', 'Ëã±Âºè‰∏ãÂçàËå∂', 'Â∫∑Ê≤ÉÁàæËÇâÈ§°È§Ö', 'ÈªëÂ∏É‰∏Å', 'Â®ÅÈùàÈ†ìÁâõÊéí'],
        defaultSchedule: []
    },
    'üáÆüáπ ÁæÖÈ¶¨': {
        country: 'Áæ©Â§ßÂà©', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ÁæÖÈ¶¨Á´∂ÊäÄÂ†¥', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: '08:30-19:00' },
            { name: 'ÁâπÈõ∑Á∂≠Âô¥Ê≥â', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: 'ÂÖ®Â§©' },
            { name: 'Ë•øÁè≠ÁâôÈöéÊ¢Ø', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: 'ÂÖ®Â§©' },
            { name: 'Ê¢µËíÇÂ≤°ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Ê¢µËíÇÂ≤°', time: '09:00-18:00' },
            { name: 'ËÅñÂΩºÂæóÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'Ê¢µËíÇÂ≤°', time: '07:00-19:00' },
            { name: 'Ëê¨Á•ûÊÆø', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: '09:00-19:00' },
            { name: 'Âè§ÁæÖÈ¶¨Âª£Â†¥', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: '08:30-19:00' },
            { name: 'Á¥çÊ≤ÉÁ¥çÂª£Â†¥', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: 'ÂÖ®Â§©' },
            { name: 'ÂçöÁàæËìãÂ°ûÁæéË°ìÈ§®', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: '09:00-19:00' },
            { name: 'ÁúüÁêÜ‰πãÂè£', type: 'ÊôØÈªû', location: 'ÁæÖÈ¶¨', time: '09:30-17:50' }
        ],
        foods: ['Áæ©Â§ßÂà©È∫µ', 'Êä´Ëñ©', 'ÊèêÊãâÁ±≥Ëòá', 'Áæ©ÂºèÂÜ∞Ê∑áÊ∑ã', 'ÁáâÈ£Ø', 'ÂçÉÂ±§È∫µ', 'Âç°Â∏ÉÂ•áË´æ', 'Áæ©ÂºèÁÅ´ËÖø', 'Áæ©ÂºèÊøÉÁ∏ÆÂíñÂï°', 'ÁÇ∏È£ØÁêÉ'],
        defaultSchedule: []
    },
    'üáÆüáπ Â®ÅÂ∞ºÊñØ': {
        country: 'Áæ©Â§ßÂà©', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ËÅñÈ¶¨ÂèØÂª£Â†¥', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'ËÅñÈ¶¨ÂèØÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '09:30-17:00' },
            { name: 'Á∏ΩÁù£ÂÆÆ', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '08:30-19:00' },
            { name: 'Èáå‰∫ûÊâòÊ©ã', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'ÂòÜÊÅØÊ©ã', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'Â∏ÉÊãâË´æÂ≥∂', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '09:00-17:00' },
            { name: 'Á©ÜÊãâË´æÂ≥∂', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '09:00-17:00' },
            { name: 'Ë≤¢Â§öÊãâÈÅäËàπ', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '09:00-19:00' },
            { name: 'Â≠∏Èô¢ÁæéË°ìÈ§®', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '08:15-19:15' },
            { name: 'ËÅñÂñ¨Ê≤ªÈ¶¨ÁÑ¶Èõ∑Â≥∂', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: '09:00-19:00' }
        ],
        foods: ['Êµ∑ÈÆÆÁæ©Â§ßÂà©È∫µ', 'Â¢®È≠öÊ±ÅÈ∫µ', 'ÁÇ∏Êµ∑ÈÆÆ', 'Áæ©ÂºèÁÉ§È≠ö', 'Â®ÅÂ∞ºÊñØÈ§Ö‰πæ', 'ÈñãËÉÉÂ∞èÈªû', 'Áæ©ÂºèÂ•∂Âáç', 'ÊôÆÁæÖË≥ΩÂÖãÊ∞£Ê≥°ÈÖí', 'ÁéâÁ±≥Á≥ï', 'Ê≤ô‰∏ÅÈ≠ö'],
        defaultSchedule: []
    },
    'üá™üá∏ Â∑¥Â°ûÈöÜÁ¥ç': {
        country: 'Ë•øÁè≠Áâô', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ËÅñÂÆ∂Â†Ç', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '09:00-20:00' },
            { name: 'Â•éÁàæÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '09:30-19:30' },
            { name: 'Ëò≠Â∏ÉÊãâÂ§ßÈÅì', type: 'Ë≥ºÁâ©', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: 'ÂÖ®Â§©' },
            { name: 'Â∑¥ÁâπÂ©Å‰πãÂÆ∂', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '09:00-21:00' },
            { name: 'Á±≥Êãâ‰πãÂÆ∂', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '09:00-20:30' },
            { name: 'Âì•Âæ∑ÂçÄ', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: 'ÂÖ®Â§©' },
            { name: 'Ê≥¢ËìãÂà©‰∫ûÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '08:00-20:30' },
            { name: 'Â∑¥Â°ûÈöÜÁ¥çÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: 'ÂÖ®Â§©' },
            { name: 'Áï¢Âç°Á¥¢ÁæéË°ìÈ§®', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '10:00-20:00' },
            { name: 'Ë´æÂùéÊôÆÁêÉÂ†¥', type: 'ÊôØÈªû', location: 'Â∑¥Â°ûÈöÜÁ¥ç', time: '10:00-18:30' }
        ],
        foods: ['Ë•øÁè≠ÁâôÊµ∑ÈÆÆÈ£Ø', 'TapasÂ∞èËèú', 'Ë•øÁè≠ÁâôÁÅ´ËÖø', 'Áï™ËåÑÈ∫µÂåÖ', 'ÁÉ§Á´†È≠ö', 'Ë•øÁè≠ÁâôËõãÈ§Ö', 'Ê≤πÊ¢ùÂ∑ßÂÖãÂäõ', 'Ê°ëÊ†ºÂà©‰∫ûÈÖí', 'Ë•øÁè≠ÁâôÂÜ∑ÊπØ', 'ÁÇ∏ÂèØÊ®ÇÈ§Ö'],
        defaultSchedule: []
    },
    'üá©üá™ ÊÖïÂ∞ºÈªë': {
        country: 'Âæ∑Âúã', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'Áë™Âà©‰∫ûÂª£Â†¥', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: 'ÂÖ®Â§©' },
            { name: 'Êñ∞Â∏ÇÊîøÂª≥', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: '10:00-17:00' },
            { name: 'ÂØßËä¨Â†°ÂÆÆ', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: '09:00-18:00' },
            { name: 'Ëã±ÂúãËä±Âúí', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: 'ÂÖ®Â§©' },
            { name: 'ÁöáÂÆ∂Âï§ÈÖíÂ±ã', type: 'ÁæéÈ£ü', location: 'ÊÖïÂ∞ºÈªë', time: '09:00-23:30' },
            { name: 'ÂØ∂È¶¨ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: '10:00-18:00' },
            { name: 'ËÄÅÂΩºÂæóÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: '09:00-19:00' },
            { name: 'Âæ∑ÊÑèÂøóÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: '09:00-17:00' },
            { name: 'Á∂≠ÂÖãÂúñÈòøÈÄ£Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'ÊÖïÂ∞ºÈªë', time: '08:00-20:00' },
            { name: 'Â•ßÊûóÂåπÂÖãÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÊÖïÂ∞ºÈªë', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Âæ∑ÂúãÈ¶ôËÖ∏', 'ÁÉ§Ë±¨ËÖ≥', 'Âæ∑ÂúãÂï§ÈÖí', 'Ê§íÈπΩËÑÜÈ§Ö', 'ÈÖ∏Ëèú', 'Âæ∑ÂºèÂúüË±ÜÊ≤ôÊãâ', 'ÁôΩÈ¶ôËÖ∏', 'ËòãÊûúÊç≤', 'Ë±¨Êéí', 'È¶¨Èà¥ËñØÈ§ÉÂ≠ê'],
        defaultSchedule: []
    },
    'üá≥üá± ÈòøÂßÜÊñØÁâπ‰∏π': {
        country: 'Ëç∑Ëò≠', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ÂÆâÂ¶Æ‰πãÂÆ∂', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '09:00-22:00' },
            { name: 'Ê¢µË∞∑ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '09:00-18:00' },
            { name: 'ÂúãÂÆ∂ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '09:00-17:00' },
            { name: 'Ê∞¥Â£©Âª£Â†¥', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: 'ÂÖ®Â§©' },
            { name: 'ÈÅãÊ≤≥ÈÅäËàπ', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '09:00-22:00' },
            { name: 'Á¥ÖÁáàÂçÄ', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: 'Êôö‰∏ä' },
            { name: 'Ëä±ÂçâÂ∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '09:00-17:30' },
            { name: 'Â∫´ËÇØÈúçÂ§´Ëä±Âúí', type: 'ÊôØÈªû', location: 'Âà©Áëü', time: '08:00-19:30' },
            { name: 'Êµ∑Â∞ºÊ†πÈ´îÈ©óÈ§®', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: '10:30-19:30' },
            { name: 'Á¥ÑÊó¶ÂçÄ', type: 'ÊôØÈªû', location: 'ÈòøÂßÜÊñØÁâπ‰∏π', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Ëç∑Ëò≠È¨ÜÈ§Ö', 'Ëç∑Ëò≠Ëµ∑Âè∏', 'ËñØÊ¢ù', 'ÁîüÈØ°È≠ö', 'ËòãÊûúÊ¥æ', 'ÁÇ∏ËÇâ‰∏∏', 'Ë±åË±ÜÊπØ', 'Ëç∑Ëò≠ÁÖéÈ§Ö', 'ÁÑ¶Á≥ñÈ§Ö‰πæ', 'ÂèØÊ®ÇÈ§Ö'],
        defaultSchedule: []
    },
    'üá®üá≠ ËòáÈªé‰∏ñ': {
        country: 'ÁëûÂ£´', continent: 'Ê≠êÊ¥≤', currency: 'CHF',
        spots: [
            { name: 'Áè≠ÈúçÂ§´Â§ßË°ó', type: 'Ë≥ºÁâ©', location: 'ËòáÈªé‰∏ñ', time: '09:00-20:00' },
            { name: 'ËòáÈªé‰∏ñÊπñ', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: 'ÂÖ®Â§©' },
            { name: 'ËÄÅÂüéÂçÄ', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: 'ÂÖ®Â§©' },
            { name: 'ËòáÈªé‰∏ñÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: '10:00-18:00' },
            { name: 'ËÅñÊØçÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: '10:00-18:00' },
            { name: 'ÊûóÁôªÈúçÂ§´', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: 'ÂÖ®Â§©' },
            { name: 'ÁëûÂ£´ÂúãÂÆ∂ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: '10:00-17:00' },
            { name: 'ÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: '09:00-18:00' },
            { name: 'ËêäËåµÁÄëÂ∏É', type: 'ÊôØÈªû', location: 'Ê≤ôÂ§´Ë±™Ê£Æ', time: '09:00-19:00' },
            { name: 'ÁéâÁâπÂà©Â±±', type: 'ÊôØÈªû', location: 'ËòáÈªé‰∏ñ', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Ëµ∑Âè∏ÁÅ´Èçã', 'Â∑ßÂÖãÂäõ', 'ÁëûÂ£´‰π≥ÈÖ™', 'ÊãâÂÖãÈõ∑ÁâπËµ∑Âè∏', 'ÁëûÂ£´Âæ∑ÂúãÈ¶ôËÖ∏', 'È¶¨Èà¥ËñØÈ§Ö', 'Ê¥ãËî•Â°î', 'ËòáÈªé‰∏ñÂ∞èÁâõËÇâ', 'ËæÆÂ≠êÈ∫µÂåÖ', 'ÁëûÂ£´Â∑ßÂÖãÂäõÈ£≤ÂìÅ'],
        defaultSchedule: []
    },
    'üá¶üáπ Á∂≠‰πüÁ¥ç': {
        country: 'Â•ßÂú∞Âà©', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'ÁæéÊ≥âÂÆÆ', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '08:00-17:30' },
            { name: 'ËÅñÂè≤ËíÇËä¨Â§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '06:00-22:00' },
            { name: 'ÈúçÂ§´Â†°ÁöáÂÆÆ', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '09:00-17:30' },
            { name: 'ÊôÆÊãâÁâπÈÅäÊ®ÇÂ†¥', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '10:00-00:00' },
            { name: 'Á∂≠‰πüÁ¥çÂúãÂÆ∂Ê≠åÂäáÈô¢', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: 'Â∞éË¶ΩÊôÇÈñì' },
            { name: 'Ë≤ùÁàæÁ∂≠Á¨¨ÂÆÆ', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '09:00-18:00' },
            { name: 'Á¥çË®±Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Á∂≠‰πüÁ¥ç', time: '06:00-21:00' },
            { name: 'ËóùË°ìÂè≤ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: '10:00-18:00' },
            { name: 'ÁôæÊ∞¥ÂÖ¨ÂØì', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: 'ÂÖ®Â§©' },
            { name: 'Áí∞ÂüéÂ§ßÈÅì', type: 'ÊôØÈªû', location: 'Á∂≠‰πüÁ¥ç', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Á∂≠‰πüÁ¥çÁÇ∏ÁâõÊéí', 'ËòãÊûúÊç≤', 'Ëñ©Ëµ´ËõãÁ≥ï', 'Á∂≠‰πüÁ¥çÈ¶ôËÖ∏', 'Â°îË≤ªÁàæÊñØÁöÆËå®', 'ÁâõËÇâÊπØ', 'Â∏ùÁéãÁÖéÈ§Ö', 'ÊùèÊ°ÉÈ§ÉÂ≠ê', 'Á∂≠‰πüÁ¥çÂíñÂï°', 'Â•ßÂú∞Âà©ÁáâÁâõËÇâ'],
        defaultSchedule: []
    },
    'üá®üáø Â∏ÉÊãâÊ†º': {
        country: 'Êç∑ÂÖã', continent: 'Ê≠êÊ¥≤', currency: 'CZK',
        spots: [
            { name: 'Êü•ÁêÜÂ§ßÊ©ã', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' },
            { name: 'Â∏ÉÊãâÊ†ºÂüéÂ†°', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: '09:00-17:00' },
            { name: 'ËÄÅÂüéÂª£Â†¥', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' },
            { name: 'Â§©ÊñáÈêò', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: '09:00-21:00' },
            { name: 'ËÅñÁ∂≠ÁâπÂ§ßÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: '09:00-17:00' },
            { name: 'Áå∂Â§™ÂçÄ', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: '09:00-18:00' },
            { name: '‰Ω©Áâπ‰ªªÂ±±', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' },
            { name: 'Áì¶Ëå®ÊãâÂ§´Âª£Â†¥', type: 'Ë≥ºÁâ©', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' },
            { name: 'Ë∑≥ËàûÁöÑÊàøÂ≠ê', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' },
            { name: 'Â∞èÂüéÂçÄ', type: 'ÊôØÈªû', location: 'Â∏ÉÊãâÊ†º', time: 'ÂÖ®Â§©' }
        ],
        foods: ['ÁÉ§Ë±¨ËÜù', 'Êç∑ÂÖãÈ§ÉÂ≠ê', 'Êç∑ÂÖãÂï§ÈÖí', 'ÁáâÁâõËÇâ', 'ÁÇ∏Ëµ∑Âè∏', 'Êç∑ÂÖãÈ¶ôËÖ∏', 'ËòãÊûúÊç≤', 'ÁÖôÂõ™ËõãÁ≥ï', 'ÁîúËèúÊπØ', 'Ë±¨ËÇâÊéí'],
        defaultSchedule: []
    },
    'üá¨üá∑ ÈõÖÂÖ∏': {
        country: 'Â∏åËáò', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'Ë°õÂüé', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'Â∏ïÂæ∑Â´©Á•ûÊÆø', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'ÊôÆÊãâÂç°ÂçÄ', type: 'Ë≥ºÁâ©', location: 'ÈõÖÂÖ∏', time: 'ÂÖ®Â§©' },
            { name: 'ÊÜ≤Ê≥ïÂª£Â†¥', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: 'ÂÖ®Â§©' },
            { name: 'Ë°õÂüéÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'ÂÆôÊñØÁ•ûÊÆø', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'Âà©Âç°Á∂≠Â§öÊñØÂ±±', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: 'ÂÖ®Â§©' },
            { name: 'Âè§Â∏ÇÈõÜÈÅ∫ÂùÄ', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'ÂúãÂÆ∂ËÄÉÂè§ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÈõÖÂÖ∏', time: '08:00-20:00' },
            { name: 'ËíôÁ¥çÊñØÊèêÊãâÂ•áÂª£Â†¥', type: 'Ë≥ºÁâ©', location: 'ÈõÖÂÖ∏', time: 'ÂÖ®Â§©' }
        ],
        foods: ['ÁÉ§ËÇâ‰∏≤', 'Á©ÜËñ©Âç°', 'Â∏åËáòÊ≤ôÊãâ', 'ÁöÆÂ°îÈ§Ö', 'ËåÑÂ≠êÈÜ¨', 'ÁÇ∏‰π≥ÈÖ™', 'Â∏åËáòÂÑ™Ê†º', 'Ëë°ËêÑËëâÈ£ØÊç≤', 'Êµ∑ÈÆÆ', 'Êûú‰ªÅËúúÈ§Ö'],
        defaultSchedule: []
    },
    'üá¨üá∑ ËÅñÊâòÈáåÂ∞º': {
        country: 'Â∏åËáò', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: '‰ºä‰∫ûÊó•ËêΩ', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '17:00-20:00' },
            { name: 'Ë≤ªÊãâÈéÆ', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: 'ÂÖ®Â§©' },
            { name: 'ËóçÈ†ÇÊïôÂ†Ç', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: 'ÂÖ®Â§©' },
            { name: 'Á¥ÖÊ≤ôÁÅò', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '09:00-18:00' },
            { name: 'ÈªëÊ≤ôÁÅò', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '09:00-18:00' },
            { name: 'ÈòøÂÖãÁæÖËíÇÈáåÈÅ∫ÂùÄ', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '08:00-20:00' },
            { name: 'ÁÅ´Â±±Â≥∂', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '09:00-17:00' },
            { name: 'ÁöÆÁàæÊààÊñØÊùë', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: 'ÂÖ®Â§©' },
            { name: 'ÈÖíËéä‰πãÊóÖ', type: 'ÁæéÈ£ü', location: 'ËÅñÊâòÈáåÂ∞º', time: '10:00-19:00' },
            { name: 'Âç°È¶¨Âà©Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ËÅñÊâòÈáåÂ∞º', time: '09:00-18:00' }
        ],
        foods: ['ÁÉ§Á´†È≠ö', 'Áï™ËåÑÁêÉ', 'ËåÑÂ≠êÊ≤ôÊãâ', 'Â∏åËáòÁôΩÈÖí', 'Êµ∑ÈÆÆÁæ©Â§ßÂà©È∫µ', 'ÁÉ§ÁæäËÇâ', 'Ëè≤ÈÅî‰π≥ÈÖ™', 'ËúÇËúúÁîúÈªû', 'Ê©ÑÊ¨ñÊ≤πÈ∫µÂåÖ', 'Â∏åËáòÂíñÂï°'],
        defaultSchedule: []
    },
    'üáµüáπ ÈáåÊñØÊú¨': {
        country: 'Ëë°ËêÑÁâô', continent: 'Ê≠êÊ¥≤', currency: 'EUR',
        spots: [
            { name: 'Ë≤ùÂÄ´Â°î', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: '10:00-17:30' },
            { name: 'ÁÜ±ÁæÖÂ∞ºËé´ÊñØ‰øÆÈÅìÈô¢', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: '10:00-17:30' },
            { name: 'ÈòøÊ≥ïÁë™ÂçÄ', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'ËÅñÂñ¨Ê≤ªÂüéÂ†°', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: '09:00-21:00' },
            { name: '28ËôüÈõªËªä', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'ÁæÖË•øÊ≠êÂª£Â†¥', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'Â•ßÂè§ÊñØÂ°îË°óÂá±ÊóãÈñÄ', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: '09:00-20:00' },
            { name: 'ËæõÁâπÊãâÂÆÆ', type: 'ÊôØÈªû', location: 'ËæõÁâπÊãâ', time: '09:30-18:30' },
            { name: 'LXÂ∑•Âª†', type: 'Ë≥ºÁâ©', location: 'ÈáåÊñØÊú¨', time: '10:00-00:00' },
            { name: 'Ê≥ïÊúµË°®Êºî', type: 'ÊôØÈªû', location: 'ÈáåÊñØÊú¨', time: '20:00-23:00' }
        ],
        foods: ['Ëë°ÂºèËõãÊíª', 'ÁÉ§Ê≤ô‰∏ÅÈ≠ö', 'Ëë°ÂºèÁáâÈõúÁ¢é', 'Â∑¥Âç°ÂãûÈ±àÈ≠ö', 'Ë±¨ÊâíÂåÖ', 'Êµ∑ÈÆÆÈ£Ø', 'Ëë°ÂºèÁÉ§Èõû', 'Ê≥¢ÁâπÈÖí', 'Ëµ∑Âè∏ËõãÁ≥ï', 'Á∂†ÊπØ'],
        defaultSchedule: []
    },

    // ============ ÂåóÁæéÊ¥≤ (North America) ============
    'üá∫üá∏ Á¥êÁ¥Ñ': {
        country: 'ÁæéÂúã', continent: 'ÂåóÁæéÊ¥≤', currency: 'USD',
        spots: [
            { name: 'Ëá™Áî±Â•≥Á•ûÂÉè', type: 'ÊôØÈªû', location: 'Ëá™Áî±Â≥∂', time: '08:30-16:00' },
            { name: 'ÊôÇ‰ª£Âª£Â†¥', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: 'ÂÖ®Â§©' },
            { name: '‰∏≠Â§ÆÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: '06:00-01:00' },
            { name: 'Â∏ùÂúãÂ§ßÂªà', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: '10:00-00:00' },
            { name: 'Â§ßÈÉΩÊúÉËóùË°ìÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: '10:00-17:00' },
            { name: 'Â∏ÉÈ≠ØÂÖãÊûóÂ§ßÊ©ã', type: 'ÊôØÈªû', location: 'Â∏ÉÈ≠ØÂÖãÊûó', time: 'ÂÖ®Â§©' },
            { name: 'Á¨¨‰∫îÂ§ßÈÅì', type: 'Ë≥ºÁâ©', location: 'ÊõºÂìàÈ†ì', time: '10:00-20:00' },
            { name: 'ÁôæËÄÅÂåØ', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: 'Êôö‰∏ä' },
            { name: 'Ê¥õÂÖãÊñêÂãí‰∏≠ÂøÉ', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: '08:00-00:00' },
            { name: 'ËèØÁàæË°ó', type: 'ÊôØÈªû', location: 'ÊõºÂìàÈ†ì', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Á¥êÁ¥ÑÊä´Ëñ©', 'Á¥êÁ¥ÑË≤ùÊûú', 'ÁÜ±Áãó', 'Ëµ∑Âè∏ËõãÁ≥ï', 'ÈæçËù¶', 'ÁâõÊéí', 'Êº¢Â†°', 'ÈªëÁôΩÈ§Ö‰πæ', 'Â∏ïÊñØÁâπÊãâÁ±≥‰∏âÊòéÊ≤ª', 'ËòãÊûúÊ¥æ'],
        defaultSchedule: []
    },
    'üá∫üá∏ Ê¥õÊùâÁ£Ø': {
        country: 'ÁæéÂúã', continent: 'ÂåóÁæéÊ¥≤', currency: 'USD',
        spots: [
            { name: 'Â•ΩËêäÂ°¢Ê®ôË™å', type: 'ÊôØÈªû', location: 'Â•ΩËêäÂ°¢', time: 'ÂÖ®Â§©' },
            { name: 'Áí∞ÁêÉÂΩ±Âüé', type: 'ÊôØÈªû', location: 'Â•ΩËêäÂ°¢', time: '09:00-22:00' },
            { name: 'Ëø™Â£´Â∞ºÊ®ÇÂúí', type: 'ÊôØÈªû', location: 'ÈòøÁ¥çÊµ∑ÂßÜ', time: '08:00-00:00' },
            { name: 'ËÅñÂ°îËé´Â∞ºÂç°Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ËÅñÂ°îËé´Â∞ºÂç°', time: 'ÂÖ®Â§©' },
            { name: 'ÊØî‰ΩõÂà©Â±±Ëéä', type: 'Ë≥ºÁâ©', location: 'ÊØî‰ΩõÂà©Â±±', time: '10:00-18:00' },
            { name: 'Ê†ºÈáåËè≤ÊñØÂ§©ÊñáÂè∞', type: 'ÊôØÈªû', location: 'Ê¥õÊùâÁ£Ø', time: '12:00-22:00' },
            { name: 'Â®ÅÂ∞ºÊñØÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Â®ÅÂ∞ºÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'Â•ΩËêäÂ°¢ÊòüÂÖâÂ§ßÈÅì', type: 'ÊôØÈªû', location: 'Â•ΩËêäÂ°¢', time: 'ÂÖ®Â§©' },
            { name: 'ËìãËíÇ‰∏≠ÂøÉ', type: 'ÊôØÈªû', location: 'Ê¥õÊùâÁ£Ø', time: '10:00-17:30' },
            { name: 'Ëæ≤Â§´Â∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Ê¥õÊùâÁ£Ø', time: '09:00-21:00' }
        ],
        foods: ['Â¢®Ë•øÂì•Êç≤È§Ö', 'Êº¢Â†°', 'Â£ΩÂè∏', 'ÈüìÂºèÁÉ§ËÇâ', 'Ë∂äÂçóÊ≤≥Á≤â', 'In-N-OutÊº¢Â†°', 'Ê≥ïÂºèÊ≤æÈÜ¨‰∏âÊòéÊ≤ª', 'ÁÇ∏È≠öÂ°îÂèØ', 'Âä†Â∑ûÂç∑', 'ÊûúÊòîÁ¢ó'],
        defaultSchedule: []
    },
    'üá∫üá∏ ËàäÈáëÂ±±': {
        country: 'ÁæéÂúã', continent: 'ÂåóÁæéÊ¥≤', currency: 'USD',
        spots: [
            { name: 'ÈáëÈñÄÂ§ßÊ©ã', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'ÊºÅ‰∫∫Á¢ºÈ†≠', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: '10:00-22:00' },
            { name: 'ÊÉ°È≠îÂ≥∂', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±ÁÅ£', time: '09:00-18:30' },
            { name: '‰πùÊõ≤Ëä±Ë°ó', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'ËÅØÂêàÂª£Â†¥', type: 'Ë≥ºÁâ©', location: 'ËàäÈáëÂ±±', time: '10:00-20:00' },
            { name: 'Âîê‰∫∫Ë°ó', type: 'ÁæéÈ£ü', location: 'ËàäÈáëÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'Á∫úËªä', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: '06:00-00:30' },
            { name: 'ÈáëÈñÄÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'ËóùË°ìÂÆÆ', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: 'ÂÖ®Â§©' },
            { name: '39ËôüÁ¢ºÈ†≠', type: 'ÊôØÈªû', location: 'ËàäÈáëÂ±±', time: '10:00-21:00' }
        ],
        foods: ['ÈÖ∏È∫µÂåÖ', 'Ëõ§ËúäÂ∑ßÈÅîÊπØ', 'ËûÉËüπ', 'Êµ∑ÈÆÆ', 'ÊÑõÁàæËò≠ÂíñÂï°', 'Â¢®Ë•øÂì•Êç≤È§Ö', 'ÈªûÂøÉ', 'Êä´Ëñ©', 'ÊúâÊ©üÊ≤ôÊãâ', 'Á≤æÂìÅÂíñÂï°'],
        defaultSchedule: []
    },
    'üá∫üá∏ ÊãâÊñØÁ∂≠Âä†ÊñØ': {
        country: 'ÁæéÂúã', continent: 'ÂåóÁæéÊ¥≤', currency: 'USD',
        spots: [
            { name: 'ÊãâÊñØÁ∂≠Âä†ÊñØÂ§ßÈÅì', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'ÁôæÊ®ÇÂÆÆÂô¥Ê≥â', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: '15:00-00:00' },
            { name: 'Â®ÅÂ∞ºÊñØ‰∫∫ÈÖíÂ∫ó', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'ÂºóÂà©ËíôË°ó', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: '18:00-02:00' },
            { name: 'Â§ßÂ≥ΩË∞∑', type: 'ÊôØÈªû', location: '‰∫ûÂà©Ê°ëÈÇ£Â∑û', time: 'ÂÖ®Â§©' },
            { name: 'ËÉ°‰ΩõÊ∞¥Â£©', type: 'ÊôØÈªû', location: 'ÂÖßËèØÈÅîÂ∑û', time: '09:00-17:00' },
            { name: 'Â§™ÈôΩÂäáÂúò', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: 'Êôö‰∏ä' },
            { name: 'È´òÂ°îËßÄÊôØÂè∞', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: '10:00-01:00' },
            { name: 'Caesars Palace', type: 'Ë≥ºÁâ©', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: 'ÂÖ®Â§©' },
            { name: 'Á¥ÖÂ≤©Â≥ΩË∞∑', type: 'ÊôØÈªû', location: 'ÊãâÊñØÁ∂≠Âä†ÊñØ', time: '06:00-19:00' }
        ],
        foods: ['Ëá™Âä©È§ê', 'ÁâõÊéí', 'ÈæçËù¶', 'Â£ΩÂè∏', 'Êº¢Â†°', 'ÁÇ∏Èõû', '‰∏≠ÂºèÊñôÁêÜ', 'Áæ©Â§ßÂà©È§ê', 'Ê≥ïÂºèÊñôÁêÜ', 'ÁîúÈªûËá™Âä©'],
        defaultSchedule: []
    },
    'üá∫üá∏ Â§èÂ®ÅÂ§∑': {
        country: 'ÁæéÂúã', continent: 'ÂåóÁæéÊ¥≤', currency: 'USD',
        spots: [
            { name: 'Â®ÅÂü∫Âü∫Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Ê™ÄÈ¶ôÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'ÁèçÁè†Ê∏Ø', type: 'ÊôØÈªû', location: 'Ê™ÄÈ¶ôÂ±±', time: '07:00-17:00' },
            { name: 'ÈëΩÁü≥È†≠Â±±', type: 'ÊôØÈªû', location: 'Ê™ÄÈ¶ôÂ±±', time: '06:00-18:00' },
            { name: 'ÊÅêÈæçÁÅ£', type: 'ÊôØÈªû', location: 'Ê≠êËÉ°Â≥∂', time: '06:00-16:00' },
            { name: 'ÂåóÂ≤∏', type: 'ÊôØÈªû', location: 'Ê≠êËÉ°Â≥∂', time: 'ÂÖ®Â§©' },
            { name: 'ÁéªÈáåÂ∞ºË•ø‰∫ûÊñáÂåñ‰∏≠ÂøÉ', type: 'ÊôØÈªû', location: 'Ê≠êËÉ°Â≥∂', time: '12:00-21:00' },
            { name: '‰ºäÂ•ßÊãâÂ∞ºÂÆÆ', type: 'ÊôØÈªû', location: 'Ê™ÄÈ¶ôÂ±±', time: '09:00-16:00' },
            { name: 'ÈòøÊãâËé´ÈòøÈÇ£‰∏≠ÂøÉ', type: 'Ë≥ºÁâ©', location: 'Ê™ÄÈ¶ôÂ±±', time: '09:30-21:00' },
            { name: 'ÁßëÁ¥çÂíñÂï°Âúí', type: 'ÊôØÈªû', location: 'Â§ßÂ≥∂', time: '09:00-16:00' },
            { name: 'ÁÅ´Â±±ÂúãÂÆ∂ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Â§ßÂ≥∂', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Â§èÂ®ÅÂ§∑ÁîüÈ≠öÈ£Ø', 'ÁÉ§Ë±¨ËÇâ', 'Â§èÂ®ÅÂ§∑È£ØÁ≥∞', 'Âà®ÂÜ∞', 'È≥≥Ê¢®', 'Ê§∞Â≠ê', 'ËíúËù¶È£Ø', 'Â§èÂ®ÅÂ§∑Êº¢Â†°Êéí', 'ËäãÈ†≠', 'Â§èÂ®ÅÂ§∑Êûú‰ªÅ'],
        defaultSchedule: []
    },
    'üá®üá¶ Ê∫´Âì•ËèØ': {
        country: 'Âä†ÊãøÂ§ß', continent: 'ÂåóÁæéÊ¥≤', currency: 'CAD',
        spots: [
            { name: 'Âè≤‰∏πÂà©ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Ê∫´Âì•ËèØ', time: 'ÂÖ®Â§©' },
            { name: 'Âç°ÁöÆÊãâË´æÂêäÊ©ã', type: 'ÊôØÈªû', location: 'ÂåóÊ∫´Âì•ËèØ', time: '09:00-18:00' },
            { name: 'Ê†ºËò≠Á∂≠ÁàæÂ≥∂', type: 'Ë≥ºÁâ©', location: 'Ê∫´Âì•ËèØ', time: '09:00-19:00' },
            { name: 'ËìãÊñØÈéÆ', type: 'ÊôØÈªû', location: 'Ê∫´Âì•ËèØ', time: 'ÂÖ®Â§©' },
            { name: 'Ëã±ÂêâÂà©ÁÅ£', type: 'ÊôØÈªû', location: 'Ê∫´Âì•ËèØ', time: 'ÂÖ®Â§©' },
            { name: 'Âîê‰∫∫Ë°ó', type: 'ÁæéÈ£ü', location: 'Ê∫´Âì•ËèØ', time: 'ÂÖ®Â§©' },
            { name: 'Ê∫´Âì•ËèØÊ∞¥ÊóèÈ§®', type: 'ÊôØÈªû', location: 'Ê∫´Âì•ËèØ', time: '10:00-17:00' },
            { name: 'ÁæÖÂ∏ÉÊ£ÆË°ó', type: 'Ë≥ºÁâ©', location: 'Ê∫´Âì•ËèØ', time: '10:00-21:00' },
            { name: 'Â•≥ÁéãÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Ê∫´Âì•ËèØ', time: 'ÂÖ®Â§©' },
            { name: 'Ê†ºÂãûÊñØÂ±±', type: 'ÊôØÈªû', location: 'ÂåóÊ∫´Âì•ËèØ', time: '09:00-22:00' }
        ],
        foods: ['‰∏âÊñáÈ≠ö', 'Â£ΩÂè∏', 'Êó•ÂºèÊãâÈ∫µ', 'ÁÇ∏È≠öËñØÊ¢ù', 'ÈæçËù¶', 'Ê•ìÁ≥ñÊºø', 'ËÇâÊ±ÅËñØÊ¢ù', 'Â∏åËáòÊñôÁêÜ', 'Á≤æÈáÄÂï§ÈÖí', 'ÁîüË†î'],
        defaultSchedule: []
    },
    'üá®üá¶ Â§öÂÄ´Â§ö': {
        country: 'Âä†ÊãøÂ§ß', continent: 'ÂåóÁæéÊ¥≤', currency: 'CAD',
        spots: [
            { name: 'CNÂ°î', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: '09:00-22:30' },
            { name: 'Â∞ºÂä†ÊãâÁÄëÂ∏É', type: 'ÊôØÈªû', location: 'Â∞ºÂä†Êãâ', time: 'ÂÖ®Â§©' },
            { name: 'ÁöáÂÆ∂ÂÆâÂ§ßÁï•ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: '10:00-17:30' },
            { name: 'ËÅñÁæÖÂÄ´ÊñØÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Â§öÂÄ´Â§ö', time: '08:00-18:00' },
            { name: 'Â§ÆË°ó', type: 'Ë≥ºÁâ©', location: 'Â§öÂÄ´Â§ö', time: '10:00-21:00' },
            { name: 'Â§öÂÄ´Â§öÁæ§Â≥∂', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: 'ÂÖ®Â§©' },
            { name: 'ËÇØËæõÈ†ìÂ∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'Â§öÂÄ´Â§ö', time: '09:00-19:00' },
            { name: 'Âç°Ëñ©ÁæÖÈ¶¨ÂüéÂ†°', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: '09:30-17:00' },
            { name: 'Â§öÂÄ´Â§öÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: '09:00-16:30' },
            { name: 'ÂÆâÂ§ßÁï•ÁæéË°ìÈ§®', type: 'ÊôØÈªû', location: 'Â§öÂÄ´Â§ö', time: '10:30-17:00' }
        ],
        foods: ['ËÇâÊ±ÅËñØÊ¢ù', 'ËíôÁâπÂ©ÅÁáªËÇâ‰∏âÊòéÊ≤ª', 'Ê•ìÁ≥ñ', 'Êä´Ëñ©', 'Â∏åËáòÊñôÁêÜ', 'Âä†ÊãøÂ§ßÂüπÊ†π', 'Â•∂Ê≤πÂ°î', 'ÈÆÆË†î', 'ÁâõÊéí', 'Á≤æÈáÄÂï§ÈÖí'],
        defaultSchedule: []
    },
    'üá≤üáΩ ÂùéÊòÜ': {
        country: 'Â¢®Ë•øÂì•', continent: 'ÂåóÁæéÊ¥≤', currency: 'MXN',
        spots: [
            { name: 'ÂùéÊòÜÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÂùéÊòÜ', time: 'ÂÖ®Â§©' },
            { name: 'Â•áÁê¥‰ºäÂØü', type: 'ÊôØÈªû', location: 'Â∞§Âç°Âù¶', time: '08:00-17:00' },
            { name: 'Â•≥‰∫∫Â≥∂', type: 'ÊôØÈªû', location: 'ÂùéÊòÜ', time: 'ÂÖ®Â§©' },
            { name: 'ÂúñÁõßÂßÜÈÅ∫ÂùÄ', type: 'ÊôØÈªû', location: 'ÂúñÁõßÂßÜ', time: '08:00-17:00' },
            { name: 'Ë•øÂç°ËêäÁâπÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÈáåÁ∂≠ÂüÉÊãâÁë™ÈõÖ', time: '08:30-22:00' },
            { name: 'La IslaË≥ºÁâ©Êùë', type: 'Ë≥ºÁâ©', location: 'ÂùéÊòÜ', time: '10:00-22:00' },
            { name: 'Ê∞¥‰∏ãÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÂùéÊòÜ', time: '09:00-14:00' },
            { name: 'Â§©ÁÑ∂‰∫ï', type: 'ÊôØÈªû', location: 'Â∞§Âç°Âù¶', time: '09:00-17:00' },
            { name: 'Coco BongoÂ§úÂ∫ó', type: 'ÊôØÈªû', location: 'ÂùéÊòÜ', time: '22:00-04:00' },
            { name: 'ÂèØÂèØÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'ÂùéÊòÜ', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Â°îÂèØ', 'Â¢®Ë•øÂì•Êç≤È§Ö', 'ÈÖ™Ê¢®ÈÜ¨', 'Â¢®Ë•øÂì•Ëæ£Ê§í', 'Ëé´Èõ∑ÈÜ¨', 'ÁÇ∏ÁéâÁ±≥È§Ö', 'ÁéâÁ±≥Á≤•', 'ÈæçËàåËò≠ÈÖí', 'Êµ∑ÈÆÆÊπØ', 'Â¢®Ë•øÂì•‰∏âÊòéÊ≤ª'],
        defaultSchedule: []
    },

    // ============ Â§ßÊ¥ãÊ¥≤ (Oceania) ============
    'üá¶üá∫ Èõ™Ê¢®': {
        country: 'Êæ≥Ê¥≤', continent: 'Â§ßÊ¥ãÊ¥≤', currency: 'AUD',
        spots: [
            { name: 'Èõ™Ê¢®Ê≠åÂäáÈô¢', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: '09:00-17:00' },
            { name: 'Èõ™Ê¢®Êµ∑Ê∏ØÂ§ßÊ©ã', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: 'ÂÖ®Â§©' },
            { name: 'ÈÇ¶Ëø™Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: 'ÂÖ®Â§©' },
            { name: 'ÈÅî‰ª§Ê∏Ø', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: 'ÂÖ®Â§©' },
            { name: 'Â°îÈöÜÂä†ÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: '09:30-17:00' },
            { name: 'Â≤©Áü≥ÂçÄ', type: 'Ë≥ºÁâ©', location: 'Èõ™Ê¢®', time: '10:00-18:00' },
            { name: 'ÁöáÂÆ∂Ê§çÁâ©Âúí', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: '07:00-18:00' },
            { name: 'ÊõºÂà©Êµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: 'ÂÖ®Â§©' },
            { name: 'ËóçÂ±±', type: 'ÊôØÈªû', location: 'ËóçÂ±±', time: 'ÂÖ®Â§©' },
            { name: 'Èõ™Ê¢®Â°î', type: 'ÊôØÈªû', location: 'Èõ™Ê¢®', time: '09:00-22:00' }
        ],
        foods: ['Êæ≥Ê¥≤ÁâõÊéí', 'ËÇâÊ¥æ', 'ÁÇ∏È≠öËñØÊ¢ù', 'Ë¢ãÈº†ËÇâ', 'ÊèêÂßÜÂ°îÂßÜÈ§Ö‰πæ', 'Á∂≠ÂêâÈ∫•', 'È±∑È≠öËÇâ', 'ÊãâÊòéÈ†ìËõãÁ≥ï', 'Êæ≥Ê¥≤ÂíñÂï°', 'ËÇâÂç∑'],
        defaultSchedule: []
    },
    'üá¶üá∫ Â¢®ÁàæÊú¨': {
        country: 'Êæ≥Ê¥≤', continent: 'Â§ßÊ¥ãÊ¥≤', currency: 'AUD',
        spots: [
            { name: 'ËÅØÈÇ¶Âª£Â†¥', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'ÁöáÂÆ∂Êã±Âªä', type: 'Ë≥ºÁâ©', location: 'Â¢®ÁàæÊú¨', time: '09:00-18:00' },
            { name: 'Â∞§ÈáåÂç°88ËßÄÊôØÂè∞', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: '10:00-22:00' },
            { name: 'Â§ßÊ¥ãË∑Ø', type: 'ÊôØÈªû', location: 'Á∂≠Â§öÂà©‰∫ûÂ∑û', time: 'ÂÖ®Â§©' },
            { name: 'Â¢®ÁàæÊú¨ÂãïÁâ©Âúí', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: '09:00-17:00' },
            { name: 'ÂºóÊûóÂæ∑ÊñØË°óËªäÁ´ô', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'ÁöáÂÜ†Ë≥≠Â†¥', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'Â°óÈ¥âÂ∑∑', type: 'ÊôØÈªû', location: 'Â¢®ÁàæÊú¨', time: 'ÂÖ®Â§©' },
            { name: 'Á∂≠Â§öÂà©‰∫ûÂ•≥ÁéãÂ∏ÇÂ†¥', type: 'ÁæéÈ£ü', location: 'Â¢®ÁàæÊú¨', time: '06:00-14:00' },
            { name: 'Ëè≤Âà©ÊôÆÂ≥∂‰ºÅÈµù', type: 'ÊôØÈªû', location: 'Ëè≤Âà©ÊôÆÂ≥∂', time: '17:00-20:00' }
        ],
        foods: ['ÂíñÂï°', 'ËÇâÊ¥æ', 'ËòáÂ§´ËïæÁÖéÈ§Ö', 'ÁâõÊéí', '‰∫ûÊ¥≤ËûçÂêàÊñôÁêÜ', 'Â∏åËáòËèú', 'Áæ©Â§ßÂà©È§ê', 'Á≤æÈáÄÂï§ÈÖí', 'Êµ∑ÈÆÆ', 'ÊãâÊòéÈ†ìËõãÁ≥ï'],
        defaultSchedule: []
    },
    'üá≥üáø Â•ßÂÖãËò≠': {
        country: 'Á¥êË•øËò≠', continent: 'Â§ßÊ¥ãÊ¥≤', currency: 'NZD',
        spots: [
            { name: 'Â§©Á©∫Â°î', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: '08:30-22:30' },
            { name: 'Â•ßÂÖãËò≠Ê∏Ø', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: 'ÂÖ®Â§©' },
            { name: '‰ºäÁî∏Â±±', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: '07:00-20:30' },
            { name: 'ÁöáÂêéË°ó', type: 'Ë≥ºÁâ©', location: 'Â•ßÂÖãËò≠', time: '09:00-18:00' },
            { name: '‰ΩøÂëΩÁÅ£', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: 'ÂÖ®Â§©' },
            { name: 'Â•ßÂÖãËò≠ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: '10:00-17:00' },
            { name: 'Êá∑Â∏åÂü∫Â≥∂', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: 'ÂÖ®Â§©' },
            { name: 'Âá±Âà©Â°îÈ†ìÊ∞¥ÊóèÈ§®', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: '09:30-17:00' },
            { name: 'ÂåóÂ≤¨', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: 'ÂÖ®Â§©' },
            { name: 'Êúó‰ºäÊâòÊâòÂ≥∂', type: 'ÊôØÈªû', location: 'Â•ßÂÖãËò≠', time: 'ÂÖ®Â§©' }
        ],
        foods: ['ÁæäËÇâ', 'Á∂†ÂîáË≤ΩË≤ù', 'ËÇâÊ¥æ', 'Â•áÁï∞Êûú', 'ÁôΩÈõ≤Áü≥Â•∂Ê≤π', 'Â∏ïÁì¶Ê¥õÁì¶ËõãÁ≥ï', 'ÁáâÁæäËÇâ', 'Êµ∑ÈÆÆ', 'Á¥êË•øËò≠Ëë°ËêÑÈÖí', 'Êº¢ÂêâÊñôÁêÜ'],
        defaultSchedule: []
    },
    'üá≥üáø ÁöáÂêéÈéÆ': {
        country: 'Á¥êË•øËò≠', continent: 'Â§ßÊ¥ãÊ¥≤', currency: 'NZD',
        spots: [
            { name: 'Á±≥ÁàæÁ¶èÂæ∑Â≥ΩÁÅ£', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: 'ÂÖ®Â§©' },
            { name: 'Â§©Á©∫Á∫úËªä', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: '09:00-21:00' },
            { name: 'Áì¶Âç°ËíÇÊôÆÊπñ', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: 'ÂÖ®Â§©' },
            { name: 'Ê†ºÊûóË´æÂ•á', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: 'ÂÖ®Â§©' },
            { name: 'ÁÆ≠ÈéÆ', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: 'ÂÖ®Â§©' },
            { name: 'Â≥ΩÁÅ£Âô¥Â∞ÑÂø´Ëâá', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: '09:00-17:00' },
            { name: 'È´òÁ©∫ÂΩàË∑≥', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: '09:00-17:00' },
            { name: 'ÊªëÁøîÂÇò', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: '09:00-17:00' },
            { name: 'ÂºóÊ†ºÊº¢Â†°', type: 'ÁæéÈ£ü', location: 'ÁöáÂêéÈéÆ', time: '08:00-21:00' },
            { name: 'Ëí∏Ê±ΩËàπÈÅäÊπñ', type: 'ÊôØÈªû', location: 'ÁöáÂêéÈéÆ', time: '10:00-16:00' }
        ],
        foods: ['ÂºóÊ†ºÊº¢Â†°', 'ÁæäËÇâ', 'ÈπøËÇâ', 'È±íÈ≠ö', 'ËÇâÊ¥æ', 'Á¥êË•øËò≠Ëë°ËêÑÈÖí', 'ÁôΩÈõ≤Áü≥ÂÜ∞Ê∑áÊ∑ã', 'Êµ∑ÈÆÆÊãºÁõ§', 'ÁáíÁÉ§', 'Â∏ïÁì¶Ê¥õÁì¶'],
        defaultSchedule: []
    },

    // ============ ÈùûÊ¥≤ (Africa) ============
    'üáøüá¶ ÈñãÊôÆÊï¶': {
        country: 'ÂçóÈùû', continent: 'ÈùûÊ¥≤', currency: 'ZAR',
        spots: [
            { name: 'Ê°åÂ±±', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: '08:00-18:00' },
            { name: 'Â•ΩÊúõËßí', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: '06:00-18:00' },
            { name: 'V&AÁ¢ºÈ†≠', type: 'Ë≥ºÁâ©', location: 'ÈñãÊôÆÊï¶', time: '09:00-21:00' },
            { name: '‰ºÅÈµùÊµ∑ÁÅò', type: 'ÊôØÈªû', location: 'Ë•øËíôÈéÆ', time: '08:00-17:00' },
            { name: '‰ø°ËôüÂ±±', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: 'ÂÖ®Â§©' },
            { name: 'ÁæÖÊú¨Â≥∂', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: '09:00-15:00' },
            { name: 'ÂÖãÊñØÂù¶ÂçöÊ§çÁâ©Âúí', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: '08:00-18:00' },
            { name: 'Ê≥¢Âç°ÊôÆÂçÄ', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: 'ÂÖ®Â§©' },
            { name: 'ÊñØÊ≥∞ÂÄ´ÂçöÊñØÈÖíËéä', type: 'ÁæéÈ£ü', location: 'ÊñØÊ≥∞ÂÄ´ÂçöÊñØ', time: '09:00-17:00' },
            { name: 'Êü•ÊôÆÊõºÂ≥∞', type: 'ÊôØÈªû', location: 'ÈñãÊôÆÊï¶', time: '06:00-19:00' }
        ],
        foods: ['Ê≥¢Ê≥¢Êèê', 'ÁÉ§ËÇâ', 'ÈñãÊôÆÈ¶¨‰æÜÂíñÂì©', 'ÁâõÂ∞æ', 'ÂçóÈùû‰πæËÇâ', 'È¶¨‰æÜÂíñÂì©Ëßí', 'ÂçóÈùûÁáâËÇâ', 'È¥ïÈ≥•ËÇâ', 'Ëë°ËêÑÈÖí', 'Â•∂Â°î'],
        defaultSchedule: []
    },
    'üá™üá¨ ÈñãÁæÖ': {
        country: 'ÂüÉÂèä', continent: 'ÈùûÊ¥≤', currency: 'EGP',
        spots: [
            { name: 'ÂêâËñ©ÈáëÂ≠óÂ°î', type: 'ÊôØÈªû', location: 'ÂêâËñ©', time: '08:00-17:00' },
            { name: '‰∫∫Èù¢ÁçÖË∫´ÂÉè', type: 'ÊôØÈªû', location: 'ÂêâËñ©', time: '08:00-17:00' },
            { name: 'ÂüÉÂèäÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: '09:00-17:00' },
            { name: 'ÂìàÂà©Âà©Â∏ÇÈõÜ', type: 'Ë≥ºÁâ©', location: 'ÈñãÁæÖ', time: '10:00-23:00' },
            { name: 'Á©ÜÁΩïÈªòÂæ∑ÈòøÈáåÊ∏ÖÁúüÂØ∫', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: '08:00-17:00' },
            { name: 'ÈñãÁæÖÂ°î', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: '08:00-00:00' },
            { name: 'Ëñ©Âç°Êãâ', type: 'ÊôØÈªû', location: 'Ëñ©Âç°Êãâ', time: '08:00-17:00' },
            { name: 'Â∞ºÁæÖÊ≤≥ÈÅäËº™', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: '19:00-23:00' },
            { name: 'ËÄÅÈñãÁæÖ', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: 'ÂÖ®Â§©' },
            { name: 'ÈòøËå≤ÂìàÁàæÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÈñãÁæÖ', time: '09:00-22:00' }
        ],
        foods: ['ÁÉ§ËÇâ‰∏≤', 'È∑πÂò¥Ë±ÜÊ≥•', 'ÁÇ∏Ë±ÜÈ§Ö', 'ÂüÉÂèäÁáâËèú', 'ÁÉ§È¥ø', 'ÂüÉÂèäÈ∫µÂåÖ', 'Ê≤ôÂ®ÅÁë™', 'ÁîúÈªû', 'ÂüÉÂèäËå∂', 'ÁîòËîóÊ±Å'],
        defaultSchedule: []
    },
    'üá≤üá¶ È¶¨ÊãâÂñÄ‰ªÄ': {
        country: 'Êë©Ê¥õÂì•', continent: 'ÈùûÊ¥≤', currency: 'MAD',
        spots: [
            { name: 'ÂÇëÈ¶¨Â§´Á¥çÂª£Â†¥', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: 'ÂÖ®Â§©' },
            { name: 'Â∫´ÂúñÊØî‰∫ûÊ∏ÖÁúüÂØ∫', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: 'Â§ñËßÄÂèÉËßÄ' },
            { name: 'Â∑¥‰ºä‰∫ûÂÆÆÊÆø', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: '09:00-17:00' },
            { name: 'È¶¨Ëã•Èõ∑ÂãíËä±Âúí', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: '08:00-18:00' },
            { name: 'ËÄÅÂüéÂçÄ', type: 'Ë≥ºÁâ©', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: 'ÂÖ®Â§©' },
            { name: 'Ëñ©Ëø™ÊÅ©ÈôµÂ¢ì', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: '09:00-17:00' },
            { name: 'ÁöÆÈù©ÊüìÂùä', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: '09:00-18:00' },
            { name: 'Êú¨ÂÑ™Á¥†Â§´Á•ûÂ≠∏Èô¢', type: 'ÊôØÈªû', location: 'È¶¨ÊãâÂñÄ‰ªÄ', time: '09:00-18:00' },
            { name: 'ÊííÂìàÊãâÊ≤ôÊº†', type: 'ÊôØÈªû', location: 'ÊííÂìàÊãâ', time: 'ÂÖ®Â§©' },
            { name: 'ÈòøÁâπÊãâÊñØÂ±±ËÑà', type: 'ÊôØÈªû', location: 'ÈòøÁâπÊãâÊñØ', time: 'ÂÖ®Â§©' }
        ],
        foods: ['Â°îÂêâÈçã', 'Â∫´ÊñØÂ∫´ÊñØ', 'Êë©Ê¥õÂì•ËñÑËç∑Ëå∂', 'Ê≤ôÂ®ÅÁë™', 'Êë©Ê¥õÂì•È§Ö', 'ÂìàÈáåÊãâÊπØ', 'ÁÉ§ÁæäËÇâ', 'Ëù∏ÁâõÊπØ', 'Êùè‰ªÅÁ≥ïÈªû', 'Ê©ôÂ≠êÊ≤ôÊãâ'],
        defaultSchedule: []
    },
    'üá∞üá™ Â•àÊ¥õÊØî': {
        country: 'ËÇØ‰∫û', continent: 'ÈùûÊ¥≤', currency: 'KES',
        spots: [
            { name: 'È¶¨Ë≥ΩÈ¶¨ÊãâÂúãÂÆ∂‰øùË≠∑ÂçÄ', type: 'ÊôØÈªû', location: 'È¶¨Ë≥ΩÈ¶¨Êãâ', time: '06:00-18:00' },
            { name: 'Â§ßË±°Â≠§ÂÖíÈô¢', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '11:00-12:00' },
            { name: 'Èï∑È†∏Èπø‰∏≠ÂøÉ', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '09:00-17:00' },
            { name: 'Â•àÊ¥õÊØîÂúãÂÆ∂ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '06:00-18:00' },
            { name: 'ËÇØ‰∫ûÂúãÂÆ∂ÂçöÁâ©È§®', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '08:30-17:30' },
            { name: 'Âç°ÂÄ´ÊïÖÂ±Ö', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '09:00-18:00' },
            { name: 'Á¥çÂ∫´È≠ØÊπñ', type: 'ÊôØÈªû', location: 'Á¥çÂ∫´È≠Ø', time: '06:00-18:00' },
            { name: 'ÂÆâÂçöÂ°ûÂà©ÂúãÂÆ∂ÂÖ¨Âúí', type: 'ÊôØÈªû', location: 'ÂÆâÂçöÂ°ûÂà©', time: '06:00-18:00' },
            { name: 'Â∏ÇÂ†¥', type: 'Ë≥ºÁâ©', location: 'Â•àÊ¥õÊØî', time: '08:00-18:00' },
            { name: 'ËÇØ‰∫ûÂ°îÂúãÈöõÊúÉË≠∞‰∏≠ÂøÉ', type: 'ÊôØÈªû', location: 'Â•àÊ¥õÊØî', time: '08:00-17:00' }
        ],
        foods: ['ÁÉè‰ºΩÈªé', 'Â∞º‰∫ûÈ¶¨Âñ¨Áë™', 'Á©ÜÂùéËé´', 'Ëñ©Êë©Ëñ©', 'ÊõºÈÅîËå≤', 'ÁöÆÊãâÁÉè', 'ÁÉ§ËÇâ', 'ÈÖ™Ê¢®Ê≤ôÊãâ', 'ËÇØ‰∫ûËå∂', 'ÁîòËîóÊ±Å'],
        defaultSchedule: []
    }
};
        // ============================================
        // Â∏∏Êï∏ËàáËÆäÊï∏
        // ============================================
        const STORAGE_KEY = 'travel_planner_v4';
        const TOKEN_KEY = 'travel_google_token';
        const TOKEN_SOFT_EXPIRE = 24 * 60 * 60;
        const DISCOVERY_DOCS = [
            'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest',
            'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'
        ];
        const SCOPES = 'https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/documents https://www.googleapis.com/auth/photoslibrary.appendonly';
        
        // Ë≤®Âπ£ÂåØÁéáÔºàÂèÉËÄÉÂè∞ÁÅ£ÈäÄË°å 2024/2025 Á¥ÑÁï•ÂåØÁéáÔºâ- ÂÖ®ÁêÉ‰∏ªË¶ÅË≤®Âπ£
        const EXCHANGE_RATES = {
            // ‰∫ûÊ¥≤
            TWD: { symbol: 'NT$', name: 'Âè∞Âπ£', rate: 1, flag: 'üáπüáº' },
            JPY: { symbol: '¬•', name: 'Êó•Âπ£', rate: 0.21, flag: 'üáØüáµ' },
            KRW: { symbol: '‚Ç©', name: 'ÈüìÂÖÉ', rate: 0.024, flag: 'üá∞üá∑' },
            CNY: { symbol: '¬•', name: '‰∫∫Ê∞ëÂπ£', rate: 4.4, flag: 'üá®üá≥' },
            HKD: { symbol: 'HK$', name: 'Ê∏ØÂπ£', rate: 4.1, flag: 'üá≠üá∞' },
            MOP: { symbol: 'MOP$', name: 'Êæ≥ÈñÄÂπ£', rate: 4, flag: 'üá≤üá¥' },
            SGD: { symbol: 'S$', name: 'Êñ∞Âπ£', rate: 24, flag: 'üá∏üá¨' },
            THB: { symbol: '‡∏ø', name: 'Ê≥∞Èäñ', rate: 0.94, flag: 'üáπüá≠' },
            MYR: { symbol: 'RM', name: 'È¶¨Âπ£', rate: 7.2, flag: 'üá≤üáæ' },
            VND: { symbol: '‚Ç´', name: 'Ë∂äÁõæ', rate: 0.0013, flag: 'üáªüá≥' },
            PHP: { symbol: '‚Ç±', name: 'Ëè≤ÂæãË≥ìÊä´Á¥¢', rate: 0.57, flag: 'üáµüá≠' },
            IDR: { symbol: 'Rp', name: 'Âç∞Â∞ºÁõæ', rate: 0.002, flag: 'üáÆüá©' },
            INR: { symbol: '‚Çπ', name: 'Âç∞Â∫¶ÁõßÊØî', rate: 0.38, flag: 'üáÆüá≥' },
            PKR: { symbol: 'Rs', name: 'Â∑¥Âü∫ÊñØÂù¶ÁõßÊØî', rate: 0.11, flag: 'üáµüá∞' },
            BDT: { symbol: '‡ß≥', name: 'Â≠üÂä†ÊãâÂ°îÂç°', rate: 0.27, flag: 'üáßüá©' },
            LKR: { symbol: 'Rs', name: 'ÊñØÈáåËò≠Âç°ÁõßÊØî', rate: 0.1, flag: 'üá±üá∞' },
            NPR: { symbol: 'Rs', name: 'Â∞ºÊ≥äÁàæÁõßÊØî', rate: 0.24, flag: 'üá≥üáµ' },
            MMK: { symbol: 'K', name: 'Á∑¨Áî∏ÂÖÉ', rate: 0.015, flag: 'üá≤üá≤' },
            KHR: { symbol: '·üõ', name: 'Êü¨ÂüîÂØ®ÁëûÁàæ', rate: 0.0078, flag: 'üá∞üá≠' },
            LAK: { symbol: '‚Ç≠', name: 'ÂØÆÂúãÂü∫ÊôÆ', rate: 0.0015, flag: 'üá±üá¶' },
            // ÂåóÁæéÊ¥≤
            USD: { symbol: '$', name: 'ÁæéÈáë', rate: 32, flag: 'üá∫üá∏' },
            CAD: { symbol: 'C$', name: 'Âä†Âπ£', rate: 23, flag: 'üá®üá¶' },
            MXN: { symbol: 'MX$', name: 'Â¢®Ë•øÂì•Êä´Á¥¢', rate: 1.9, flag: 'üá≤üáΩ' },
            // Ê≠êÊ¥≤
            EUR: { symbol: '‚Ç¨', name: 'Ê≠êÂÖÉ', rate: 34, flag: 'üá™üá∫' },
            GBP: { symbol: '¬£', name: 'Ëã±Èéä', rate: 40, flag: 'üá¨üáß' },
            CHF: { symbol: 'CHF', name: 'ÁëûÂ£´Ê≥ïÈÉé', rate: 36, flag: 'üá®üá≠' },
            SEK: { symbol: 'kr', name: 'ÁëûÂÖ∏ÂÖãÊúó', rate: 3, flag: 'üá∏üá™' },
            NOK: { symbol: 'kr', name: 'Êå™Â®ÅÂÖãÊúó', rate: 2.9, flag: 'üá≥üá¥' },
            DKK: { symbol: 'kr', name: '‰∏πÈ∫•ÂÖãÊúó', rate: 4.6, flag: 'üá©üá∞' },
            PLN: { symbol: 'z≈Ç', name: 'Ê≥¢Ëò≠Ëå≤ÁæÖÊèê', rate: 8, flag: 'üáµüá±' },
            CZK: { symbol: 'Kƒç', name: 'Êç∑ÂÖãÂÖãÊúó', rate: 1.4, flag: 'üá®üáø' },
            HUF: { symbol: 'Ft', name: 'ÂåàÁâôÂà©Á¶èÊûó', rate: 0.088, flag: 'üá≠üá∫' },
            RON: { symbol: 'lei', name: 'ÁæÖÈ¶¨Â∞º‰∫ûÂàó‰ºä', rate: 6.8, flag: 'üá∑üá¥' },
            BGN: { symbol: '–ª–≤', name: '‰øùÂä†Âà©‰∫ûÂàóÂºó', rate: 17.4, flag: 'üáßüá¨' },
            HRK: { symbol: 'kn', name: 'ÂÖãÁæÖÂüÉË•ø‰∫ûÂ∫´Á¥ç', rate: 4.5, flag: 'üá≠üá∑' },
            RUB: { symbol: '‚ÇΩ', name: '‰øÑÁæÖÊñØÁõßÂ∏É', rate: 0.35, flag: 'üá∑üá∫' },
            UAH: { symbol: '‚Ç¥', name: 'ÁÉèÂÖãËò≠Ê†ºÈáåÂ§´Á¥ç', rate: 0.78, flag: 'üá∫üá¶' },
            TRY: { symbol: '‚Ç∫', name: 'ÂúüËÄ≥ÂÖ∂ÈáåÊãâ', rate: 0.93, flag: 'üáπüá∑' },
            ISK: { symbol: 'kr', name: 'ÂÜ∞Â≥∂ÂÖãÊúó', rate: 0.23, flag: 'üáÆüá∏' },
            // Â§ßÊ¥ãÊ¥≤
            AUD: { symbol: 'A$', name: 'Êæ≥Âπ£', rate: 21, flag: 'üá¶üá∫' },
            NZD: { symbol: 'NZ$', name: 'Á¥êÂπ£', rate: 19, flag: 'üá≥üáø' },
            FJD: { symbol: 'FJ$', name: 'ÊñêÊøüÂÖÉ', rate: 14, flag: 'üá´üáØ' },
            // ‰∏≠Êù±
            AED: { symbol: 'ÿØ.ÿ•', name: 'ÈòøËÅØÈÖãËø™ÊãâÂßÜ', rate: 8.7, flag: 'üá¶üá™' },
            SAR: { symbol: 'Ô∑º', name: 'Ê≤ôÁÉèÂú∞Èáå‰∫ûÁàæ', rate: 8.5, flag: 'üá∏üá¶' },
            QAR: { symbol: 'ÿ±.ŸÇ', name: 'Âç°ÈÅîÈáå‰∫ûÁàæ', rate: 8.8, flag: 'üá∂üá¶' },
            KWD: { symbol: 'ÿØ.ŸÉ', name: 'ÁßëÂ®ÅÁâπÁ¨¨Á¥çÁàæ', rate: 104, flag: 'üá∞üáº' },
            BHD: { symbol: '.ÿØ.ÿ®', name: 'Â∑¥ÊûóÁ¨¨Á¥çÁàæ', rate: 85, flag: 'üáßüá≠' },
            OMR: { symbol: 'ÿ±.ÿπ.', name: 'ÈòøÊõºÈáå‰∫ûÁàæ', rate: 83, flag: 'üá¥üá≤' },
            JOD: { symbol: 'ÿØ.ÿß', name: 'Á¥ÑÊó¶Á¨¨Á¥çÁàæ', rate: 45, flag: 'üáØüá¥' },
            ILS: { symbol: '‚Ç™', name: '‰ª•Ëâ≤ÂàóË¨ùÂÖãÁàæ', rate: 8.6, flag: 'üáÆüá±' },
            // ÈùûÊ¥≤
            ZAR: { symbol: 'R', name: 'ÂçóÈùûËò≠Áâπ', rate: 1.8, flag: 'üáøüá¶' },
            EGP: { symbol: 'E¬£', name: 'ÂüÉÂèäÈéä', rate: 0.65, flag: 'üá™üá¨' },
            MAD: { symbol: 'MAD', name: 'Êë©Ê¥õÂì•Ëø™ÊãâÂßÜ', rate: 3.2, flag: 'üá≤üá¶' },
            KES: { symbol: 'KSh', name: 'ËÇØ‰∫ûÂÖà‰ª§', rate: 0.25, flag: 'üá∞üá™' },
            NGN: { symbol: '‚Ç¶', name: 'Â•àÂèäÂà©‰∫ûÂ•àÊãâ', rate: 0.02, flag: 'üá≥üá¨' },
            TZS: { symbol: 'TSh', name: 'Âù¶Â∞öÂ∞º‰∫ûÂÖà‰ª§', rate: 0.012, flag: 'üáπüáø' },
            // ÂçóÁæéÊ¥≤
            BRL: { symbol: 'R$', name: 'Â∑¥Ë•øÈõ∑‰∫ûÁàæ', rate: 5.6, flag: 'üáßüá∑' },
            ARS: { symbol: '$', name: 'ÈòøÊ†πÂª∑Êä´Á¥¢', rate: 0.032, flag: 'üá¶üá∑' },
            CLP: { symbol: '$', name: 'Êô∫Âà©Êä´Á¥¢', rate: 0.034, flag: 'üá®üá±' },
            COP: { symbol: '$', name: 'Âì•ÂÄ´ÊØî‰∫ûÊä´Á¥¢', rate: 0.0076, flag: 'üá®üá¥' },
            PEN: { symbol: 'S/', name: 'ÁßòÈ≠ØÁ¥¢Áàæ', rate: 8.5, flag: 'üáµüá™' }
        };
        
        // ÊîØ‰ªòÊñπÂºè
        const PAYMENT_METHODS = {
            cash: { name: 'ÁèæÈáë', icon: 'üíµ', color: 'emerald' },
            credit: { name: '‰ø°Áî®Âç°', icon: 'üí≥', color: 'purple' },
            debit: { name: 'Á∞ΩÂ∏≥ÈáëËûçÂç°', icon: 'üí≥', color: 'cyan' },
            epay: { name: 'ÈõªÂ≠êÊîØ‰ªò', icon: 'üì±', color: 'orange' },
            iccard: { name: '‰∫§ÈÄöÂç°', icon: 'üöÉ', color: 'pink' }
        };
        
        let tokenClient, gapiInited = false, gisInited = false;
        
        let appData = {
            trip: { name: '', destination: '', customDestination: '', startDate: '', endDate: '', mainCurrency: 'JPY' },
            days: [],
            expenses: [],
            shopping: [],
            budget: 0, // üí∞ Á∏ΩÈ†êÁÆóÔºàÂè∞Âπ£Ôºâ
            dayCovers: {}, // üì∏ ÊØèÊó•Â∞ÅÈù¢ÁÖßÁâá { 'YYYY-MM-DD': 'base64...' }
            dailyNotes: {}, // ‚úçÔ∏è ÊØèÊó•ÊóÖÈÅäÈªûÊª¥ { 'YYYY-MM-DD': [{id, time, content, mood}] }
            members: ['Êàë'], // üë• ÊóÖ‰º¥ÂêçÂñÆ
            spots: [], // üìç ÊôØÈªûÊ∏ÖÂñÆ [{id, name, type, note, checked, checkedAt}]
            checkins: [], // üì∏ ÊâìÂç°Ë®òÈåÑ [{id, photo, spotId, spotName, date, note}]
            badges: {}, // üèÜ Â∑≤Ëß£ÈéñÊàêÂ∞± { badgeId: unlockedAt }
            settings: { googleClientId: '', lineToken: '', lineUserId: '', gasUrl: '', gasSecret: '', storageEnabled: true },
            // üéÆ Ë∂£Âë≥Â∑•ÂÖ∑Ë≥áÊñô
            funTools: {
                roulette: { options: ['ÂêÉÊãâÈ∫µ', 'ÈÄõÁ•ûÁ§æ', 'Ë≤∑Ëó•Â¶ù', 'ÂñùÂíñÂï°', 'ÊãçÁÖßÊâìÂç°', 'Èö®‰æøËµ∞Ëµ∞'] },
                chemistry: { 
                    questions: ['‰ªäÂ§©ÊúÄÊÉ≥ÂéªÂì™Ë£°Ôºü', 'ÂçàÈ§êÊÉ≥ÂêÉ‰ªÄÈ∫ºÔºü', 'ÊúÄÊÉ≥Ë≤∑‰ªÄÈ∫ºÁ¥ÄÂøµÂìÅÔºü', 'Êôö‰∏äÊÉ≥ÂÅö‰ªÄÈ∫ºÊ¥ªÂãïÔºü'],
                    answers: [[], []]
                },
                price: { currency: 'JPY' },
                bingo: { items: [], grid: [], checked: [] },
                mood: { records: [] }
            }
        };
        
        // Âè∞ÁÅ£Áâ©ÂÉπÂèÉËÄÉÔºàË∂£Âë≥Â∑•ÂÖ∑Áî®Ôºâ
        const TW_PRICES = [
            { name: '‰∏ÄÊùØÁèçÂ•∂', price: 55 },
            { name: '‰∏ÄÂÄã‰æøÁï∂', price: 100 },
            { name: '‰∏ÄÊùØË∂ÖÂïÜÂíñÂï°', price: 45 },
            { name: '‰∏Ä‰ªΩÊó©È§ê', price: 60 },
            { name: 'Êç∑ÈÅãÂñÆÁ®ãÁ•®', price: 25 },
            { name: '‰∏ÄÁ¢óÁâõËÇâÈ∫µ', price: 150 },
            { name: '‰∏Ä‰ªΩÈõûÊéí', price: 70 },
            { name: 'ÈõªÂΩ±Á•®', price: 300 },
            { name: '‰∏Ä‰ª∂TÊÅ§', price: 500 },
            { name: '‰∏ÄÈõôÁêÉÈûã', price: 2500 }
        ];
        
        // Bingo È†êË®≠È†ÖÁõÆ
        const DEFAULT_BINGO = [
            'ÁúãÂà∞Á•ûÁ§æ', 'ÂêÉÂà∞ÊãâÈ∫µ', 'Êê≠Âú∞Èêµ', 'ÁúãÂà∞Á©øÂíåÊúçÁöÑ‰∫∫', 'Ë≤∑Âà∞Ëó•Â¶ù',
            'ÂñùÂà∞ÊäπËå∂', 'ÁúãÂà∞ÂØåÂ£´Â±±', 'ÂêÉÂà∞Â£ΩÂè∏', 'ÈÄõ‰æøÂà©ÂïÜÂ∫ó', 'ÁúãÂà∞È≥•Â±Ö',
            'ÂêÉÂà∞Á´†È≠öÁáí', 'Êê≠Êñ∞ÂππÁ∑ö', 'ÁúãÂà∞Ê´ªËä±/Ê•ìËëâ', 'Ë≤∑Âà∞Êâ≠Ëõã', 'ÂêÉÂà∞ÁÉèÈæçÈ∫µ',
            'ÁúãÂà∞Ë≤ì', 'ÂñùÂà∞Ê∏ÖÈÖí', 'ÂêÉÂà∞ÂíåÁâõ', 'ÈÄõÁôæË≤®ÂÖ¨Âè∏', 'ÁúãÂà∞Ê∫´Ê≥â',
            'ÂêÉÂà∞ÂèØÈ∫óÈ§Ö', 'ÁúãÂà∞Êù±‰∫¨ÈêµÂ°î', 'Ë≤∑Âà∞Âæ°ÂÆà', 'ÂêÉÂà∞Â§ßÈò™Ááí'
        ];
        
        // üèÜ ÊàêÂ∞±ÂÆöÁæ©
        const CHECKIN_BADGES = [
            { id: 'first_spot', name: 'ÂàùÊ¨°ÊâìÂç°', desc: 'ÊâìÂç°Á¨¨‰∏ÄÂÄãÊôØÈªû', icon: 'üéØ', condition: d => d.spots.filter(s => s.checked).length >= 1 },
            { id: 'explorer_5', name: 'Â∞èÂ∞èÊé¢Èö™ÂÆ∂', desc: 'ÊâìÂç° 5 ÂÄãÊôØÈªû', icon: 'üß≠', total: 5, getValue: d => d.spots.filter(s => s.checked).length, condition: d => d.spots.filter(s => s.checked).length >= 5 },
            { id: 'explorer_10', name: 'Ë≥áÊ∑±Êé¢Èö™ÂÆ∂', desc: 'ÊâìÂç° 10 ÂÄãÊôØÈªû', icon: 'üó∫Ô∏è', total: 10, getValue: d => d.spots.filter(s => s.checked).length, condition: d => d.spots.filter(s => s.checked).length >= 10 },
            { id: 'first_photo', name: 'ÊîùÂΩ±Êñ∞Êâã', desc: '‰∏äÂÇ≥Á¨¨‰∏ÄÂºµÁÖßÁâá', icon: 'üì∑', condition: d => d.checkins.length >= 1 },
            { id: 'photographer_10', name: 'ÊîùÂΩ±ÈÅî‰∫∫', desc: '‰∏äÂÇ≥ 10 ÂºµÁÖßÁâá', icon: 'üéûÔ∏è', total: 10, getValue: d => d.checkins.length, condition: d => d.checkins.length >= 10 },
            { id: 'foodie', name: 'ÁæéÈ£üÁçµ‰∫∫', desc: 'ÊâìÂç° 3 ÂÄãÁæéÈ£üÊôØÈªû', icon: 'üçú', total: 3, getValue: d => d.spots.filter(s => s.checked && s.type === 'ÁæéÈ£ü').length, condition: d => d.spots.filter(s => s.checked && s.type === 'ÁæéÈ£ü').length >= 3 },
            { id: 'shopper', name: 'Ë≥ºÁâ©ÁãÇ', desc: 'ÊâìÂç° 3 ÂÄãË≥ºÁâ©ÊôØÈªû', icon: 'üõçÔ∏è', total: 3, getValue: d => d.spots.filter(s => s.checked && s.type === 'Ë≥ºÁâ©').length, condition: d => d.spots.filter(s => s.checked && s.type === 'Ë≥ºÁâ©').length >= 3 },
            { id: 'complete', name: 'ÂÆåÁæéÊóÖÁ®ã', desc: 'ÊâìÂç°ÊâÄÊúâÊôØÈªû', icon: 'üèÜ', condition: d => d.spots.length > 0 && d.spots.every(s => s.checked) }
        ];
        
        // ============================================
        // ÂàùÂßãÂåñ
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderAll();
            initGoogleAPI();
            
            // üé¨ ÂïüÂãïÁï´Èù¢Ê∑°Âá∫
            setTimeout(() => {
                const splash = document.getElementById('splashScreen');
                if (splash) {
                    splash.classList.add('hide');
                    setTimeout(() => splash.remove(), 500);
                }
            }, 1800); // 1.8 ÁßíÂæåÊ∑°Âá∫
            
            // Á∂ÅÂÆö Google Doc ÂåØÂá∫ÊåâÈàïÔºàËß£Ê±∫ iPhone Ëß∏ÊéßÂïèÈ°åÔºâ
            const btnExportDoc = document.getElementById('btnExportGoogleDoc');
            if (btnExportDoc) {
                btnExportDoc.addEventListener('click', function(e) {
                    e.preventDefault();
                    exportToGoogleDoc();
                });
                btnExportDoc.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    exportToGoogleDoc();
                });
            }
        });
        
        // ============================================
        // Ëá™ÂãïÁî¢ÁîüÂª∫Ë≠∞Ë°åÁ®ã
        // ============================================
        function showAutoGenerateModal() {
            const dest = appData.trip.destination;
            const content = document.getElementById('autoGenerateContent');
            
            if (!dest || !appData.trip.startDate || !appData.trip.endDate) {
                content.innerHTML = `
                    <div style="text-align:center;padding:20px;color:var(--text-dim);">
                        <div style="font-size:2em;margin-bottom:10px;">‚ö†Ô∏è</div>
                        <p>Ë´ãÂÖàÂú®È¶ñÈ†ÅË®≠ÂÆö<strong>ÁõÆÁöÑÂú∞</strong>Âíå<strong>Êó•Êúü</strong></p>
                    </div>
                `;
                showModal('autoGenerateModal');
                return;
            }
            
            const dbData = ATTRACTIONS_DB[dest];
            if (!dbData) {
                content.innerHTML = `
                    <div style="text-align:center;padding:20px;color:var(--text-dim);">
                        <div style="font-size:2em;margin-bottom:10px;">üìç</div>
                        <p>ÁõÆÂâç„Äå${dest}„ÄçÂ∞öÁÑ°Âª∫Ë≠∞ÊôØÈªûË≥áÊñôÂ∫´</p>
                        <p style="margin-top:10px;font-size:0.9em;">ÊÇ®ÂèØ‰ª•ÊâãÂãïÊñ∞Â¢ûË°åÁ®ã</p>
                    </div>
                `;
                showModal('autoGenerateModal');
                return;
            }
            
            const dayCount = appData.days.length || calculateDays();
            
            content.innerHTML = `
                <div style="text-align:center;margin-bottom:20px;">
                    <div style="font-size:2em;margin-bottom:10px;">‚ú®</div>
                    <p style="color:var(--cyan);font-weight:600;">${dest}</p>
                    <p style="color:var(--text-dim);">${dayCount} Â§©Ë°åÁ®ãÂª∫Ë≠∞</p>
                </div>
                
                <div class="suggest-section">
                    <div class="suggest-title">üèõÔ∏è ÂèØÈÅ∏ÊôØÈªûÔºà${dbData.spots.length}ÂÄãÔºâ</div>
                    <div class="suggest-chips" id="spotsChipsContainer">
                        ${dbData.spots.map((s, i) => `<span class="suggest-chip selected" data-index="${i}">${s.name}</span>`).join('')}
                    </div>
                </div>
                
                <div class="suggest-section">
                    <div class="suggest-title">üçú Êé®Ëñ¶ÁæéÈ£ü</div>
                    <div class="suggest-chips">
                        ${dbData.foods.map(f => `<span class="suggest-chip">${f}</span>`).join('')}
                    </div>
                </div>
                
                <div class="suggest-section" style="margin-top:15px;">
                    <div class="suggest-title">üîî ÊâπÊ¨°Ë®≠ÂÆöÊèêÈÜíÔºàÊâÄÊúâË°åÁ®ãÔºâ</div>
                    <div class="reminder-grid" id="batchReminderGrid">
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â§©</span>
                            <input type="checkbox" value="1440" checked>
                        </label>
                        <label class="reminder-option checked" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">‚úì</div><span>Ââç 2 Â∞èÊôÇ</span>
                            <input type="checkbox" value="120">
                        </label>
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">‚úì</div><span>Ââç 1 Â∞èÊôÇ</span>
                            <input type="checkbox" value="60">
                        </label>
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">‚úì</div><span>Ââç 30 ÂàÜÈêò</span>
                            <input type="checkbox" value="30">
                        </label>
                    </div>
                </div>
                
                <div class="suggest-section" style="margin-top:10px;">
                    <label class="reminder-option" onclick="toggleReminder(this)" style="width:100%;">
                        <div class="reminder-checkbox">‚úì</div>
                        <span>üìÜ ÂêåÊ≠•Âà∞ Google Êó•ÊõÜ</span>
                        <input type="checkbox" id="batchSyncGoogle" value="google">
                    </label>
                </div>
                
                <p style="font-size:0.85em;color:var(--text-muted);text-align:center;margin-top:10px;">
                    ÈªûÊìäÊôØÈªûÂèØÂèñÊ∂àÈÅ∏ÊìáÔºåÁ≥ªÁµ±ÊúÉËá™ÂãïÂàÜÈÖçÂà∞ÂêÑÂ§©
                </p>
            `;
            
            // Á∂ÅÂÆöÈªûÊìä‰∫ã‰ª∂
            content.querySelectorAll('.suggest-chip').forEach(chip => {
                chip.addEventListener('click', () => chip.classList.toggle('selected'));
            });
            
            showModal('autoGenerateModal');
        }
        
        function calculateDays() {
            if (!appData.trip.startDate || !appData.trip.endDate) return 0;
            const start = new Date(appData.trip.startDate);
            const end = new Date(appData.trip.endDate);
            return Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
        }
        
        async function confirmAutoGenerate() {
            const dest = appData.trip.destination;
            const dbData = ATTRACTIONS_DB[dest];
            
            if (!dbData) {
                closeModal('autoGenerateModal');
                return;
            }
            
            // ÂèñÂæóÈÅ∏‰∏≠ÁöÑÊôØÈªûÔºàÂæûÊôØÈªûÂçÄÂ°äÈÅ∏ÂèñÔºâ
            const spotsContainer = document.getElementById('spotsChipsContainer');
            const selectedChips = spotsContainer ? spotsContainer.querySelectorAll('.suggest-chip.selected') : [];
            const selectedSpots = [];
            selectedChips.forEach(chip => {
                const idx = parseInt(chip.dataset.index);
                if (!isNaN(idx) && dbData.spots[idx]) {
                    selectedSpots.push(dbData.spots[idx]);
                }
            });
            
            if (selectedSpots.length === 0) {
                showToast('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏ÄÂÄãÊôØÈªû', 'error');
                return;
            }
            
            // ÂèñÂæóÊâπÊ¨°ÊèêÈÜíË®≠ÂÆö
            const batchReminders = [];
            document.querySelectorAll('#batchReminderGrid .reminder-option.checked input').forEach(input => {
                batchReminders.push(parseInt(input.value));
            });
            const batchSyncGoogle = document.getElementById('batchSyncGoogle')?.checked || false;
            
            // Á¢∫‰øùÂ∑≤Áî¢ÁîüÂ§©Êï∏
            if (appData.days.length === 0) {
                const start = new Date(appData.trip.startDate);
                const end = new Date(appData.trip.endDate);
                generateDays(start, end);
            }
            
            // ÂàÜÈÖçÊôØÈªûÂà∞ÂêÑÂ§©
            const spotsPerDay = Math.ceil(selectedSpots.length / appData.days.length);
            let spotIndex = 0;
            let totalSchedules = 0;
            
            showToast('üîÑ Áî¢ÁîüË°åÁ®ã‰∏≠...', 'info');
            
            for (let dayIdx = 0; dayIdx < appData.days.length; dayIdx++) {
                const day = appData.days[dayIdx];
                
                // Á¨¨‰∏ÄÂ§©Âä†ÂÖ•ÊäµÈÅîË°åÁ®ã
                if (dayIdx === 0 && dbData.defaultSchedule.length > 0) {
                    dbData.defaultSchedule.forEach(ds => {
                        const times = ds.time.split('-');
                        const schedule = {
                            id: Date.now() + Math.random(),
                            startTime: times[0],
                            endTime: times[1],
                            title: ds.title,
                            type: ds.type,
                            location: '',
                            note: '',
                            reminders: [...batchReminders],
                            synced: false
                        };
                        day.schedules.push(schedule);
                        
                        // Âª∫Á´ã LINE ÊèêÈÜí
                        if (batchReminders.length > 0) {
                            createLineReminders(day, schedule);
                        }
                        totalSchedules++;
                    });
                }
                
                // ÂàÜÈÖçÊôØÈªû
                for (let i = 0; i < spotsPerDay && spotIndex < selectedSpots.length; i++) {
                    const spot = selectedSpots[spotIndex++];
                    const times = spot.time.split('-');
                    
                    const schedule = {
                        id: Date.now() + Math.random() + spotIndex,
                        startTime: times[0],
                        endTime: times[1],
                        title: spot.name,
                        type: spot.type,
                        location: spot.location,
                        note: '',
                        reminders: [...batchReminders],
                        synced: false
                    };
                    
                    day.schedules.push(schedule);
                    
                    // Âª∫Á´ã LINE ÊèêÈÜí
                    if (batchReminders.length > 0) {
                        createLineReminders(day, schedule);
                    }
                    
                    // ÂêåÊ≠•Âà∞ Google Êó•ÊõÜ
                    if (batchSyncGoogle) {
                        const success = await addEventToGoogleCalendar(schedule, day);
                        if (success) schedule.synced = true;
                    }
                    
                    totalSchedules++;
                }
                
                // ÊéíÂ∫èË°åÁ®ã
                day.schedules.sort((a, b) => a.startTime.localeCompare(b.startTime));
            }
            
            saveData();
            renderItinerary();
            closeModal('autoGenerateModal');
            
            let msg = `‚úÖ Â∑≤Áî¢Áîü ${totalSchedules} ÂÄãË°åÁ®ãÔºÅ`;
            if (batchReminders.length > 0) msg += `\nüîî Â∑≤Ë®≠ÂÆö LINE ÊèêÈÜí`;
            if (batchSyncGoogle) msg += `\nüìÜ Â∑≤ÂêåÊ≠• Google Êó•ÊõÜ`;
            showToast(msg, 'success');
            
            switchPage('itinerary');
        }
        
        // ============================================
        // ÂèñÂæóÂª∫Ë≠∞ÊôØÈªûÔºàÁî®ÊñºÊâãÂãïÊñ∞Â¢ûÔºâ
        // ============================================
        function getSuggestions() {
            const dest = appData.trip.destination;
            const dbData = ATTRACTIONS_DB[dest];
            
            if (!dbData) return [];
            return dbData.spots;
        }
        
        function updateSuggestChips() {
            const container = document.getElementById('suggestChips');
            const suggestions = getSuggestions();
            
            if (suggestions.length === 0) {
                document.getElementById('suggestSection').style.display = 'none';
                return;
            }
            
            document.getElementById('suggestSection').style.display = 'block';
            container.innerHTML = suggestions.slice(0, 8).map(s => 
                `<span class="suggest-chip" onclick="selectSuggestion('${s.name}', '${s.type}', '${s.location}', '${s.time}')">${s.name}</span>`
            ).join('');
        }
        
        function selectSuggestion(name, type, location, time) {
            document.getElementById('scheduleTitle').value = name;
            document.getElementById('scheduleType').value = type;
            document.getElementById('scheduleLocation').value = location;
            
            const times = time.split('-');
            if (times.length === 2) {
                document.getElementById('scheduleStartTime').value = times[0];
                document.getElementById('scheduleEndTime').value = times[1];
            }
            
            // Ê®ôË®òÈÅ∏‰∏≠
            document.querySelectorAll('#suggestChips .suggest-chip').forEach(c => c.classList.remove('selected'));
            event.target.classList.add('selected');
        }
        
        // ============================================
        // È†ÅÈù¢ÂàáÊèõ
        // ============================================
        function switchPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => {
                if (n.querySelector('.nav-label').textContent === {home:'È¶ñÈ†Å',itinerary:'Ë°åÁ®ã',expense:'Ë®òÂ∏≥',shopping:'Ë≥ºÁâ©',checkin:'ÊâìÂç°',settings:'Ë®≠ÂÆö'}[pageId]) {
                    n.classList.add('active');
                }
            });
            // ÂàáÊèõÂà∞ÊâìÂç°È†ÅÈù¢ÊôÇÈáçÊñ∞Ê∏≤Êüì
            if (pageId === 'checkin') renderCheckinPage();
        }
        
        // ============================================
        // ÊóÖÈÅäË≥áË®ä
        // ============================================
        function handleDestinationChange() {
            const dest = document.getElementById('destination').value;
            document.getElementById('customDestGroup').style.display = dest === 'custom' ? 'block' : 'none';
            updateTripInfo();
        }
        
        function updateTripInfo() {
            const name = document.getElementById('tripName').value;
            const dest = document.getElementById('destination').value;
            const customDest = document.getElementById('customDestination').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            appData.trip.name = name;
            appData.trip.destination = dest === 'custom' ? customDest : dest;
            appData.trip.customDestination = customDest;
            appData.trip.startDate = startDate;
            appData.trip.endDate = endDate;
            
            document.getElementById('displayTripName').textContent = name || 'ÊàëÁöÑÊóÖË°å';
            document.getElementById('displayDestination').textContent = appData.trip.destination || 'üåç ÈªûÊìä‰∏ãÊñπË®≠ÂÆöÁõÆÁöÑÂú∞';
            
            if (startDate && endDate) {
                const start = new Date(startDate);
                const end = new Date(endDate);
                const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
                document.getElementById('displayDates').textContent = `üìÖ ${formatDate(start)} ~ ${formatDate(end)} (${days}Â§©)`;
                document.getElementById('statDays').textContent = days;
                
                if (appData.days.length === 0) generateDays(start, end);
            }
            
            saveData();
        }
        
        function generateDays(start, end) {
            appData.days = [];
            let current = new Date(start);
            let dayNum = 1;
            while (current <= end) {
                appData.days.push({ id: Date.now() + dayNum, date: current.toISOString().split('T')[0], title: `Day ${dayNum}`, schedules: [] });
                current.setDate(current.getDate() + 1);
                dayNum++;
            }
            renderItinerary();
            saveData();
        }
        
        // üìÖ ÊâãÂãïÂª∫Á´ã/Êõ¥Êñ∞Ë°åÁ®ãË°®Ôºà‰øùÁïôËàäË≥áÊñôÔºâ
        function manualGenerateDays() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                showToast('Ë´ãÂÖàË®≠ÂÆöÂá∫ÁôºÂíåÁµêÊùüÊó•Êúü', 'error');
                return;
            }
            
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            if (start > end) {
                showToast('ÁµêÊùüÊó•ÊúüÂøÖÈ†àÊôöÊñºÂá∫ÁôºÊó•Êúü', 'error');
                return;
            }
            
            // ÂÑ≤Â≠òËàäÁöÑ schedulesÔºàÊåâÊó•ÊúüÁ¥¢ÂºïÔºâ
            const oldSchedules = {};
            appData.days.forEach(day => {
                if (day.schedules.length > 0) {
                    oldSchedules[day.date] = day.schedules;
                }
            });
            
            // Âª∫Á´ãÊñ∞ÁöÑÊó•ÊúüÈô£Âàó
            const newDays = [];
            let current = new Date(start);
            let dayNum = 1;
            
            while (current <= end) {
                const dateStr = current.toISOString().split('T')[0];
                
                // Â¶ÇÊûúËàäË≥áÊñôÊúâÈÄôÂÄãÊó•ÊúüÁöÑË°åÁ®ãÔºå‰øùÁïôÂÆÉ
                const existingSchedules = oldSchedules[dateStr] || [];
                
                newDays.push({
                    id: Date.now() + dayNum,
                    date: dateStr,
                    title: `Day ${dayNum}`,
                    schedules: existingSchedules
                });
                
                current.setDate(current.getDate() + 1);
                dayNum++;
            }
            
            appData.days = newDays;
            
            // Áµ±Ë®àÁµêÊûú
            const keptCount = Object.keys(oldSchedules).filter(d => {
                return newDays.some(nd => nd.date === d);
            }).length;
            
            renderItinerary();
            saveData();
            
            const totalDays = newDays.length;
            let msg = `‚úÖ Â∑≤Âª∫Á´ã ${totalDays} Â§©Ë°åÁ®ãË°®`;
            if (keptCount > 0) {
                msg += `Ôºà‰øùÁïô ${keptCount} Â§©ËàäË°åÁ®ãÔºâ`;
            }
            showToast(msg, 'success');
        }
        
        // üóëÔ∏è Ê∏ÖÈô§Ê≠§Ê¨°ÊóÖË°åÔºàÈñãÂßãÊñ∞ÊóÖÈÅäÔºâ- Âê´ÂåØÂá∫ÈÅ∏È†Ö
        async function clearCurrentTrip() {
            // Ë®àÁÆóÁèæÊúâË≥áÊñô
            const scheduleCount = appData.days.reduce((sum, d) => sum + d.schedules.length, 0);
            const expenseCount = appData.expenses.length;
            const shoppingCount = appData.shopping.length;
            const notesCount = Object.keys(appData.dailyNotes || {}).length;
            const coversCount = Object.keys(appData.dayCovers || {}).length;
            const hasData = scheduleCount > 0 || expenseCount > 0 || notesCount > 0;
            
            // Â¶ÇÊûúÊúâË≥áÊñôÔºåÂÖàË©¢ÂïèÊòØÂê¶Ë¶ÅÂåØÂá∫
            if (hasData && (appData.trip.name || appData.trip.destination)) {
                const exportChoice = confirm(
                    `üìù ÊòØÂê¶ÂÖàÂ∞áÊ≠§Ê¨°ÊóÖÈÅäË®òÈåÑÂåØÂá∫Âà∞ Google DocÔºü\n\n` +
                    `Â∞áÂåØÂá∫ÁöÑÂÖßÂÆπÔºö\n` +
                    `${scheduleCount > 0 ? `‚Ä¢ ${scheduleCount} ÂÄãË°åÁ®ãÂÆâÊéí\n` : ''}` +
                    `${expenseCount > 0 ? `‚Ä¢ ${expenseCount} Á≠ÜËä±Ë≤ªÁ¥ÄÈåÑ\n` : ''}` +
                    `${notesCount > 0 ? `‚Ä¢ ${notesCount} Â§©ÁöÑÊóÖÈÅäÈªûÊª¥\n` : ''}` +
                    `\nüí° ÊâìÂç°ÁÖßÁâáÂíåÊàêÂ∞±ÊúÉËá™Âãï‰øùÁïô\n` +
                    `\nÈªû„ÄåÁ¢∫ÂÆö„Äç‚Üí ÂÖàÂåØÂá∫ÂÜçÊ∏ÖÈô§\nÈªû„ÄåÂèñÊ∂à„Äç‚Üí Áõ¥Êé•Ê∏ÖÈô§Ôºà‰∏çÂåØÂá∫Ôºâ`
                );
                
                if (exportChoice) {
                    // ÂÖàÂåØÂá∫Âà∞ Google Doc
                    const token = getStoredToken();
                    if (!token) {
                        showToast('Ë´ãÂÖàÊéàÊ¨ä Google Â∏≥ËôüÊâçËÉΩÂåØÂá∫', 'error');
                        return;
                    }
                    
                    showToast('üìù Ê≠£Âú®ÂåØÂá∫Âà∞ Google Doc...', 'info');
                    
                    try {
                        const result = await exportTripToGoogleDoc();
                        const trip = appData.trip;
                        const docTitle = `${trip.name || trip.destination + '‰πãÊóÖ'} - ÊóÖÈÅäÁ¥ÄÈåÑ`;
                        const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                        
                        // È°ØÁ§∫ÈÄ£Áµê ModalÔºå‰∏¶Êèê‰æõÁπºÁ∫åÊ∏ÖÈô§ÁöÑÈÅ∏È†Ö
                        showDocLinkModal(docTitle, docUrl, true);
                        return; // Á≠âÂæÖÁî®Êà∂Âú® Modal ‰∏≠ÈÅ∏Êìá
                        
                    } catch (err) {
                        console.error('ÂåØÂá∫Â§±Êïó:', err);
                        if (!confirm('ÂåØÂá∫Â§±ÊïóÔºåÊòØÂê¶‰ªçË¶ÅÊ∏ÖÈô§Ë≥áÊñôÔºü')) {
                            return;
                        }
                    }
                }
            }
            
            // ÊúÄÂæåÁ¢∫Ë™çÊ∏ÖÈô§
            let msg = 'Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§Ê≠§Ê¨°ÊóÖË°åÂóéÔºü\n\n';
            msg += '‚ö†Ô∏è ‰ª•‰∏ãË≥áÊñôÂ∞áË¢´Ê∏ÖÈô§Ôºö\n';
            msg += `‚Ä¢ ÊóÖÈÅäË®≠ÂÆöÔºàÂêçÁ®±„ÄÅÁõÆÁöÑÂú∞„ÄÅÊó•ÊúüÔºâ\n`;
            if (scheduleCount > 0) msg += `‚Ä¢ ${scheduleCount} ÂÄãË°åÁ®ãÂÆâÊéí\n`;
            if (expenseCount > 0) msg += `‚Ä¢ ${expenseCount} Á≠ÜËä±Ë≤ªÁ¥ÄÈåÑ\n`;
            if (shoppingCount > 0) msg += `‚Ä¢ ${shoppingCount} ÂÄãË≥ºÁâ©Ê∏ÖÂñÆ\n`;
            if (coversCount > 0) msg += `‚Ä¢ ${coversCount} ÂºµÊØèÊó•Â∞ÅÈù¢\n`;
            msg += '\nüíæ ÊúÉ‰øùÁïôÁöÑË≥áÊñôÔºö\n';
            msg += '‚Ä¢ API Ë®≠ÂÆöÔºàÈáëÈë∞Ôºâ\n';
            msg += '‚Ä¢ ‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥Êó•Ë®ò\n';
            msg += '‚Ä¢ üì∏ ÊâìÂç°ÁÖßÁâáÂíåÊôØÈªû\n';
            msg += '‚Ä¢ üèÜ ÊàêÂ∞±ÂæΩÁ´†';
            
            if (!confirm(msg)) return;
            
            // Âü∑Ë°åÊ∏ÖÈô§
            doResetTrip();
        }
        
        // ÂØ¶ÈöõÂü∑Ë°åÊ∏ÖÈô§
        function doResetTrip() {
            appData.trip = { name: '', destination: '', customDestination: '', startDate: '', endDate: '', mainCurrency: 'JPY', budget: 100000 };
            appData.days = [];
            appData.expenses = [];
            appData.shopping = [];
            // appData.dailyNotes = {}; // ‚úçÔ∏è ‰øùÁïôÊóÖÈÅäÈªûÊª¥ÔºÅ
            appData.dayCovers = {};
            appData.members = ['Êàë'];
            // üì∏ ‰øùÁïôÊâìÂç°Ë≥áÊñô‰ΩúÁÇ∫ÊóÖÈÅäÂõûÊÜ∂ÔºÅ
            // appData.spots, appData.checkins, appData.badges ‰∏çÊ∏ÖÈô§
            
            // ÈáçÁΩÆË°®ÂñÆ
            document.getElementById('tripName').value = '';
            document.getElementById('destination').value = '';
            document.getElementById('customDestination').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('customDestGroup').style.display = 'none';
            
            // Êõ¥Êñ∞È°ØÁ§∫
            document.getElementById('displayTripName').textContent = 'ÊàëÁöÑÊóÖË°å';
            document.getElementById('displayDestination').textContent = 'üåç ÈªûÊìä‰∏ãÊñπË®≠ÂÆöÁõÆÁöÑÂú∞';
            document.getElementById('displayDates').textContent = 'üìÖ Ë®≠ÂÆöÊóÖÈÅäÊó•Êúü';
            document.getElementById('statDays').textContent = '0';
            
            renderAll();
            saveData();
            
            showToast('‚úÖ Â∑≤Ê∏ÖÈô§ÔºåÂèØ‰ª•ÈñãÂßãÊñ∞ÁöÑÊóÖÈÅäË¶èÂäÉÔºÅ', 'success');
        }
        
        // üìù ÂåØÂá∫ÊóÖÈÅäË®òÈåÑÂà∞ Google DocÔºà‰∏çÈ°ØÁ§∫Á¢∫Ë™çÊ°ÜÔºåÁî®ÊñºËá™ÂãïÂåØÂá∫Ôºâ
        async function exportTripToGoogleDoc() {
            const token = getStoredToken();
            if (!token) throw new Error('Êú™ÊéàÊ¨ä');
            
            const trip = appData.trip;
            const docTitle = `${trip.name || trip.destination + '‰πãÊóÖ'} - ÊóÖÈÅäÁ¥ÄÈåÑ (${new Date().toLocaleDateString('zh-TW')})`;
            
            // ÁµÑÂêà HTML ÂÖßÂÆπ
            let htmlContent = `
                <html>
                <head><meta charset="utf-8"></head>
                <body style="font-family: Arial, sans-serif; line-height: 1.8;">
                
                <h1 style="color: #06b6d4; border-bottom: 3px solid #06b6d4; padding-bottom: 10px;">
                    ‚úàÔ∏è ${trip.name || trip.destination + '‰πãÊóÖ'}
                </h1>
                
                <table style="margin: 20px 0; font-size: 14px;">
                    <tr><td>üìç <strong>ÁõÆÁöÑÂú∞</strong></td><td style="padding-left: 20px;">${trip.destination}</td></tr>
                    <tr><td>üìÖ <strong>Êó•Êúü</strong></td><td style="padding-left: 20px;">${formatDate(new Date(trip.startDate))} ~ ${formatDate(new Date(trip.endDate))}</td></tr>
                    <tr><td>üí∞ <strong>‰∏ªË¶ÅË≤®Âπ£</strong></td><td style="padding-left: 20px;">${trip.mainCurrency}</td></tr>
                </table>
                
                <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
            `;
            
            // ÊØèÊó•Ë°åÁ®ãËàáÈªûÊª¥
            appData.days.forEach(day => {
                htmlContent += `
                    <h2 style="color: #a855f7; margin-top: 30px;">
                        üìÖ ${day.title} - ${formatDate(new Date(day.date))}
                    </h2>
                `;
                
                // Ë°åÁ®ã
                if (day.schedules.length > 0) {
                    htmlContent += `<h3 style="color: #10b981;">üìã Ë°åÁ®ãÂÆâÊéí</h3><ul>`;
                    day.schedules.forEach(s => {
                        htmlContent += `
                            <li style="margin-bottom: 10px;">
                                <strong>${s.startTime} - ${s.endTime}</strong> ${getTypeEmoji(s.type)} ${escapeHtml(s.title)}
                                ${s.location ? `<br><span style="color: #666;">üìç ${escapeHtml(s.location)}</span>` : ''}
                                ${s.note ? `<br><span style="color: #888;">üí¨ ${escapeHtml(s.note)}</span>` : ''}
                            </li>
                        `;
                    });
                    htmlContent += `</ul>`;
                }
                
                // ÊóÖÈÅäÈªûÊª¥
                const notes = appData.dailyNotes?.[day.date] || [];
                if (notes.length > 0) {
                    htmlContent += `<h3 style="color: #ec4899;">‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥</h3>`;
                    notes.forEach(note => {
                        htmlContent += `
                            <div style="background: #f8f9fa; border-left: 4px solid #a855f7; padding: 15px; margin: 10px 0; border-radius: 0 8px 8px 0;">
                                <div style="font-size: 1.2em; margin-bottom: 5px;">
                                    ${note.mood} <span style="color: #666; font-size: 0.85em;">üïê ${note.time}</span>
                                </div>
                                <div style="white-space: pre-wrap;">${escapeHtml(note.content)}</div>
                            </div>
                        `;
                    });
                }
                
                if (appData.dayCovers?.[day.date]) {
                    htmlContent += `<p style="color: #06b6d4;">üì∏ <em>Êú¨Êó•ÊúâÂ∞ÅÈù¢ÁÖßÁâáÔºàÂÑ≤Â≠òÊñº APP ‰∏≠Ôºâ</em></p>`;
                }
                
                htmlContent += `<hr style="border: none; border-top: 1px solid #e2e8f0; margin: 20px 0;">`;
            });
            
            // üí∞ Ëä±Ë≤ªÁ¥ÄÈåÑÔºàÂê´ÂàÜÂ∏≥Ë≥áË®äÔºâ
            if (appData.expenses.length > 0) {
                // Ë®àÁÆóÁ∏ΩËä±Ë≤ª
                let totalTWD = 0;
                appData.expenses.forEach(e => {
                    const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                    totalTWD += e.amount * rate;
                });
                
                htmlContent += `
                    <h2 style="color: #f59e0b; margin-top: 30px;">üí∞ Ëä±Ë≤ªÁ¥ÄÈåÑ</h2>
                    <p style="font-size: 1.2em; color: #f59e0b;"><strong>Á∏ΩËä±Ë≤ªÔºöNT$ ${Math.round(totalTWD).toLocaleString()}</strong></p>
                    <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                        <tr style="background: #1e293b; color: white;">
                            <th style="padding: 10px; text-align: left;">Êó•Êúü</th>
                            <th style="padding: 10px; text-align: left;">È°ûÂà•</th>
                            <th style="padding: 10px; text-align: left;">È†ÖÁõÆ</th>
                            <th style="padding: 10px; text-align: right;">ÈáëÈ°ç</th>
                            <th style="padding: 10px; text-align: left;">Â¢ä‰ªò‰∫∫</th>
                            <th style="padding: 10px; text-align: left;">ÂàÜÊî§</th>
                        </tr>
                `;
                appData.expenses.forEach((e, i) => {
                    const bg = i % 2 === 0 ? '#f8f9fa' : '#ffffff';
                    const splitInfo = e.splitWith ? e.splitWith.join(', ') : 'ÂÖ®Âì°';
                    htmlContent += `
                        <tr style="background: ${bg};">
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.date}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.category}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${escapeHtml(e.item)}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right;">${e.currency} ${e.amount.toLocaleString()}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.paidBy || 'Êàë'}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${splitInfo}</td>
                        </tr>
                    `;
                });
                htmlContent += `</table>`;
                
                // üë• ÂàÜÂ∏≥ÁµêÁÆó
                if (appData.members && appData.members.length > 1) {
                    const splitData = calculateSplit();
                    htmlContent += `
                        <h3 style="color: #10b981; margin-top: 20px;">üë• ÂàÜÂ∏≥ÁµêÁÆó</h3>
                        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                            <tr style="background: #10b981; color: white;">
                                <th style="padding: 10px; text-align: left;">ÊàêÂì°</th>
                                <th style="padding: 10px; text-align: right;">Â∑≤Â¢ä‰ªò</th>
                                <th style="padding: 10px; text-align: right;">ÊáâÂàÜÊî§</th>
                                <th style="padding: 10px; text-align: right;">ÁµêÁÆó</th>
                            </tr>
                    `;
                    Object.keys(splitData).forEach((m, i) => {
                        const data = splitData[m];
                        const balance = Math.round(data.balance);
                        const balanceText = balance >= 0 ? `+NT$${balance.toLocaleString()}` : `-NT$${Math.abs(balance).toLocaleString()}`;
                        const balanceColor = balance >= 0 ? '#10b981' : '#f59e0b';
                        const bg = i % 2 === 0 ? '#f8f9fa' : '#ffffff';
                        htmlContent += `
                            <tr style="background: ${bg};">
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">üë§ ${m}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: #06b6d4;">NT$${Math.round(data.paid).toLocaleString()}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: #f59e0b;">NT$${Math.round(data.shouldPay).toLocaleString()}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: ${balanceColor}; font-weight: bold;">${balanceText}</td>
                            </tr>
                        `;
                    });
                    htmlContent += `</table>`;
                }
            }
            
            // Ë≥ºÁâ©Ê∏ÖÂñÆ
            if (appData.shopping.length > 0) {
                htmlContent += `<h2 style="color: #ec4899; margin-top: 30px;">üõçÔ∏è Ë≥ºÁâ©Ê∏ÖÂñÆ</h2><ul>`;
                appData.shopping.forEach(s => {
                    const checked = s.bought ? '‚úÖ' : '‚¨ú';
                    const style = s.bought ? 'text-decoration: line-through; color: #888;' : '';
                    htmlContent += `
                        <li style="${style}">
                            ${checked} ${escapeHtml(s.item)}
                            ${s.price > 0 ? ` - ${s.currency || trip.mainCurrency} ${s.price.toLocaleString()}` : ''}
                        </li>
                    `;
                });
                htmlContent += `</ul>`;
            }
            
            // ÁµêÂ∞æ
            htmlContent += `
                <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
                <p style="text-align: center; color: #888; font-size: 0.9em;">
                    ‚úàÔ∏è ÊóÖÈÅäÁ¥ÄÈåÑÁî±„ÄåÊóÖÈÅäÁßòÊõ∏„ÄçËá™ÂãïÁî¢Áîü<br>
                    üìÖ ÂåØÂá∫ÊôÇÈñìÔºö${new Date().toLocaleString('zh-TW')}
                </p>
                </body></html>
            `;
            
            // ‰ΩøÁî® Google Drive API ÂâµÂª∫ Google Doc
            const metadata = {
                name: docTitle,
                mimeType: 'application/vnd.google-apps.document'
            };
            
            const boundary = '-------314159265358979323846';
            const delimiter = "\r\n--" + boundary + "\r\n";
            const closeDelim = "\r\n--" + boundary + "--";
            
            const multipartRequestBody =
                delimiter +
                'Content-Type: application/json\r\n\r\n' +
                JSON.stringify(metadata) +
                delimiter +
                'Content-Type: text/html\r\n\r\n' +
                htmlContent +
                closeDelim;
            
            const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token.access_token,
                    'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                },
                body: multipartRequestBody
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'Âª∫Á´ãÂ§±Êïó');
            }
            
            return await response.json();
        }
        
        // ============================================
        // Ë°åÁ®ãÁÆ°ÁêÜ
        // ============================================
        function renderItinerary() {
            const container = document.getElementById('itineraryList');
            if (appData.days.length === 0) {
                const hasDate = appData.trip.startDate && appData.trip.endDate;
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìÖ</div>
                        <div>Â∞öÊú™Ë®≠ÂÆöË°åÁ®ã</div>
                        ${hasDate 
                            ? `<button class="btn btn-primary btn-sm" style="margin-top:15px;" onclick="manualGenerateDays()">üìÖ Âª∫Á´ãË°åÁ®ãË°®</button>`
                            : `<div style="margin-top:10px;font-size:0.9em;color:var(--text-dim);">Ë´ãÂÖàÂú®È¶ñÈ†ÅË®≠ÂÆöÊóÖÈÅäÊó•Êúü</div>`
                        }
                    </div>
                `;
                return;
            }
            container.innerHTML = appData.days.map(day => {
                const coverPhoto = appData.dayCovers?.[day.date];
                const scheduleHtml = day.schedules.length > 0 
                    ? day.schedules.map(s => `
                        <div class="schedule-item ${s.reminders?.length > 0 ? 'has-reminder' : ''} ${s.synced ? 'synced' : ''}">
                            <div class="schedule-time">${s.startTime} - ${s.endTime}</div>
                            <div class="schedule-title">${getTypeEmoji(s.type)} ${s.title}</div>
                            ${s.location ? `<div class="schedule-location">üìç ${s.location} <a class="map-btn" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.location)}" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">üó∫Ô∏è</a></div>` : ''}
                            <div class="schedule-actions">
                                ${s.reminders?.length > 0 ? '<span class="schedule-badge reminder">üîî Â∑≤Ë®≠ÊèêÈÜí</span>' : ''}
                                ${s.synced ? '<span class="schedule-badge synced">üìÜ Â∑≤ÂêåÊ≠•</span>' : ''}
                            </div>
                            <div class="schedule-actions" style="margin-top:6px;">
                                <button class="btn btn-outline btn-xs" onclick="deleteSchedule(${day.id}, ${s.id})">üóëÔ∏è</button>
                                ${!s.synced ? `<button class="btn btn-secondary btn-xs" onclick="syncSingleToGoogle(${day.id}, ${s.id})">üìÜ</button>` : ''}
                            </div>
                        </div>
                    `).join('')
                    : '<div style="color:var(--text-muted);font-size:0.9em;padding:10px 0;">Â∞öÁÑ°Ë°åÁ®ãÂÆâÊéí</div>';
                
                // üì∏ Â∞ÅÈù¢ÁÖßÁâáÂçÄÂüü
                const coverHtml = coverPhoto 
                    ? `<div class="day-cover">
                        <img src="${coverPhoto}" alt="Êú¨Êó•Â∞ÅÈù¢">
                        <button class="cover-edit-btn" onclick="event.stopPropagation();showPhotoModal('${day.date}')">üì∑ Êõ¥ÊèõÂ∞ÅÈù¢</button>
                       </div>`
                    : `<div class="day-cover" onclick="showPhotoModal('${day.date}')">
                        <div class="day-cover-placeholder">
                            <div class="icon">üì∑</div>
                            <div>ÈªûÊìäË®≠ÂÆöÊú¨Êó•Â∞ÅÈù¢</div>
                        </div>
                       </div>`;
                
                return `
                    <div class="day-card ${coverPhoto ? 'day-card-with-cover' : ''}">
                        ${coverHtml}
                        <div class="day-header" onclick="toggleDayContent(${day.id})">
                            <div><div class="day-title">${day.title}</div><div class="day-date">${formatDate(new Date(day.date))} ‚Ä¢ ${day.schedules.length} ÂÄãË°åÁ®ã</div></div>
                            <span id="dayArrow${day.id}">‚ñº</span>
                        </div>
                        <div class="day-content" id="dayContent${day.id}">
                            ${scheduleHtml}
                            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;">
                                <button class="btn btn-outline btn-sm" onclick="showAddScheduleModal(${day.id})" style="flex:1;">‚ûï Êñ∞Â¢ûË°åÁ®ã</button>
                                <button class="notes-btn" onclick="showDailyNotesModal('${day.date}', '${day.title}')">
                                    ‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥ ${(appData.dailyNotes?.[day.date]?.length || 0) > 0 ? `<span class="count">${appData.dailyNotes[day.date].length}</span>` : ''}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleDayContent(dayId) {
            const content = document.getElementById('dayContent' + dayId);
            const arrow = document.getElementById('dayArrow' + dayId);
            content.classList.toggle('show');
            arrow.textContent = content.classList.contains('show') ? '‚ñ≤' : '‚ñº';
        }
        
        function showAddScheduleModal(dayId) {
            const select = document.getElementById('scheduleDay');
            select.innerHTML = appData.days.map(d => `<option value="${d.id}" ${d.id === dayId ? 'selected' : ''}>${d.title} (${formatDate(new Date(d.date))})</option>`).join('');
            
            document.getElementById('scheduleStartTime').value = '09:00';
            document.getElementById('scheduleEndTime').value = '10:00';
            document.getElementById('scheduleTitle').value = '';
            document.getElementById('scheduleType').value = 'ÊôØÈªû';
            document.getElementById('scheduleLocation').value = '';
            document.getElementById('scheduleNote').value = '';
            document.querySelectorAll('#scheduleModal .reminder-option').forEach(r => r.classList.remove('checked'));
            
            updateSuggestChips();
            showModal('scheduleModal');
        }
        
        // üÜï ÂÖ®ÂüüÊñ∞Â¢ûË°åÁ®ãÔºàÂæûË°åÁ®ãÈ†ÅÈù¢È†ÇÈÉ®ÊåâÈàïÔºâ
        function showAddScheduleModalGlobal() {
            if (appData.days.length === 0) {
                showToast('Ë´ãÂÖàË®≠ÂÆöÊóÖÈÅäÊó•Êúü‰∏¶Âª∫Á´ãË°åÁ®ãË°®', 'error');
                return;
            }
            // È†êË®≠ÈÅ∏ÊìáÁ¨¨‰∏ÄÂ§©
            showAddScheduleModal(appData.days[0].id);
        }
        
        function showAddDayModal() {
            document.getElementById('newDayDate').value = '';
            document.getElementById('newDayTitle').value = '';
            showModal('dayModal');
        }
        
        function saveNewDay() {
            const date = document.getElementById('newDayDate').value;
            const title = document.getElementById('newDayTitle').value;
            if (!date) { showToast('Ë´ãÈÅ∏ÊìáÊó•Êúü', 'error'); return; }
            const dayNum = appData.days.length + 1;
            appData.days.push({ id: Date.now(), date, title: title || `Day ${dayNum}`, schedules: [] });
            appData.days.sort((a, b) => new Date(a.date) - new Date(b.date));
            saveData();
            renderItinerary();
            closeModal('dayModal');
            showToast('Â∑≤Êñ∞Â¢ûË°åÁ®ãÊó•', 'success');
        }
        
        async function saveSchedule() {
            const dayId = parseInt(document.getElementById('scheduleDay').value);
            const startTime = document.getElementById('scheduleStartTime').value;
            const endTime = document.getElementById('scheduleEndTime').value;
            const title = document.getElementById('scheduleTitle').value;
            const type = document.getElementById('scheduleType').value;
            const location = document.getElementById('scheduleLocation').value;
            const note = document.getElementById('scheduleNote').value;
            const syncToGoogle = document.getElementById('syncToGoogle').checked;
            
            if (!title) { showToast('Ë´ãËº∏ÂÖ•Ê¥ªÂãïÂêçÁ®±', 'error'); return; }
            
            const reminders = [];
            document.querySelectorAll('#scheduleModal .reminder-option.checked input[value]:not([id="syncToGoogle"])').forEach(input => {
                if (input.value !== 'google') reminders.push(parseInt(input.value));
            });
            
            const day = appData.days.find(d => d.id === dayId);
            if (day) {
                const schedule = { id: Date.now(), startTime, endTime, title, type, location, note, reminders, synced: false };
                day.schedules.push(schedule);
                day.schedules.sort((a, b) => a.startTime.localeCompare(b.startTime));
                
                if (syncToGoogle) {
                    const success = await addEventToGoogleCalendar(schedule, day);
                    if (success) schedule.synced = true;
                }
                
                if (reminders.length > 0) createLineReminders(day, schedule);
                
                saveData();
                renderItinerary();
                closeModal('scheduleModal');
                showToast('Â∑≤Êñ∞Â¢ûË°åÁ®ã', 'success');
            }
        }
        
        function deleteSchedule(dayId, scheduleId) {
            if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§Ôºü')) return;
            const day = appData.days.find(d => d.id === dayId);
            if (day) {
                day.schedules = day.schedules.filter(s => s.id !== scheduleId);
                saveData();
                renderItinerary();
                showToast('Â∑≤Âà™Èô§', 'success');
            }
        }
        
        // ============================================
        // Google Calendar
        // ============================================
        function initGoogleAPI() {
            if (typeof gapi !== 'undefined') {
                gapi.load('client', async function() {
                    try {
                        await gapi.client.init({ discoveryDocs: DISCOVERY_DOCS });
                        gapiInited = true;
                        loadSavedToken();
                    } catch (err) { console.error('GAPI init failed:', err); }
                });
            }
        }
        
        function saveGoogleToken(token) {
            try {
                localStorage.setItem(TOKEN_KEY, JSON.stringify({ token, savedAt: Date.now(), expiresIn: TOKEN_SOFT_EXPIRE, actualExpiresIn: token.expires_in || 3600 }));
            } catch (e) {}
        }
        
        function loadSavedToken() {
            try {
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return false;
                const tokenData = JSON.parse(saved);
                const elapsed = (Date.now() - tokenData.savedAt) / 1000;
                if (elapsed < tokenData.expiresIn - 300) {
                    gapi.client.setToken(tokenData.token);
                    gisInited = true;
                    const remaining = Math.floor((tokenData.expiresIn - elapsed) / 3600);
                    const mins = Math.floor(((tokenData.expiresIn - elapsed) % 3600) / 60);
                    const statusEl = document.getElementById('googleAuthStatus');
                    statusEl.innerHTML = `‚úÖ Â∑≤ÊéàÊ¨äÔºàÂâ©È§òÁ¥Ñ ${remaining > 0 ? remaining + ' Â∞èÊôÇ ' : ''}${mins} ÂàÜÈêòÔºâ`;
                    statusEl.className = 'auth-status success';
                    statusEl.style.display = 'block';
                    return true;
                } else {
                    localStorage.removeItem(TOKEN_KEY);
                    return false;
                }
            } catch (e) { return false; }
        }
        
        function isTokenValid() {
            const token = gapi.client.getToken();
            if (!token) return false;
            try {
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return !!token;
                const tokenData = JSON.parse(saved);
                return (Date.now() - tokenData.savedAt) / 1000 < tokenData.expiresIn - 60;
            } catch (e) { return !!token; }
        }
        
        // ÂèñÂæóÂ∑≤ÂÑ≤Â≠òÁöÑ TokenÔºàÁî®Êñº API ÂëºÂè´Ôºâ
        function getStoredToken() {
            try {
                // ÂÖàÂòóË©¶Âæû gapi ÂèñÂæó
                const gapiToken = gapi.client.getToken();
                if (gapiToken) return gapiToken;
                
                // Âæû localStorage ÂèñÂæó
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return null;
                const tokenData = JSON.parse(saved);
                const elapsed = (Date.now() - tokenData.savedAt) / 1000;
                if (elapsed < tokenData.expiresIn - 60) {
                    return tokenData.token;
                }
                return null;
            } catch (e) { return null; }
        }
        
        function initTokenClient() {
            const clientId = document.getElementById('googleClientId').value.trim();
            if (!clientId) { showToast('Ë´ãÂÖàËº∏ÂÖ• Google Client ID', 'error'); return false; }
            if (typeof google === 'undefined' || !google.accounts) { showToast('Google API Â∞öÊú™ËºâÂÖ•', 'error'); return false; }
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: clientId,
                scope: SCOPES,
                callback: function(response) {
                    if (response.error) { showToast('ÊéàÊ¨äÂ§±Êïó: ' + response.error, 'error'); return; }
                    gisInited = true;
                    saveGoogleToken(response);
                    const statusEl = document.getElementById('googleAuthStatus');
                    statusEl.innerHTML = '‚úÖ Â∑≤ÊéàÊ¨äÔºà24 Â∞èÊôÇÊúâÊïàÔºâ';
                    statusEl.className = 'auth-status success';
                    statusEl.style.display = 'block';
                    showToast('‚úÖ Google Êó•ÊõÜÊéàÊ¨äÊàêÂäüÔºÅ', 'success');
                }
            });
            return true;
        }
        
        function handleGoogleAuthorize() {
            if (isTokenValid()) { showToast('ÊéàÊ¨ä‰ªçÁÑ∂ÊúâÊïà', 'success'); return; }
            if (!initTokenClient()) return;
            tokenClient.requestAccessToken({ prompt: '' });
        }
        
        // üîÑ ÈáçÊñ∞ÊéàÊ¨ä GoogleÔºàÊ∏ÖÈô§Ëàä TokenÔºåÂê´ Drive Ê¨äÈôêÔºâ
        function reauthorizeGoogle() {
            if (!confirm('Á¢∫ÂÆöË¶ÅÈáçÊñ∞ÊéàÊ¨äÂóéÔºü\n\nÈÄôÊúÉÊ∏ÖÈô§ÁèæÊúâÁöÑ Google ÊéàÊ¨äÔºåÈúÄË¶ÅÈáçÊñ∞ÁôªÂÖ•‰∏¶ÂÖÅË®±Ê¨äÈôê„ÄÇ\n\n‚ö†Ô∏è ÊóÖÈÅäË≥áÊñô‰∏çÊúÉÊ∂àÂ§±ÔºÅ')) {
                return;
            }
            
            // Ê∏ÖÈô§Ëàä Token
            localStorage.removeItem(TOKEN_KEY);
            
            // ÈáçÊñ∞ÂàùÂßãÂåñ‰∏¶Ë´ãÊ±ÇÊéàÊ¨äÔºàÂº∑Âà∂È°ØÁ§∫ÂêåÊÑèÁï´Èù¢Ôºâ
            if (!initTokenClient()) return;
            
            showToast('üîÑ Ê≠£Âú®ÈáçÊñ∞ÊéàÊ¨ä...', 'info');
            
            // ‰ΩøÁî® prompt: 'consent' Âº∑Âà∂È°ØÁ§∫ÂêåÊÑèÁï´Èù¢ÔºåÈÄôÊ®£ÊâçÊúÉÂåÖÂê´Êñ∞ÁöÑ scope
            tokenClient.requestAccessToken({ prompt: 'consent' });
        }
        
        async function addEventToGoogleCalendar(schedule, day) {
            if (!isTokenValid()) return false;
            const calendarEvent = {
                summary: schedule.title,
                location: schedule.location || '',
                description: schedule.note || '',
                start: { dateTime: day.date + 'T' + schedule.startTime + ':00', timeZone: 'Asia/Taipei' },
                end: { dateTime: day.date + 'T' + schedule.endTime + ':00', timeZone: 'Asia/Taipei' },
                reminders: { useDefault: false, overrides: [{ method: 'popup', minutes: 60 }] }
            };
            try {
                await gapi.client.calendar.events.insert({ calendarId: 'primary', resource: calendarEvent });
                return true;
            } catch (err) { return false; }
        }
        
        async function syncSingleToGoogle(dayId, scheduleId) {
            const day = appData.days.find(d => d.id === dayId);
            const schedule = day?.schedules.find(s => s.id === scheduleId);
            if (!day || !schedule) return;
            showToast('üîÑ ÂêåÊ≠•‰∏≠...', 'info');
            if (await addEventToGoogleCalendar(schedule, day)) {
                schedule.synced = true;
                saveData();
                renderItinerary();
                showToast('‚úÖ ÂêåÊ≠•ÊàêÂäü', 'success');
            } else {
                showToast('‚ùå ÂêåÊ≠•Â§±Êïó', 'error');
            }
        }
        
        async function syncAllToGoogleCalendar() {
            if (!isTokenValid()) { showToast('Ë´ãÂÖàÊéàÊ¨ä Google Êó•ÊõÜ', 'error'); return; }
            showToast('üîÑ ÂêåÊ≠•‰∏≠...', 'info');
            let count = 0;
            for (const day of appData.days) {
                for (const schedule of day.schedules) {
                    if (!schedule.synced && await addEventToGoogleCalendar(schedule, day)) {
                        schedule.synced = true;
                        count++;
                    }
                }
            }
            saveData();
            renderItinerary();
            showToast(count > 0 ? `‚úÖ Â∑≤ÂêåÊ≠• ${count} ÂÄãË°åÁ®ã` : 'ÊâÄÊúâË°åÁ®ãÂ∑≤ÂêåÊ≠•', 'success');
        }
        
        // ============================================
        // LINE ÊèêÈÜí
        // ============================================
        function createLineReminders(day, schedule) {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) return;
            const schedules = [];
            const startDateTime = new Date(day.date + 'T' + schedule.startTime + ':00');
            const endDateTime = new Date(day.date + 'T' + schedule.endTime + ':00');
            const labels = { 1440: 'Ââç 1 Â§©', 120: 'Ââç 2 Â∞èÊôÇ', 60: 'Ââç 1 Â∞èÊôÇ', 30: 'Ââç 30 ÂàÜÈêò' };
            schedule.reminders.forEach(mins => {
                const reminderTime = new Date(startDateTime.getTime() - mins * 60 * 1000);
                if (reminderTime > new Date()) {
                    schedules.push({ workshopTitle: schedule.title, workshopStart: startDateTime.toISOString(), workshopEnd: endDateTime.toISOString(), workshopLocation: schedule.location || '', reminderTime: reminderTime.toISOString(), reminderMinutes: mins, reminderLabel: labels[mins] || '' });
                }
            });
            if (schedules.length === 0) return;
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'createSchedules', secret: gasSecret, token: lineToken, userId: lineUserId, schedules }) }).then(r => r.json()).then(result => { if (result.success) showToast('üîî Â∑≤Âª∫Á´ãÊèêÈÜí', 'success'); });
        }
        
        function testLineNotification() {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) { showToast('Ë´ãÂ°´ÂØ´ÂÆåÊï¥Ë®≠ÂÆö', 'error'); return; }
            showToast('üì® ÁôºÈÄÅ‰∏≠...', 'info');
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ secret: gasSecret, token: lineToken, userId: lineUserId, message: 'üß™ Ê∏¨Ë©¶ÈÄöÁü•\n\n‚úàÔ∏è ÊóÖÈÅäÁßòÊõ∏Â∑≤ÊàêÂäüÈÄ£Êé•ÔºÅ' }) })
                .then(r => r.json())
                .then(result => showToast(result.success ? '‚úÖ ÁôºÈÄÅÊàêÂäü' : '‚ùå ' + result.error, result.success ? 'success' : 'error'))
                .catch(err => showToast('‚ùå ' + err.message, 'error'));
        }
        
        function viewSchedules() {
            const { gasUrl, gasSecret } = appData.settings;
            if (!gasUrl || !gasSecret) { showToast('Ë´ãÂÖàË®≠ÂÆö GAS', 'error'); return; }
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'getSchedules', secret: gasSecret }) })
                .then(r => r.json())
                .then(result => showToast(result.success ? `üìã ${result.schedules?.length || 0} ÂÄãÊéíÁ®ã` : '‚ùå Êü•Ë©¢Â§±Êïó', result.success ? 'success' : 'error'));
        }
        
        function clearAllSchedules() {
            const { gasUrl, gasSecret } = appData.settings;
            if (!gasUrl || !gasSecret) { showToast('Ë´ãÂÖàË®≠ÂÆö GAS', 'error'); return; }
            
            if (!confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâ LINE ÊèêÈÜíÊéíÁ®ãÔºü\n\n‚ö†Ô∏è ÈÄôÊúÉÂà™Èô§Ë≥áÊñôÂ∫´‰∏≠ÊâÄÊúâÂæÖÁôºÈÄÅÁöÑÊèêÈÜí')) return;
            
            showToast('üóëÔ∏è Ê∏ÖÈô§‰∏≠...', 'info');
            
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'clearSchedules', secret: gasSecret }) })
                .then(r => r.json())
                .then(result => {
                    if (result.success) {
                        showToast('‚úÖ Â∑≤Ê∏ÖÈô§ÊâÄÊúâÊéíÁ®ã', 'success');
                    } else {
                        showToast('‚ùå ' + (result.error || 'Ê∏ÖÈô§Â§±Êïó'), 'error');
                    }
                })
                .catch(err => showToast('‚ùå ' + err.message, 'error'));
        }
        
        // ============================================
        // ÊâπÊ¨°Ë®≠ÂÆöÊèêÈÜí
        // ============================================
        function showBatchReminderModal() {
            // Áµ±Ë®àË°åÁ®ãÊï∏Èáè
            let totalSchedules = 0;
            let withReminders = 0;
            let withoutReminders = 0;
            
            appData.days.forEach(day => {
                day.schedules.forEach(s => {
                    totalSchedules++;
                    if (s.reminders && s.reminders.length > 0) {
                        withReminders++;
                    } else {
                        withoutReminders++;
                    }
                });
            });
            
            const statsHtml = `
                <div style="display:flex;justify-content:space-around;text-align:center;">
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--cyan);">${totalSchedules}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">Á∏ΩË°åÁ®ãÊï∏</div>
                    </div>
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--orange);">${withReminders}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">Â∑≤ÊúâÊèêÈÜí</div>
                    </div>
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--text-dim);">${withoutReminders}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">ÁÑ°ÊèêÈÜí</div>
                    </div>
                </div>
            `;
            document.getElementById('batchReminderStats').innerHTML = statsHtml;
            
            // ÈáçÁΩÆÈÅ∏È†Ö
            document.querySelectorAll('#batchReminderOptions .reminder-option').forEach(opt => {
                const input = opt.querySelector('input');
                if (input.value === '1440' || input.value === '60') {
                    opt.classList.add('checked');
                    input.checked = true;
                } else {
                    opt.classList.remove('checked');
                    input.checked = false;
                }
            });
            
            showModal('batchReminderModal');
        }
        
        async function applyBatchReminders() {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) {
                showToast('Ë´ãÂÖàÂú®Ë®≠ÂÆöÈ†ÅÈù¢Â°´ÂØ´ LINE Âíå GAS Ë≥áË®ä', 'error');
                return;
            }
            
            // ÂèñÂæóÈÅ∏‰∏≠ÁöÑÊèêÈÜíÊôÇÈñì
            const selectedReminders = [];
            document.querySelectorAll('#batchReminderOptions .reminder-option.checked input').forEach(input => {
                selectedReminders.push(parseInt(input.value));
            });
            
            if (selectedReminders.length === 0) {
                showToast('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏ÄÂÄãÊèêÈÜíÊôÇÈñì', 'error');
                return;
            }
            
            const overwrite = document.getElementById('overwriteReminders')?.checked || false;
            const clearOld = document.getElementById('clearOldSchedules')?.checked || false;
            
            showToast('üîÑ Ë®≠ÂÆö‰∏≠...', 'info');
            
            // Â¶ÇÊûúÈÅ∏ÊìáÊ∏ÖÈô§ËàäÊéíÁ®ã
            if (clearOld) {
                try {
                    const clearResult = await fetch(gasUrl, { 
                        method: 'POST', 
                        headers: { 'Content-Type': 'text/plain' }, 
                        body: JSON.stringify({ action: 'clearSchedules', secret: gasSecret }) 
                    }).then(r => r.json());
                    
                    if (clearResult.success) {
                        console.log('Â∑≤Ê∏ÖÈô§ËàäÊéíÁ®ã');
                    }
                } catch (err) {
                    console.error('Ê∏ÖÈô§ÊéíÁ®ãÂ§±Êïó:', err);
                }
            }
            
            let updatedCount = 0;
            let reminderCount = 0;
            
            appData.days.forEach(day => {
                day.schedules.forEach(schedule => {
                    // Ê™¢Êü•ÊòØÂê¶ÈúÄË¶ÅÊõ¥Êñ∞
                    const hasReminders = schedule.reminders && schedule.reminders.length > 0;
                    if (hasReminders && !overwrite) return;
                    
                    // Êõ¥Êñ∞ÊèêÈÜíË®≠ÂÆö
                    schedule.reminders = [...selectedReminders];
                    updatedCount++;
                    
                    // Âª∫Á´ã LINE ÊèêÈÜí
                    createLineReminders(day, schedule);
                    reminderCount += selectedReminders.length;
                });
            });
            
            saveData();
            renderItinerary();
            closeModal('batchReminderModal');
            
            showToast(`‚úÖ Â∑≤ÁÇ∫ ${updatedCount} ÂÄãË°åÁ®ãË®≠ÂÆöÊèêÈÜíÔºÅ`, 'success');
        }
        
        // ============================================
        // Ë®òÂ∏≥ & Ë≥ºÁâ©
        // ============================================
        function updateExpenseFilterOptions() {
            const select = document.getElementById('expenseFilterDate');
            select.innerHTML = '<option value="all">ÂÖ®ÈÉ®Êó•Êúü</option>' + appData.days.map(d => `<option value="${d.date}">${d.title}</option>`).join('');
        }
        
        function renderExpenses() {
            const filter = document.getElementById('expenseFilterDate').value;
            let filtered = filter === 'all' ? appData.expenses : appData.expenses.filter(e => e.date === filter);
            
            // Ë®àÁÆóÁ∏ΩËä±Ë≤ªÔºàËΩâÊèõÁÇ∫Âè∞Âπ£Ôºâ
            let totalTWD = 0;
            let totalForeign = 0;
            const mainCurrency = appData.trip.mainCurrency || 'JPY';
            
            // ÊåâÊîØ‰ªòÊñπÂºèÁµ±Ë®à
            const paymentStats = {};
            
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = e.amount * rate;
                totalTWD += twdAmount;
                if (e.currency === mainCurrency) {
                    totalForeign += e.amount;
                }
                // ÊîØ‰ªòÊñπÂºèÁµ±Ë®à
                if (!paymentStats[e.payment]) paymentStats[e.payment] = 0;
                paymentStats[e.payment] += twdAmount;
            });
            
            const currencyInfo = EXCHANGE_RATES[mainCurrency] || { symbol: '$', flag: 'üí∞', name: 'Â§ñÂπ£' };
            document.getElementById('expenseJPY').textContent = currencyInfo.symbol + totalForeign.toLocaleString();
            document.getElementById('expenseForeignLabel').textContent = currencyInfo.name;
            document.getElementById('expenseTWD').textContent = 'NT$' + Math.round(totalTWD).toLocaleString();
            document.getElementById('expenseCount').textContent = appData.expenses.length;
            document.getElementById('statExpenseJPY').textContent = currencyInfo.symbol + totalForeign.toLocaleString();
            document.getElementById('statExpenseTWD').textContent = 'NT$' + Math.round(totalTWD).toLocaleString();
            
            // È°ØÁ§∫ÊîØ‰ªòÊñπÂºèÁµ±Ë®à
            const paymentSummary = document.getElementById('paymentSummary');
            const paymentBreakdown = document.getElementById('paymentBreakdown');
            if (Object.keys(paymentStats).length > 0) {
                paymentSummary.style.display = 'block';
                paymentBreakdown.innerHTML = Object.entries(paymentStats)
                    .sort((a, b) => b[1] - a[1])
                    .map(([method, amount]) => `
                        <div style="background:var(--bg-dark);padding:6px 10px;border-radius:8px;font-size:0.8em;">
                            ${getPaymentIcon(method)} ${method}: <span style="color:var(--emerald);">NT$${Math.round(amount).toLocaleString()}</span>
                        </div>
                    `).join('');
            } else {
                paymentSummary.style.display = 'none';
            }
            
            const container = document.getElementById('expenseList');
            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">üí∞</div><div>Â∞öÁÑ°Ëä±Ë≤ªÁ¥ÄÈåÑ</div></div>';
                return;
            }
            container.innerHTML = filtered.slice().reverse().map(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = Math.round(e.amount * rate);
                const paidByInfo = e.paidBy && e.paidBy !== 'Êàë' ? `<span style="color:var(--cyan);margin-left:6px;">üí≥${e.paidBy}Â¢ä</span>` : '';
                const splitInfo = e.splitWith && e.splitWith.length > 0 && e.splitWith.length < (appData.members?.length || 1) 
                    ? `<span style="color:var(--text-dim);font-size:0.75em;"> ‚Ä¢ ${e.splitWith.length}‰∫∫ÂàÜ</span>` : '';
                return `
                <div class="expense-item">
                    <div class="expense-info">
                        <div class="expense-category">${getCategoryEmoji(e.category)} ${e.category}${paidByInfo}</div>
                        <div class="expense-name">${e.item}${splitInfo}</div>
                        <div class="expense-meta">${getPaymentIcon(e.payment)} ${e.payment}</div>
                    </div>
                    <div style="text-align:right;">
                        <div class="expense-amount">${getCurrencySymbol(e.currency)}${e.amount.toLocaleString()}</div>
                        <div style="font-size:0.7em;color:var(--text-muted);">‚âà NT$${twdAmount.toLocaleString()}</div>
                    </div>
                    <div class="expense-delete" onclick="deleteExpense(${e.id})">üóëÔ∏è</div>
                </div>
            `}).join('');
            
            // Êõ¥Êñ∞È†êÁÆóÂúìÁí∞
            updateBudgetRing();
            
            // Êõ¥Êñ∞ÂàÜÂ∏≥ÁµêÁÆó
            renderSplitSummary();
        }
        
        function getPaymentIcon(payment) {
            if (payment.includes('ÁèæÈáë')) return 'üíµ';
            if (payment.includes('‰ø°Áî®Âç°') || payment.includes('Á∞ΩÂ∏≥')) return 'üí≥';
            if (payment.includes('Pay') || payment.includes('ÊîØ‰ªò') || payment.includes('ÂæÆ‰ø°')) return 'üì±';
            if (payment.includes('Suica') || payment.includes('ÊÇ†ÈÅä') || payment.includes('T-money') || payment.includes('ÂÖ´ÈÅîÈÄö')) return 'üöÉ';
            return 'üìå';
        }
        
        // ============================================
        // üí∞ È†êÁÆóÂÆàË≠∑Áí∞ÂäüËÉΩ
        // ============================================
        function updateBudgetRing() {
            const budget = appData.budget || 0;
            let totalSpent = 0;
            
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                totalSpent += e.amount * rate;
            });
            
            totalSpent = Math.round(totalSpent);
            const remain = budget - totalSpent;
            const percent = budget > 0 ? Math.min((totalSpent / budget) * 100, 100) : 0;
            
            // Êõ¥Êñ∞ÂúìÁí∞
            const ring = document.getElementById('budgetRingProgress');
            const circumference = 2 * Math.PI * 42; // r=42
            const offset = circumference - (percent / 100) * circumference;
            ring.style.strokeDashoffset = offset;
            
            // Ê†πÊìöÁôæÂàÜÊØîËÆäËâ≤
            ring.classList.remove('warning', 'danger');
            if (percent >= 90) ring.classList.add('danger');
            else if (percent >= 70) ring.classList.add('warning');
            
            // Êõ¥Êñ∞ÊñáÂ≠ó
            document.getElementById('budgetPercent').textContent = Math.round(percent) + '%';
            document.getElementById('budgetTotal').textContent = 'NT$' + budget.toLocaleString();
            document.getElementById('budgetSpent').textContent = 'NT$' + totalSpent.toLocaleString();
            
            const remainEl = document.getElementById('budgetRemain');
            if (remain >= 0) {
                remainEl.textContent = 'NT$' + remain.toLocaleString();
                remainEl.className = 'budget-value remain';
            } else {
                remainEl.textContent = '-NT$' + Math.abs(remain).toLocaleString();
                remainEl.className = 'budget-value over';
            }
        }
        
        function showBudgetModal() {
            document.getElementById('budgetAmount').value = appData.budget || '';
            showModal('budgetModal');
        }
        
        function saveBudget() {
            const amount = parseInt(document.getElementById('budgetAmount').value) || 0;
            appData.budget = amount;
            saveData();
            updateBudgetRing();
            closeModal('budgetModal');
            showToast('È†êÁÆóË®≠ÂÆöÂÆåÊàêÔºÅ', 'success');
        }
        
        // ============================================
        // üó∫Ô∏è ‰∏ÄÈçµÂ∞éËà™ÂäüËÉΩ
        // ============================================
        function openMap(location) {
            if (!location) return;
            const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
            // ‰ΩøÁî® <a> Ê®ôÁ±§ÊñπÂºèÈñãÂïüÔºåÂú® PWA Ê®°Âºè‰∏ãÊõ¥ÂèØÈù†
            const a = document.createElement('a');
            a.href = url;
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
        
        // ============================================
        // üì∏ ÊØèÊó•Â∞ÅÈù¢ÁÖßÁâáÂäüËÉΩ
        // ============================================
        let currentPhotoDay = null;
        let selectedPhotoData = null;
        
        function showPhotoModal(dayDate) {
            currentPhotoDay = dayDate;
            selectedPhotoData = appData.dayCovers?.[dayDate] || null;
            
            const preview = document.getElementById('photoPreview');
            if (selectedPhotoData) {
                preview.innerHTML = `<img src="${selectedPhotoData}" style="width:100%;height:100%;object-fit:cover;">`;
            } else {
                preview.innerHTML = `<div style="text-align:center;color:var(--text-dim);"><div style="font-size:2em;">üì∑</div><div>ÈªûÊìäÈÅ∏ÊìáÁÖßÁâá</div></div>`;
            }
            
            showModal('photoModal');
        }
        
        function handlePhotoSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Â£ìÁ∏ÆÁÖßÁâá
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const maxWidth = 800;
                    const maxHeight = 450;
                    let { width, height } = img;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (width * maxHeight) / height;
                        height = maxHeight;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    selectedPhotoData = canvas.toDataURL('image/jpeg', 0.7);
                    document.getElementById('photoPreview').innerHTML = `<img src="${selectedPhotoData}" style="width:100%;height:100%;object-fit:cover;">`;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function saveDayCover() {
            if (!currentPhotoDay) return;
            if (!appData.dayCovers) appData.dayCovers = {};
            
            if (selectedPhotoData) {
                appData.dayCovers[currentPhotoDay] = selectedPhotoData;
            }
            
            saveData();
            renderDays();
            closeModal('photoModal');
            showToast('Â∞ÅÈù¢ÁÖßÁâáÂ∑≤ÂÑ≤Â≠òÔºÅ', 'success');
        }
        
        function removeDayCover() {
            if (!currentPhotoDay) return;
            if (appData.dayCovers?.[currentPhotoDay]) {
                delete appData.dayCovers[currentPhotoDay];
                saveData();
                renderDays();
            }
            closeModal('photoModal');
            showToast('Â∞ÅÈù¢ÁÖßÁâáÂ∑≤ÁßªÈô§', 'success');
        }
        
        // ============================================
        // ‚úçÔ∏è ÊØèÊó•ÊóÖÈÅäÈªûÊª¥ÂäüËÉΩ
        // ============================================
        function showDailyNotesModal(dayDate, dayTitle) {
            document.getElementById('currentNoteDate').value = dayDate;
            document.getElementById('currentNoteDayTitle').value = dayTitle;
            document.getElementById('notesModalDayTitle').textContent = dayTitle;
            document.getElementById('notesModalDayDate').textContent = formatDate(new Date(dayDate));
            document.getElementById('noteContent').value = '';
            document.getElementById('selectedMood').value = 'üòä';
            
            // ÈáçË®≠ÂøÉÊÉÖÈÅ∏Êìá
            document.querySelectorAll('.mood-option').forEach(m => m.classList.remove('selected'));
            document.querySelector('.mood-option[data-mood="üòä"]').classList.add('selected');
            
            renderDailyNotes(dayDate);
            showModal('dailyNotesModal');
        }
        
        function selectMood(el) {
            document.querySelectorAll('.mood-option').forEach(m => m.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('selectedMood').value = el.dataset.mood;
        }
        
        function renderDailyNotes(dayDate) {
            const container = document.getElementById('dailyNotesList');
            if (!appData.dailyNotes) appData.dailyNotes = {};
            const notes = appData.dailyNotes[dayDate] || [];
            
            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="note-empty">
                        <div class="icon">üìù</div>
                        <div>ÈÇÑÊ≤íÊúâ‰ªª‰ΩïÈªûÊª¥Ë®òÈåÑ</div>
                        <div style="font-size:0.85em;margin-top:5px;color:var(--text-muted);">ÂØ´‰∏ã‰ªäÂ§©ÁöÑÊóÖÈÅäÂøÉÊÉÖÂêßÔºÅ</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = notes.map(note => `
                <div class="note-item">
                    <button class="note-delete" onclick="deleteDailyNote('${dayDate}', ${note.id})" title="Âà™Èô§">üóëÔ∏è</button>
                    <div class="note-header">
                        <span class="note-time">üïê ${note.time}</span>
                        <span class="note-mood">${note.mood}</span>
                    </div>
                    <div class="note-content">${escapeHtml(note.content)}</div>
                </div>
            `).join('');
        }
        
        function addDailyNote() {
            const dayDate = document.getElementById('currentNoteDate').value;
            const content = document.getElementById('noteContent').value.trim();
            const mood = document.getElementById('selectedMood').value;
            
            if (!content) {
                showToast('Ë´ãËº∏ÂÖ•ÂøÉÂæóÂÖßÂÆπ', 'error');
                return;
            }
            
            if (!appData.dailyNotes) appData.dailyNotes = {};
            if (!appData.dailyNotes[dayDate]) appData.dailyNotes[dayDate] = [];
            
            const now = new Date();
            const note = {
                id: Date.now(),
                time: now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' }),
                mood: mood,
                content: content
            };
            
            appData.dailyNotes[dayDate].push(note);
            saveData();
            
            document.getElementById('noteContent').value = '';
            renderDailyNotes(dayDate);
            renderDays();
            showToast('ÊóÖÈÅäÈªûÊª¥Â∑≤Ë®òÈåÑ ‚ú®', 'success');
        }
        
        function deleteDailyNote(dayDate, noteId) {
            if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂâáÈªûÊª¥ÂóéÔºü')) return;
            
            if (appData.dailyNotes?.[dayDate]) {
                appData.dailyNotes[dayDate] = appData.dailyNotes[dayDate].filter(n => n.id !== noteId);
                if (appData.dailyNotes[dayDate].length === 0) {
                    delete appData.dailyNotes[dayDate];
                }
                saveData();
                renderDailyNotes(dayDate);
                renderDays();
                showToast('ÈªûÊª¥Â∑≤Âà™Èô§', 'success');
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // ============================================
        // üìù ÂåØÂá∫ Google DocÔºàÊóÖÈÅäÁ¥ÄÈåÑÔºâ
        // ============================================
        async function exportToGoogleDoc() {
            console.log('exportToGoogleDoc ÈñãÂßãÂü∑Ë°å');
            
            if (!appData.trip.name && !appData.trip.destination) {
                showToast('Ë´ãÂÖàË®≠ÂÆöÊóÖÈÅäË≥áË®ä', 'error');
                return;
            }
            
            // Ê™¢Êü• Google ÊéàÊ¨ä
            const token = getStoredToken();
            console.log('Token ÁãÄÊÖã:', token ? 'ÊúâÊïà' : 'ÁÑ°Êïà');
            
            if (!token) {
                showToast('Ë´ãÂÖàÊéàÊ¨ä Google Â∏≥ËôüÔºàÂê´ Drive Ê¨äÈôêÔºâ', 'error');
                closeModal('exportModal');
                return;
            }
            
            showToast('Ê≠£Âú®Âª∫Á´ã Google Doc...', 'success');
            closeModal('exportModal');
            
            try {
                const result = await exportTripToGoogleDoc();
                const trip = appData.trip;
                const docTitle = `${trip.name || trip.destination + '‰πãÊóÖ'} - ÊóÖÈÅäÁ¥ÄÈåÑ`;
                const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                
                // È°ØÁ§∫ÈÄ£Áµê ModalÔºàÊâãÊ©üÂèãÂ•ΩÔºâ
                showDocLinkModal(docTitle, docUrl);
                
            } catch (error) {
                console.error('Âª∫Á´ã Google Doc Â§±Êïó:', error);
                showToast('Âª∫Á´ãÂ§±ÊïóÔºö' + error.message, 'error');
                
                // Â¶ÇÊûúÊòØÊéàÊ¨äÂïèÈ°åÔºåÊèêÁ§∫ÈáçÊñ∞ÊéàÊ¨ä
                if (error.message.includes('401') || error.message.includes('auth')) {
                    localStorage.removeItem(TOKEN_KEY);
                    showToast('Ë´ãÈáçÊñ∞ÊéàÊ¨ä Google Â∏≥Ëôü', 'error');
                }
            }
        }
        
        // üìù È°ØÁ§∫ Google Doc ÈÄ£Áµê ModalÔºàÊâãÊ©üÂèãÂ•ΩÔºâ
        let pendingClearTrip = false;
        
        function showDocLinkModal(title, url, afterClear = false) {
            document.getElementById('docLinkTitle').textContent = title;
            const linkEl = document.getElementById('docLinkUrl');
            linkEl.href = url;
            
            // Ê†πÊìöÊòØÂê¶ÁÇ∫Ê∏ÖÈô§ÊµÅÁ®ãÈ°ØÁ§∫‰∏çÂêåÊåâÈàï
            const actionsEl = document.getElementById('docLinkActions');
            if (afterClear) {
                pendingClearTrip = true;
                actionsEl.innerHTML = `
                    <button class="btn btn-danger" style="width:100%;margin-bottom:10px;" onclick="closeDocLinkAndClear()">
                        üóëÔ∏è ÁπºÁ∫åÊ∏ÖÈô§ÊóÖË°åË≥áÊñô
                    </button>
                    <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">
                        ÂèñÊ∂àÔºà‰øùÁïôË≥áÊñôÔºâ
                    </button>
                `;
            } else {
                pendingClearTrip = false;
                actionsEl.innerHTML = `
                    <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">ÈóúÈñâ</button>
                `;
            }
            
            showModal('docLinkModal');
            showToast('‚úÖ Google Doc Âª∫Á´ãÊàêÂäüÔºÅ', 'success');
        }
        
        function closeDocLinkModal() {
            pendingClearTrip = false;
            closeModal('docLinkModal');
        }
        
        function closeDocLinkAndClear() {
            closeModal('docLinkModal');
            // Áõ¥Êé•Âü∑Ë°åÊ∏ÖÈô§Ôºå‰∏çÂÜçË©¢Âïè
            doResetTrip();
        }
        
        // ============================================
        // üë• ÊóÖ‰º¥ÁÆ°ÁêÜËàáÂàÜÂ∏≥ÂäüËÉΩ
        // ============================================
        function renderMembers() {
            const container = document.getElementById('membersList');
            if (!container) return;
            if (!appData.members) appData.members = ['Êàë'];
            
            container.innerHTML = appData.members.map((m, i) => `
                <span class="member-tag ${i === 0 ? 'me' : ''}">
                    üë§ ${m}
                    ${i > 0 ? `<span class="remove" onclick="removeMember(${i})">‚úï</span>` : ''}
                </span>
            `).join('');
        }
        
        function addMember() {
            const input = document.getElementById('newMemberName');
            const name = input.value.trim();
            if (!name) { showToast('Ë´ãËº∏ÂÖ•ÊóÖ‰º¥ÂêçÁ®±', 'error'); return; }
            if (appData.members.includes(name)) { showToast('Ê≠§ÂêçÁ®±Â∑≤Â≠òÂú®', 'error'); return; }
            
            appData.members.push(name);
            saveData();
            renderMembers();
            input.value = '';
            showToast(`Â∑≤Êñ∞Â¢ûÊóÖ‰º¥Ôºö${name}`, 'success');
        }
        
        function removeMember(index) {
            if (index === 0) return; // ‰∏çËÉΩÁßªÈô§„ÄåÊàë„Äç
            const name = appData.members[index];
            if (!confirm(`Á¢∫ÂÆöÁßªÈô§ÊóÖ‰º¥„Äå${name}„ÄçÔºü\nÁõ∏ÈóúÁöÑÂàÜÂ∏≥Ë®òÈåÑÂ∞á‰øùÁïô„ÄÇ`)) return;
            
            appData.members.splice(index, 1);
            saveData();
            renderMembers();
            showToast(`Â∑≤ÁßªÈô§ÊóÖ‰º¥Ôºö${name}`, 'success');
        }
        
        function updateSplitOptions() {
            // Êõ¥Êñ∞Â¢ä‰ªò‰∫∫ÈÅ∏ÂñÆ
            const paidBySelect = document.getElementById('expensePaidBy');
            paidBySelect.innerHTML = appData.members.map(m => `<option value="${m}">${m}</option>`).join('');
            
            // Êõ¥Êñ∞ÂàÜÊî§Â∞çË±° checkbox
            const container = document.getElementById('splitWithCheckboxes');
            container.innerHTML = appData.members.map(m => `
                <label class="split-checkbox checked" onclick="toggleSplitCheckbox(this)">
                    <span class="check">‚úì</span>
                    <span>${m}</span>
                    <input type="checkbox" value="${m}" checked>
                </label>
            `).join('');
        }
        
        function toggleSplitCheckbox(el) {
            el.classList.toggle('checked');
            el.querySelector('input').checked = el.classList.contains('checked');
        }
        
        function calculateSplit() {
            const members = appData.members || ['Êàë'];
            const result = {};
            
            // ÂàùÂßãÂåñÊØèÂÄã‰∫∫ÁöÑÊï∏Êìö
            members.forEach(m => {
                result[m] = { paid: 0, shouldPay: 0, balance: 0 };
            });
            
            // Ë®àÁÆóÊØèÁ≠ÜÊ∂àË≤ª
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = e.amount * rate;
                const paidBy = e.paidBy || 'Êàë';
                const splitWith = e.splitWith || members;
                
                // Â¢ä‰ªò‰∫∫Â¢ûÂä† paid
                if (result[paidBy]) {
                    result[paidBy].paid += twdAmount;
                }
                
                // ÂàÜÊî§ÈáëÈ°ç
                const splitCount = splitWith.length || 1;
                const perPerson = twdAmount / splitCount;
                
                splitWith.forEach(person => {
                    if (result[person]) {
                        result[person].shouldPay += perPerson;
                    }
                });
            });
            
            // Ë®àÁÆóÈ§òÈ°çÔºàpaid - shouldPay = ÊáâÊî∂/Êáâ‰ªòÔºâ
            members.forEach(m => {
                result[m].balance = result[m].paid - result[m].shouldPay;
            });
            
            return result;
        }
        
        function renderSplitSummary() {
            const card = document.getElementById('splitSummaryCard');
            const container = document.getElementById('splitSummary');
            
            if (!appData.members || appData.members.length <= 1 || appData.expenses.length === 0) {
                card.style.display = 'none';
                return;
            }
            
            const splitData = calculateSplit();
            const members = Object.keys(splitData);
            
            // Ë®àÁÆóËΩâÂ∏≥Âª∫Ë≠∞
            const debtors = []; // Êáâ‰ªòÁöÑ‰∫∫
            const creditors = []; // ÊáâÊî∂ÁöÑ‰∫∫
            
            members.forEach(m => {
                const balance = Math.round(splitData[m].balance);
                if (balance < -10) { // Ê¨†Èå¢
                    debtors.push({ name: m, amount: Math.abs(balance) });
                } else if (balance > 10) { // Ë©≤Êî∂Èå¢
                    creditors.push({ name: m, amount: balance });
                }
            });
            
            // ÁîüÊàêËΩâÂ∏≥Âª∫Ë≠∞
            const transactions = [];
            debtors.sort((a, b) => b.amount - a.amount);
            creditors.sort((a, b) => b.amount - a.amount);
            
            let di = 0, ci = 0;
            while (di < debtors.length && ci < creditors.length) {
                const debtor = debtors[di];
                const creditor = creditors[ci];
                const amount = Math.min(debtor.amount, creditor.amount);
                
                if (amount > 10) {
                    transactions.push({ from: debtor.name, to: creditor.name, amount: Math.round(amount) });
                }
                
                debtor.amount -= amount;
                creditor.amount -= amount;
                
                if (debtor.amount < 10) di++;
                if (creditor.amount < 10) ci++;
            }
            
            // Ê∏≤ÊüìÁµêÊûú
            card.style.display = 'block';
            container.innerHTML = `
                ${members.map(m => {
                    const data = splitData[m];
                    const balance = Math.round(data.balance);
                    return `
                        <div class="split-person">
                            <div class="split-person-header">
                                <span class="split-person-name">üë§ ${m}</span>
                                <div class="split-person-stats">
                                    <div class="split-stat">
                                        <span class="split-stat-label">Â∑≤Â¢ä‰ªò</span>
                                        <span class="split-stat-value paid">NT$${Math.round(data.paid).toLocaleString()}</span>
                                    </div>
                                    <div class="split-stat">
                                        <span class="split-stat-label">ÊáâÂàÜÊî§</span>
                                        <span class="split-stat-value owe">NT$${Math.round(data.shouldPay).toLocaleString()}</span>
                                    </div>
                                    <div class="split-stat">
                                        <span class="split-stat-label">${balance >= 0 ? 'ÊáâÊî∂' : 'Êáâ‰ªò'}</span>
                                        <span class="split-stat-value ${balance >= 0 ? 'receive' : 'owe'}">${balance >= 0 ? '+' : '-'}NT$${Math.abs(balance).toLocaleString()}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('')}
                
                ${transactions.length > 0 ? `
                    <div class="split-transactions">
                        <div style="font-size:0.85em;color:var(--emerald);margin-bottom:10px;">üí∏ Âª∫Ë≠∞ËΩâÂ∏≥ÊñπÂºè</div>
                        ${transactions.map(tx => `
                            <div class="split-tx">
                                <span>üë§ ${tx.from}</span>
                                <span class="split-tx-arrow">‚Üí</span>
                                <span>üë§ ${tx.to}</span>
                                <span class="split-tx-amount">NT$${tx.amount.toLocaleString()}</span>
                            </div>
                        `).join('')}
                    </div>
                ` : '<div style="text-align:center;color:var(--emerald);padding:10px;">‚úÖ Â§™Ê£í‰∫ÜÔºÅÂ§ßÂÆ∂Â∑≤Á∂ìÁµêÊ∏Ö‰∫ÜÔºÅ</div>'}
            `;
        }
        
        function showAddExpenseModal() {
            const select = document.getElementById('expenseDay');
            select.innerHTML = appData.days.map(d => `<option value="${d.date}">${d.title}</option>`).join('');
            document.getElementById('expenseItem').value = '';
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseNote').value = '';
            updateSplitOptions(); // Êõ¥Êñ∞ÂàÜÂ∏≥ÈÅ∏È†Ö
            showModal('expenseModal');
        }
        
        function saveExpense() {
            const date = document.getElementById('expenseDay').value;
            const category = document.getElementById('expenseCategory').value;
            const item = document.getElementById('expenseItem').value;
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const currency = document.getElementById('expenseCurrency').value;
            const payment = document.getElementById('expensePayment').value;
            
            // üë• ÂàÜÂ∏≥Ë≥áË®ä
            const paidBy = document.getElementById('expensePaidBy').value || 'Êàë';
            const splitWithChecks = document.querySelectorAll('#splitWithCheckboxes .split-checkbox.checked input');
            const splitWith = Array.from(splitWithChecks).map(c => c.value);
            
            if (!item || !amount) { showToast('Ë´ãÂ°´ÂØ´È†ÖÁõÆÂíåÈáëÈ°ç', 'error'); return; }
            if (splitWith.length === 0) { showToast('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏Ä‰ΩçÂàÜÊî§Â∞çË±°', 'error'); return; }
            
            appData.expenses.push({ id: Date.now(), date, category, item, amount, currency, payment, paidBy, splitWith });
            saveData();
            renderExpenses();
            closeModal('expenseModal');
            showToast('Â∑≤Ë®òÈåÑ', 'success');
        }
        
        function deleteExpense(id) {
            if (!confirm('Á¢∫ÂÆöÂà™Èô§Ôºü')) return;
            appData.expenses = appData.expenses.filter(e => e.id !== id);
            saveData();
            renderExpenses();
        }
        
        function renderShopping() {
            const total = appData.shopping.length;
            const bought = appData.shopping.filter(s => s.bought).length;
            const progress = total > 0 ? Math.round((bought / total) * 100) : 0;
            document.getElementById('shoppingProgress').textContent = progress + '%';
            document.getElementById('shoppingProgressBar').style.width = progress + '%';
            
            const container = document.getElementById('shoppingList');
            if (total === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">üõí</div><div>Ë≥ºÁâ©Ê∏ÖÂñÆÊòØÁ©∫ÁöÑ</div></div>';
                return;
            }
            const sorted = [...appData.shopping].sort((a, b) => {
                if (a.bought !== b.bought) return a.bought ? 1 : -1;
                const p = { high: 0, medium: 1, low: 2 };
                return p[a.priority] - p[b.priority];
            });
            container.innerHTML = sorted.map(s => `
                <div class="shop-item ${s.bought ? 'bought' : ''}" onclick="toggleShopping(${s.id})">
                    <div class="shop-checkbox">${s.bought ? '‚úì' : ''}</div>
                    <div class="shop-info">
                        <div class="shop-name">${s.item}</div>
                        <div class="shop-meta">${s.budget ? '¬•' + s.budget.toLocaleString() : ''}${s.store ? ' ‚Ä¢ ' + s.store : ''}</div>
                    </div>
                    <span class="shop-priority ${s.priority}">${{ high: 'ÂøÖË≤∑', medium: 'ÊÉ≥Ë≤∑', low: 'Èö®ÊÑè' }[s.priority]}</span>
                </div>
            `).join('');
        }
        
        function showAddShoppingModal() {
            document.getElementById('shopItem').value = '';
            document.getElementById('shopBudget').value = '';
            showModal('shoppingModal');
        }
        
        function saveShopping() {
            const item = document.getElementById('shopItem').value;
            const budget = parseFloat(document.getElementById('shopBudget').value) || 0;
            const priority = document.getElementById('shopPriority').value;
            const store = document.getElementById('shopStore').value;
            if (!item) { showToast('Ë´ãËº∏ÂÖ•ÂïÜÂìÅÂêçÁ®±', 'error'); return; }
            appData.shopping.push({ id: Date.now(), item, budget, priority, store, bought: false });
            saveData();
            renderShopping();
            closeModal('shoppingModal');
            showToast('Â∑≤Âä†ÂÖ•', 'success');
        }
        
        function toggleShopping(id) {
            const item = appData.shopping.find(s => s.id === id);
            if (item) { item.bought = !item.bought; saveData(); renderShopping(); }
        }
        
        // ============================================
        // ÂåØÂá∫ & ÂÑ≤Â≠ò
        // ============================================
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet([['ÊóÖÈÅäÂêçÁ®±', appData.trip.name], ['ÁõÆÁöÑÂú∞', appData.trip.destination], ['Êó•Êúü', appData.trip.startDate + ' ~ ' + appData.trip.endDate]]), 'ÊóÖÈÅäË≥áË®ä');
            const scheduleData = [['Êó•Êúü', 'ÊôÇÈñì', 'Ê¥ªÂãï', 'È°ûÂûã', 'Âú∞Èªû']];
            appData.days.forEach(d => d.schedules.forEach(s => scheduleData.push([d.date, s.startTime + '-' + s.endTime, s.title, s.type, s.location])));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(scheduleData), 'Ë°åÁ®ã');
            const expenseData = [['Êó•Êúü', 'È°ûÂà•', 'È†ÖÁõÆ', 'ÈáëÈ°ç', 'Âπ£Âà•']];
            appData.expenses.forEach(e => expenseData.push([e.date, e.category, e.item, e.amount, e.currency]));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(expenseData), 'Ëä±Ë≤ª');
            XLSX.writeFile(wb, (appData.trip.name || 'ÊóÖÈÅäË¶èÂäÉ') + '.xlsx');
            closeModal('exportModal');
            showToast('‚úÖ Â∑≤‰∏ãËºâ', 'success');
        }
        
        function saveData() {
            if (!appData.settings.storageEnabled) return;
            try { localStorage.setItem(STORAGE_KEY, JSON.stringify(appData)); } catch (e) {}
        }
        
        function loadData() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) appData = { ...appData, ...JSON.parse(saved) };
            } catch (e) {}
        }
        
        function saveSettings() {
            appData.settings.googleClientId = document.getElementById('googleClientId').value;
            appData.settings.lineToken = document.getElementById('lineToken').value;
            appData.settings.lineUserId = document.getElementById('lineUserId').value;
            appData.settings.gasUrl = document.getElementById('gasUrl').value;
            appData.settings.gasSecret = document.getElementById('gasSecret').value;
            saveData();
        }
        
        function toggleStorage() {
            const toggle = document.getElementById('storageToggle');
            toggle.classList.toggle('active');
            appData.settings.storageEnabled = toggle.classList.contains('active');
            if (appData.settings.storageEnabled) saveData();
            showToast(appData.settings.storageEnabled ? '‚úÖ Â∑≤ÂïüÁî®ÂÑ≤Â≠ò' : '‚ö†Ô∏è Â∑≤ÂÅúÁî®ÂÑ≤Â≠ò', 'success');
        }
        
        function clearAllData() {
            if (!confirm('Á¢∫ÂÆöÊ∏ÖÈô§ÊâÄÊúâË≥áÊñôÔºü')) return;
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem(TOKEN_KEY);
            location.reload();
        }
        
        function renderAll() {
            document.getElementById('tripName').value = appData.trip.name || '';
            document.getElementById('destination').value = appData.trip.customDestination ? 'custom' : (appData.trip.destination || '');
            if (appData.trip.customDestination) {
                document.getElementById('customDestGroup').style.display = 'block';
                document.getElementById('customDestination').value = appData.trip.customDestination;
            }
            document.getElementById('startDate').value = appData.trip.startDate || '';
            document.getElementById('endDate').value = appData.trip.endDate || '';
            document.getElementById('mainCurrency').value = appData.trip.mainCurrency || 'JPY';
            document.getElementById('googleClientId').value = appData.settings.googleClientId || '';
            document.getElementById('lineToken').value = appData.settings.lineToken || '';
            document.getElementById('lineUserId').value = appData.settings.lineUserId || '';
            document.getElementById('gasUrl').value = appData.settings.gasUrl || '';
            document.getElementById('gasSecret').value = appData.settings.gasSecret || '';
            if (appData.settings.storageEnabled) document.getElementById('storageToggle').classList.add('active');
            updateTripInfo();
            renderItinerary();
            renderExpenses();
            renderShopping();
            renderMembers(); // üë• Ê∏≤ÊüìÊóÖ‰º¥ÂàóË°®
            renderCheckinPage(); // üì∏ Ê∏≤ÊüìÊâìÂç°È†ÅÈù¢
        }
        
        // ============================================
        // UI ËºîÂä©
        // ============================================
        function showModal(id) { document.getElementById(id).classList.add('show'); }
        function closeModal(id) { document.getElementById(id).classList.remove('show'); }
        function toggleReminder(el) { el.classList.toggle('checked'); }
        function toggleVisibility(id) { const el = document.getElementById(id); el.type = el.type === 'password' ? 'text' : 'password'; }
        function showToast(msg, type = 'info') { const t = document.getElementById('toast'); t.textContent = msg; t.className = 'toast show ' + type; setTimeout(() => t.classList.remove('show'), 3000); }
        function formatDate(d) { const w = ['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠']; return `${d.getMonth()+1}/${d.getDate()} (${w[d.getDay()]})`; }
        function getTypeEmoji(t) { return { 'ÊôØÈªû': 'üèõÔ∏è', 'ÁæéÈ£ü': 'üçú', '‰∫§ÈÄö': 'üöÉ', '‰ΩèÂÆø': 'üè®', 'Ë≥ºÁâ©': 'üõçÔ∏è', 'ÂÖ∂‰ªñ': 'üìå' }[t] || 'üìå'; }
        function getCategoryEmoji(c) { return { 'È£≤È£ü': 'üçú', '‰∫§ÈÄö': 'üöÉ', '‰ΩèÂÆø': 'üè®', 'Ë≥ºÁâ©': 'üõçÔ∏è', 'ÈñÄÁ•®': 'üé´', 'ÂÖ∂‰ªñ': 'üìå' }[c] || 'üìå'; }
        function getCurrencySymbol(c) { 
            const symbols = { 
                'JPY': '¬•', 'KRW': '‚Ç©', 'THB': '‡∏ø', 'USD': '$', 'TWD': 'NT$',
                'EUR': '‚Ç¨', 'GBP': '¬£', 'HKD': 'HK$', 'SGD': 'S$', 'MYR': 'RM',
                'VND': '‚Ç´', 'PHP': '‚Ç±', 'IDR': 'Rp', 'AUD': 'A$', 'NZD': 'NZ$',
                'CNY': '¬•', 'CHF': 'CHF', 'CZK': 'Kƒç', 'MOP': 'MOP$', 'CAD': 'C$',
                'MXN': 'MX$', 'ZAR': 'R', 'EGP': 'E¬£', 'MAD': 'MAD', 'KES': 'KSh'
            };
            return symbols[c] || ''; 
        }
        
        document.querySelectorAll('.modal-overlay').forEach(o => o.addEventListener('click', function(e) { if (e.target === this) this.classList.remove('show'); }));
        
        // ============================================
        // üì∏ ÊôØÈªûÊâìÂç°ÂäüËÉΩ
        // ============================================
        function switchCheckinTab(tab) {
            document.querySelectorAll('.checkin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.checkin-section').forEach(s => s.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('checkinSection' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            
            if (tab === 'memoir') renderMemoir();
            if (tab === 'badges') renderBadges();
        }
        
        function renderCheckinPage() {
            if (!appData.spots) appData.spots = [];
            if (!appData.checkins) appData.checkins = [];
            if (!appData.badges) appData.badges = {};
            
            // Êõ¥Êñ∞Áµ±Ë®à
            document.getElementById('checkinPhotoCount').textContent = appData.checkins.length;
            const checked = appData.spots.filter(s => s.checked).length;
            document.getElementById('checkinSpotCount').textContent = `${checked}/${appData.spots.length}`;
            document.getElementById('checkinBadgeCount').textContent = Object.keys(appData.badges).length;
            
            renderSpots();
            renderCheckinPhotos();
            renderBadges();
        }
        
        // üìç ÊôØÈªûÁÆ°ÁêÜ
        function showAddSpotModal() {
            document.getElementById('newSpotName').value = '';
            document.getElementById('newSpotNote').value = '';
            showModal('spotModal');
        }
        
        function addSpot() {
            const name = document.getElementById('newSpotName').value.trim();
            const type = document.getElementById('newSpotType').value;
            const note = document.getElementById('newSpotNote').value.trim();
            
            if (!name) { showToast('Ë´ãËº∏ÂÖ•ÊôØÈªûÂêçÁ®±', 'error'); return; }
            
            appData.spots.push({ id: Date.now(), name, type, note, checked: false, checkedAt: null });
            saveData();
            renderCheckinPage();
            closeModal('spotModal');
            showToast('Â∑≤Êñ∞Â¢ûÊôØÈªû üìç', 'success');
        }
        
        function toggleSpot(id) {
            const spot = appData.spots.find(s => s.id === id);
            if (spot) {
                spot.checked = !spot.checked;
                spot.checkedAt = spot.checked ? new Date().toISOString() : null;
                saveData();
                renderCheckinPage();
                checkBadges();
                if (spot.checked) showToast(`üéâ ÊâìÂç°ÊàêÂäüÔºö${spot.name}`, 'success');
            }
        }
        
        function deleteSpot(id, e) {
            e.stopPropagation();
            if (!confirm('Á¢∫ÂÆöÂà™Èô§Ê≠§ÊôØÈªûÔºü')) return;
            appData.spots = appData.spots.filter(s => s.id !== id);
            saveData();
            renderCheckinPage();
            showToast('Â∑≤Âà™Èô§ÊôØÈªû', 'success');
        }
        
        function renderSpots() {
            const container = document.getElementById('spotList');
            if (appData.spots.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-icon">üìç</div><div>ÈÇÑÊ≤íÊúâÊôØÈªû</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">Êñ∞Â¢ûÊÉ≥ÂéªÁöÑÊôØÈªûÈñãÂßãÊâìÂç°ÂêßÔºÅ</div></div>`;
                return;
            }
            container.innerHTML = appData.spots.map(spot => `
                <div class="spot-card ${spot.checked ? 'checked' : ''}" onclick="toggleSpot(${spot.id})">
                    <div class="spot-checkbox">${spot.checked ? '‚úì' : ''}</div>
                    <div class="spot-info">
                        <div class="spot-name">${getTypeEmoji(spot.type)} ${spot.name}</div>
                        <div class="spot-meta">
                            <span>${spot.type}</span>
                            ${spot.note ? `<span>‚Ä¢ ${spot.note}</span>` : ''}
                        </div>
                    </div>
                    <button class="spot-delete" onclick="deleteSpot(${spot.id}, event)">üóëÔ∏è</button>
                </div>
            `).join('');
        }
        
        // üì∏ ÊãçÁÖßÊâìÂç°
        let currentCheckinPhoto = null;
        let currentCameraMode = 'normal'; // 'normal' or 'polaroid'
        
        // ============================================
        // üì∏ ÊãçÁ´ãÂæóÁõ∏Ê©üÂäüËÉΩ
        // ============================================
        let polaroidStream = null;
        let polaroidPhotoCount = 0;
        let currentPolaroidFrame = 'white';
        let pendingPolaroidPhotos = []; // Êö´Â≠òÊãçÁ´ãÂæóÁÖßÁâá
        let currentFacingMode = 'user'; // 'user' = ÂâçÈè°È†≠(Ëá™Êãç), 'environment' = ÂæåÈè°È†≠
        
        const frameStyles = {
            'white': { class: 'frame-white', textColor: '#999' },
            'black': { class: 'frame-black', textColor: '#666' },
            'mint': { class: 'frame-mint', textColor: '#166534' },
            'pink': { class: 'frame-pink', textColor: '#9d174d' },
            'floral': { class: 'frame-floral', textColor: '#db2777' },
            'plaid': { class: 'frame-plaid', textColor: '#2563eb' },
            'gradient': { class: 'frame-gradient', textColor: '#666' }
        };
        
        function selectCameraMode(mode) {
            currentCameraMode = mode;
            document.getElementById('modeNormal').classList.toggle('active', mode === 'normal');
            document.getElementById('modePolaroid').classList.toggle('active', mode === 'polaroid');
            
            if (mode === 'polaroid') {
                closeModal('checkinModal');
                openPolaroidCamera();
            }
        }
        
        async function openPolaroidCamera() {
            const overlay = document.getElementById('polaroidOverlay');
            overlay.classList.add('show');
            pendingPolaroidPhotos = [];
            
            // Ê™¢Êü•ÊòØÂê¶ÊîØÊè¥ getUserMedia
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                showToast('ÊÇ®ÁöÑÁÄèË¶ΩÂô®‰∏çÊîØÊè¥Áõ∏Ê©üÂäüËÉΩ', 'error');
                return;
            }
            
            await startCameraWithFacing(currentFacingMode);
        }
        
        async function startCameraWithFacing(facingMode) {
            // ÂÖàÂÅúÊ≠¢ÁèæÊúâ‰∏≤ÊµÅ
            if (polaroidStream) {
                polaroidStream.getTracks().forEach(track => track.stop());
                polaroidStream = null;
            }
            
            const video = document.getElementById('polaroidVideo');
            
            try {
                polaroidStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: { ideal: facingMode },
                        width: { ideal: 640 }, 
                        height: { ideal: 480 } 
                    }, 
                    audio: false 
                });
                
                video.srcObject = polaroidStream;
                video.play().catch(e => console.log('Video play error:', e));
                
                // Ê†πÊìöÈè°È†≠ÊñπÂêëË™øÊï¥Èè°ÂÉè
                if (facingMode === 'user') {
                    video.style.transform = 'scaleX(-1)'; // Ëá™ÊãçÈè°ÂÉè
                } else {
                    video.style.transform = 'scaleX(1)'; // ÂæåÁΩÆ‰∏çÈè°ÂÉè
                }
                
                currentFacingMode = facingMode;
                const modeText = facingMode === 'user' ? 'ÂâçÈè°È†≠ÔºàËá™ÊãçÔºâ' : 'ÂæåÈè°È†≠';
                showToast(`üì∏ ${modeText}Â∑≤ÈñãÂïü`, 'success');
                
            } catch (err) {
                console.error('Áõ∏Ê©üÈåØË™§:', err);
                let errorMsg = 'ÁÑ°Ê≥ïÈñãÂïüÁõ∏Ê©ü';
                
                if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') {
                    errorMsg = 'Ë´ãÂÖÅË®±Áõ∏Ê©üÊ¨äÈôê';
                } else if (err.name === 'NotFoundError' || err.name === 'DevicesNotFoundError') {
                    errorMsg = 'Êâæ‰∏çÂà∞Áõ∏Ê©üË£ùÁΩÆ';
                } else if (err.name === 'NotReadableError' || err.name === 'TrackStartError') {
                    errorMsg = 'Áõ∏Ê©üË¢´ÂÖ∂‰ªñÊáâÁî®Á®ãÂºè‰ΩîÁî®';
                } else if (err.name === 'OverconstrainedError') {
                    errorMsg = 'Áõ∏Ê©ü‰∏çÊîØÊè¥Ê≠§Ë®≠ÂÆö';
                } else if (err.name === 'TypeError') {
                    errorMsg = 'ÈúÄË¶Å HTTPS ÊâçËÉΩ‰ΩøÁî®Áõ∏Ê©ü';
                }
                
                showToast(errorMsg, 'error');
            }
        }
        
        async function switchCamera() {
            const newFacing = currentFacingMode === 'user' ? 'environment' : 'user';
            await startCameraWithFacing(newFacing);
        }
        
        function closePolaroidCamera() {
            const overlay = document.getElementById('polaroidOverlay');
            overlay.classList.remove('show');
            
            if (polaroidStream) {
                polaroidStream.getTracks().forEach(track => track.stop());
                polaroidStream = null;
            }
            
            // Ê∏ÖÁ©∫Êï£ËêΩÁÖßÁâá
            document.getElementById('polaroidPhotosContainer').innerHTML = '';
            pendingPolaroidPhotos = [];
        }
        
        function selectPolaroidFrame(frame, element) {
            currentPolaroidFrame = frame;
            
            // Êõ¥Êñ∞ÈÅ∏‰∏≠ÁãÄÊÖã
            document.querySelectorAll('.frame-option').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            
            // Êõ¥Êñ∞Â∫ïÁâáÈ†êË¶ΩÁöÑËä±ÈÇä
            const film = document.getElementById('polaroidFilm');
            Object.values(frameStyles).forEach(s => film.classList.remove(s.class));
            film.classList.add(frameStyles[frame].class);
            document.getElementById('polaroidFilmText').style.color = frameStyles[frame].textColor;
            
            // Ë¶ñË¶∫ÂõûÈ•ãÔºöÁü≠Êö´È°ØÁ§∫Â∫ïÁâáÈ†êË¶Ω
            film.style.display = 'block';
            film.style.opacity = '1';
            film.style.transform = 'rotate(-5deg) scale(0.8) translateY(-20px)';
            film.style.transition = 'all 0.3s ease';
            
            setTimeout(() => {
                film.style.opacity = '0';
                setTimeout(() => {
                    film.style.display = 'none';
                    film.style.transition = 'none';
                    film.style.transform = '';
                    film.style.opacity = '';
                }, 300);
            }, 500);
            
            // Toast ÊèêÁ§∫
            showToast(`üé® Â∑≤ÈÅ∏Êìá„Äå${getFrameName(frame)}„ÄçËä±ÈÇä`, 'success');
        }
        
        function getFrameName(frame) {
            const names = {
                'white': 'Á∂ìÂÖ∏ÁôΩ',
                'black': 'ÂÑ™ÈõÖÈªë',
                'mint': 'ËñÑËç∑Á∂†',
                'pink': 'ÁîúÁæéÁ≤â',
                'floral': 'Âæ©Âè§Ëä±Âçâ',
                'plaid': 'ËóçËâ≤Ê†ºÁ¥ã',
                'gradient': 'ÂΩ©ËôπÊº∏Â±§'
            };
            return names[frame] || frame;
        }
        
        function takePolaroidPhoto() {
            if (!polaroidStream) {
                showToast('Ë´ãÁ≠âÂæÖÁõ∏Ê©üÈñãÂïü', 'error');
                openPolaroidCamera();
                return;
            }
            
            const video = document.getElementById('polaroidVideo');
            
            // Ê™¢Êü•Ë¶ñË®äÊòØÂê¶Ê∫ñÂÇôÂ•Ω
            if (!video.videoWidth || !video.videoHeight) {
                showToast('Áõ∏Ê©üÂ∞öÊú™Ê∫ñÂÇôÂ•ΩÔºåË´ãÁ®çÂÄô', 'error');
                return;
            }
            
            const canvas = document.getElementById('polaroidCanvas');
            const flashOverlay = document.getElementById('camFlashOverlay');
            const film = document.getElementById('polaroidFilm');
            const filmImage = document.getElementById('polaroidFilmImage');
            
            // 1. Êì∑ÂèñÂΩ±ÂÉè
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            
            // Âè™ÊúâËá™Êãç(ÂâçÈè°È†≠)ÈúÄË¶ÅÈè°ÂÉè
            if (currentFacingMode === 'user') {
                ctx.translate(canvas.width, 0);
                ctx.scale(-1, 1);
            }
            
            ctx.drawImage(video, 0, 0);
            const dataURL = canvas.toDataURL('image/jpeg', 0.85);
            
            // 2. ÈñÉÂÖâÁáàÊïàÊûú
            flashOverlay.classList.add('flash-active');
            setTimeout(() => flashOverlay.classList.remove('flash-active'), 300);
            
            // 3. Ë®≠ÂÆöÂ∫ïÁâá
            filmImage.src = dataURL;
            filmImage.style.opacity = '0';
            
            // Â•óÁî®Ëä±ÈÇäÊ®£Âºè
            Object.values(frameStyles).forEach(s => film.classList.remove(s.class));
            film.classList.add(frameStyles[currentPolaroidFrame].class);
            document.getElementById('polaroidFilmText').style.color = frameStyles[currentPolaroidFrame].textColor;
            
            // 4. ÈÄÄÁâáÂãïÁï´
            film.style.display = 'none';
            film.classList.remove('ejecting');
            void film.offsetWidth; // Force reflow
            film.classList.add('ejecting');
            
            // 5. Âª∫Á´ãÊï£ËêΩÁÖßÁâá
            setTimeout(() => {
                createScatteredPolaroid(dataURL, currentPolaroidFrame);
                film.classList.remove('ejecting');
                film.style.display = 'none';
            }, 1000);
        }
        
        function createScatteredPolaroid(imgSrc, frameKey) {
            polaroidPhotoCount++;
            const photoId = `polaroid-photo-${polaroidPhotoCount}`;
            const style = frameStyles[frameKey];
            
            const photoDiv = document.createElement('div');
            photoDiv.id = photoId;
            photoDiv.className = `polaroid-photo-card ${style.class}`;
            
            // Èö®Ê©ü‰ΩçÁΩÆÔºàÈÅøÈñã‰∏≠ÈñìÁõ∏Ê©üÔºâ
            const randomAngle = Math.random() * 30 - 15;
            const side = Math.random() > 0.5 ? 1 : -1;
            const randomX = (20 + Math.random() * 25) * side;
            const randomY = Math.random() * 30 - 15;
            
            photoDiv.style.left = `calc(50% + ${randomX}%)`;
            photoDiv.style.top = `calc(50% + ${randomY}%)`;
            photoDiv.style.transform = `translate(-50%, -50%) rotate(${randomAngle}deg)`;
            
            // ÈóúÈñâÊåâÈàï
            const closeBtn = document.createElement('div');
            closeBtn.className = 'polaroid-photo-close';
            closeBtn.innerHTML = '√ó';
            closeBtn.onclick = (e) => {
                e.stopPropagation();
                const idx = pendingPolaroidPhotos.findIndex(p => p.id === photoId);
                if (idx > -1) pendingPolaroidPhotos.splice(idx, 1);
                photoDiv.remove();
            };
            
            // ÂúñÁâáÂçÄÂüü
            const imgArea = document.createElement('div');
            imgArea.className = 'polaroid-image-area';
            const img = document.createElement('img');
            img.src = imgSrc;
            img.style.opacity = '0';
            setTimeout(() => { img.style.opacity = '1'; }, 100);
            imgArea.appendChild(img);
            
            // ÊñáÂ≠ó
            const textDiv = document.createElement('div');
            textDiv.className = 'polaroid-photo-text';
            textDiv.style.color = style.textColor;
            textDiv.innerText = `Photo #${polaroidPhotoCount}`;
            
            // Êìç‰ΩúÊåâÈàï
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'polaroid-photo-actions';
            
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'polaroid-photo-btn';
            downloadBtn.innerHTML = 'üíæ ‰∏ãËºâ';
            downloadBtn.onclick = (e) => {
                e.stopPropagation();
                downloadPolaroidPhoto(photoDiv, frameKey, polaroidPhotoCount);
            };
            
            actionsDiv.appendChild(downloadBtn);
            
            photoDiv.appendChild(closeBtn);
            photoDiv.appendChild(imgArea);
            photoDiv.appendChild(textDiv);
            photoDiv.appendChild(actionsDiv);
            
            document.getElementById('polaroidPhotosContainer').appendChild(photoDiv);
            
            // Â≠òÂÖ•Êö´Â≠ò
            pendingPolaroidPhotos.push({
                id: photoId,
                photo: imgSrc,
                frame: frameKey,
                timestamp: new Date().toISOString()
            });
            
            // ‰ΩøÁÖßÁâáÂèØÊãñÊõ≥
            makePolaroidDraggable(photoDiv);
        }
        
        async function downloadPolaroidPhoto(photoDiv, frameKey, photoNum) {
            const closeBtn = photoDiv.querySelector('.polaroid-photo-close');
            const actionsDiv = photoDiv.querySelector('.polaroid-photo-actions');
            
            closeBtn.style.display = 'none';
            actionsDiv.style.display = 'none';
            
            // Êö´ÊôÇÁßªÈô§ÊóãËΩâÔºåÁ¢∫‰øù‰∏ãËºâÁöÑÂúñÁâáÊòØÊ≠£ÁöÑ
            const originalTransform = photoDiv.style.transform;
            photoDiv.style.transform = 'none';
            
            try {
                const canvas = await html2canvas(photoDiv, {
                    backgroundColor: '#ffffff', // ÁôΩËâ≤ËÉåÊôØ
                    scale: 3,
                    useCORS: true
                });
                
                const link = document.createElement('a');
                link.download = `polaroid-${frameKey}-${photoNum}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showToast('üì∏ ÁÖßÁâáÂ∑≤‰∏ãËºâÔºÅ', 'success');
            } catch (err) {
                showToast('‰∏ãËºâÂ§±Êïó: ' + err.message, 'error');
            }
            
            photoDiv.style.transform = originalTransform;
            closeBtn.style.display = 'flex';
            actionsDiv.style.display = 'flex';
        }
        
        function makePolaroidDraggable(el) {
            let isDragging = false;
            let startX, startY, initialX, initialY;
            
            const startDrag = (clientX, clientY) => {
                isDragging = true;
                startX = clientX;
                startY = clientY;
                initialX = el.offsetLeft;
                initialY = el.offsetTop;
                el.style.zIndex = 100;
            };
            
            const doDrag = (clientX, clientY) => {
                if (!isDragging) return;
                const dx = clientX - startX;
                const dy = clientY - startY;
                el.style.transform = 'translate(-50%, -50%) rotate(0deg) scale(1.05)';
                el.style.left = `${initialX + dx}px`;
                el.style.top = `${initialY + dy}px`;
            };
            
            const endDrag = () => {
                if (isDragging) {
                    isDragging = false;
                    const randomAngle = Math.random() * 30 - 15;
                    el.style.transform = `translate(-50%, -50%) rotate(${randomAngle}deg)`;
                    el.style.zIndex = 30;
                }
            };
            
            el.addEventListener('mousedown', (e) => {
                if (e.target.tagName === 'BUTTON' || e.target.classList.contains('polaroid-photo-close')) return;
                e.preventDefault();
                startDrag(e.clientX, e.clientY);
            });
            document.addEventListener('mousemove', (e) => doDrag(e.clientX, e.clientY));
            document.addEventListener('mouseup', endDrag);
            
            el.addEventListener('touchstart', (e) => {
                if (e.target.tagName === 'BUTTON' || e.target.classList.contains('polaroid-photo-close')) return;
                startDrag(e.touches[0].clientX, e.touches[0].clientY);
            }, { passive: false });
            document.addEventListener('touchmove', (e) => {
                if (isDragging) e.preventDefault();
                if (e.touches && e.touches[0]) doDrag(e.touches[0].clientX, e.touches[0].clientY);
            }, { passive: false });
            document.addEventListener('touchend', endDrag);
        }
        
        async function savePolaroidToCheckin() {
            if (pendingPolaroidPhotos.length === 0) {
                showToast('Ë´ãÂÖàÊãçÊîùÁÖßÁâá', 'error');
                return;
            }
            
            showToast('üì∏ Ê≠£Âú®ËôïÁêÜÁÖßÁâá...', 'info');
            
            // Â∞áÊâÄÊúâÊãçÁ´ãÂæóÁÖßÁâáÂ≠òÂÖ•ÊâìÂç°
            for (const polaroid of pendingPolaroidPhotos) {
                // ‰ΩøÁî®html2canvasÂ∞áÊãçÁ´ãÂæóÔºàÂê´Ëä±ÈÇäÔºâËΩâÊàêÂúñÁâá
                const photoEl = document.getElementById(polaroid.id);
                if (!photoEl) continue;
                
                // Èö±ËóèÊåâÈàï
                const closeBtn = photoEl.querySelector('.polaroid-photo-close');
                const actionsDiv = photoEl.querySelector('.polaroid-photo-actions');
                if (closeBtn) closeBtn.style.display = 'none';
                if (actionsDiv) actionsDiv.style.display = 'none';
                
                // Êö´ÊôÇÁßªÈô§ÊóãËΩâÂíåÈô∞ÂΩ±ÔºåÁ¢∫‰øùÂúñÁâáÊ≠£Ê≠£ÊñπÊñπ
                const originalTransform = photoEl.style.transform;
                const originalBoxShadow = photoEl.style.boxShadow;
                photoEl.style.transform = 'none';
                photoEl.style.boxShadow = 'none';
                
                try {
                    const canvas = await html2canvas(photoEl, {
                        backgroundColor: '#ffffff', // ÁôΩËâ≤ËÉåÊôØÔºåÈÅøÂÖçÈªëÈÇä
                        scale: 2,
                        useCORS: true
                    });
                    const photoWithFrame = canvas.toDataURL('image/jpeg', 0.9);
                    
                    appData.checkins.push({
                        id: Date.now() + Math.random(),
                        photo: photoWithFrame,
                        spotId: null,
                        spotName: 'ÊãçÁ´ãÂæóÁÖßÁâá',
                        date: new Date().toISOString().split('T')[0],
                        note: `üì∏ ÊãçÁ´ãÂæó ‚Ä¢ ${getFrameName(polaroid.frame)} Ëä±ÈÇä`,
                        isPolaroid: true,
                        frame: polaroid.frame
                    });
                } catch (err) {
                    console.error('ÂÑ≤Â≠òÊãçÁ´ãÂæóÂ§±Êïó:', err);
                }
                
                // ÊÅ¢Âæ©ÂéüÊú¨Ê®£Âºè
                photoEl.style.transform = originalTransform;
                photoEl.style.boxShadow = originalBoxShadow;
                if (closeBtn) closeBtn.style.display = 'flex';
                if (actionsDiv) actionsDiv.style.display = 'flex';
            }
            
            saveData();
            renderCheckinPage();
            checkBadges();
            closePolaroidCamera();
            showToast(`üì∏ Â∑≤ÂÑ≤Â≠ò ${pendingPolaroidPhotos.length} ÂºµÊãçÁ´ãÂæóÁÖßÁâáÔºÅ`, 'success');
        }
        
        function showAddCheckinModal() {
            currentCheckinPhoto = null;
            currentCameraMode = 'normal';
            document.getElementById('modeNormal').classList.add('active');
            document.getElementById('modePolaroid').classList.remove('active');
            document.getElementById('checkinUploadArea').innerHTML = `<div class="photo-upload-icon">üì∑</div><div class="photo-upload-text">ÈªûÊìä‰∏äÂÇ≥ÁÖßÁâáÊàñÊãçÁÖß</div>`;
            document.getElementById('checkinUploadArea').classList.remove('has-photo');
            document.getElementById('checkinDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('checkinNote').value = '';
            
            // Êõ¥Êñ∞ÊôØÈªû‰∏ãÊãâÈÅ∏ÂñÆ
            const select = document.getElementById('checkinSpot');
            select.innerHTML = '<option value="">-- ‰∏çÈÅ∏Êìá --</option>' + 
                appData.spots.map(s => `<option value="${s.id}">${getTypeEmoji(s.type)} ${s.name}</option>`).join('');
            
            showModal('checkinModal');
        }
        
        function handleCheckinPhoto(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                // Â£ìÁ∏ÆÁÖßÁâá
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const maxSize = 800;
                    let { width, height } = img;
                    if (width > height && width > maxSize) { height = (height * maxSize) / width; width = maxSize; }
                    else if (height > maxSize) { width = (width * maxSize) / height; height = maxSize; }
                    canvas.width = width;
                    canvas.height = height;
                    canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                    currentCheckinPhoto = canvas.toDataURL('image/jpeg', 0.7);
                    document.getElementById('checkinUploadArea').innerHTML = `<img src="${currentCheckinPhoto}" alt="È†êË¶Ω">`;
                    document.getElementById('checkinUploadArea').classList.add('has-photo');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function saveCheckin() {
            if (!currentCheckinPhoto) { showToast('Ë´ãÂÖà‰∏äÂÇ≥ÁÖßÁâá', 'error'); return; }
            
            const spotId = document.getElementById('checkinSpot').value;
            const date = document.getElementById('checkinDate').value;
            const note = document.getElementById('checkinNote').value.trim();
            
            let spotName = 'Êú™Ê®ôË®òÊôØÈªû';
            if (spotId) {
                const spot = appData.spots.find(s => s.id == spotId);
                if (spot) {
                    spotName = spot.name;
                    if (!spot.checked) {
                        spot.checked = true;
                        spot.checkedAt = new Date().toISOString();
                    }
                }
            }
            
            appData.checkins.push({ id: Date.now(), photo: currentCheckinPhoto, spotId: spotId || null, spotName, date, note });
            saveData();
            renderCheckinPage();
            closeModal('checkinModal');
            checkBadges();
            showToast('üì∏ ÊâìÂç°ÊàêÂäüÔºÅ', 'success');
        }
        
        function renderCheckinPhotos() {
            const container = document.getElementById('checkinPhotoGrid');
            if (appData.checkins.length === 0) {
                container.innerHTML = `<div class="empty-state" style="grid-column:1/-1;"><div class="empty-icon">üì∑</div><div>ÈÇÑÊ≤íÊúâÁÖßÁâá</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">‰∏äÂÇ≥ÁÖßÁâáË®òÈåÑÁæéÂ•ΩÊôÇÂàªÔºÅ</div></div>`;
                return;
            }
            container.innerHTML = appData.checkins.map((c, i) => `
                <div class="checkin-photo" onclick="viewPhoto(${i})">
                    <img src="${c.photo}" alt="${c.spotName}">
                    <div class="checkin-photo-overlay">üìç ${c.spotName}</div>
                </div>
            `).join('');
        }
        
        function viewPhoto(index) {
            const c = appData.checkins[index];
            document.getElementById('viewerPhoto').src = c.photo;
            document.getElementById('viewerSpot').textContent = 'üìç ' + c.spotName;
            document.getElementById('viewerNote').textContent = c.note || '';
            document.getElementById('photoViewerOverlay').classList.add('show');
        }
        
        function closePhotoViewer() {
            document.getElementById('photoViewerOverlay').classList.remove('show');
        }
        
        // üèÜ ÊàêÂ∞±ÂæΩÁ´†
        function checkBadges() {
            let newBadge = null;
            CHECKIN_BADGES.forEach(badge => {
                if (!appData.badges[badge.id] && badge.condition(appData)) {
                    appData.badges[badge.id] = new Date().toISOString();
                    newBadge = badge;
                }
            });
            if (newBadge) {
                saveData();
                renderCheckinPage();
                showToast(`üèÜ Ëß£ÈéñÊàêÂ∞±Ôºö${newBadge.name}`, 'success');
            }
        }
        
        function renderBadges() {
            const container = document.getElementById('badgeGrid');
            container.innerHTML = CHECKIN_BADGES.map(badge => {
                const unlocked = !!appData.badges[badge.id];
                const progress = badge.getValue ? badge.getValue(appData) : 0;
                const total = badge.total || 1;
                const percent = Math.min((progress / total) * 100, 100);
                
                return `
                    <div class="badge-card ${unlocked ? 'unlocked' : 'locked'}">
                        <div class="badge-icon">${badge.icon}</div>
                        <div class="badge-name">${badge.name}</div>
                        <div class="badge-desc">${badge.desc}</div>
                        ${badge.total ? `<div class="badge-progress"><div class="badge-progress-fill" style="width:${percent}%"></div></div>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        // üìñ ÂõûÊÜ∂ÈåÑ
        function renderMemoir() {
            const container = document.getElementById('memoirTimeline');
            if (appData.checkins.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-icon">üìñ</div><div>ÈñãÂßãË®òÈåÑ‰Ω†ÁöÑÊóÖÁ®ã</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">ÊâìÂç°ÊôØÈªû‰∏¶‰∏äÂÇ≥ÁÖßÁâáÔºåËá™ÂãïÁî¢ÁîüÂõûÊÜ∂ÈåÑ</div></div>`;
                return;
            }
            
            // ÊåâÊó•ÊúüÂàÜÁµÑ
            const grouped = {};
            appData.checkins.forEach(c => {
                if (!grouped[c.date]) grouped[c.date] = [];
                grouped[c.date].push(c);
            });
            
            const sortedDates = Object.keys(grouped).sort((a, b) => new Date(a) - new Date(b));
            container.innerHTML = sortedDates.map((date, i) => `
                <div class="memoir-day">
                    <div class="memoir-day-title">Day ${i + 1} ‚Ä¢ ${formatDate(new Date(date))}</div>
                    ${grouped[date].map(c => `
                        <div class="memoir-entry">
                            <img class="memoir-entry-photo" src="${c.photo}" alt="${c.spotName}">
                            <div class="memoir-entry-content">
                                <div class="memoir-entry-spot">üìç ${c.spotName}</div>
                                ${c.note ? `<div class="memoir-entry-note">${c.note}</div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }
        
        function exportMemoirHtml() {
            const hasCheckins = appData.checkins && appData.checkins.length > 0;
            const hasNotes = appData.dailyNotes && Object.keys(appData.dailyNotes).length > 0;
            
            if (!hasCheckins && !hasNotes) { 
                showToast('Ê≤íÊúâÂõûÊÜ∂ÂèØÂåØÂá∫', 'error'); 
                return; 
            }
            
            // Êî∂ÈõÜÊâÄÊúâÊó•Êúü
            const allDates = new Set();
            if (hasCheckins) appData.checkins.forEach(c => allDates.add(c.date));
            if (hasNotes) Object.keys(appData.dailyNotes).forEach(d => allDates.add(d));
            const sortedDates = Array.from(allDates).sort((a, b) => new Date(a) - new Date(b));
            
            // ÂàÜÁµÑÊâìÂç°ÁÖßÁâá
            const photosByDate = {};
            if (hasCheckins) {
                appData.checkins.forEach(c => {
                    if (!photosByDate[c.date]) photosByDate[c.date] = [];
                    photosByDate[c.date].push(c);
                });
            }
            
            let html = `<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>${appData.trip.name || 'ÊàëÁöÑÊóÖÁ®ã'} - ÂõûÊÜ∂ÈåÑ</title>
    <style>
        body { font-family: -apple-system, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        h1 { text-align: center; color: #ec4899; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
        .day { margin-bottom: 40px; }
        .day-title { color: #ec4899; font-weight: bold; font-size: 1.3em; border-bottom: 3px solid #ec4899; padding-bottom: 10px; margin-bottom: 20px; }
        .section-title { color: #a855f7; font-weight: bold; margin: 20px 0 15px 0; }
        .photo-entry { background: #fff; border-radius: 12px; overflow: hidden; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,.1); }
        .photo-entry img { width: 100%; max-height: 400px; object-fit: cover; }
        .photo-entry-content { padding: 15px; }
        .photo-entry-spot { font-weight: bold; margin-bottom: 8px; }
        .photo-entry-note { color: #666; }
        .diary-entry { background: #fdf2f8; border-left: 4px solid #ec4899; padding: 15px; margin: 10px 0; border-radius: 0 8px 8px 0; }
        .diary-mood { font-size: 1.3em; margin-bottom: 5px; }
        .diary-time { color: #999; font-size: 0.85em; }
        .diary-content { margin-top: 10px; white-space: pre-wrap; }
        .stats { display: flex; justify-content: center; gap: 30px; margin-bottom: 30px; }
        .stat { text-align: center; }
        .stat-value { font-size: 2em; font-weight: bold; color: #ec4899; }
        .stat-label { color: #666; font-size: 0.9em; }
        .badges { margin-top: 30px; padding: 20px; background: #fff; border-radius: 12px; }
        .badge { display: inline-block; margin: 5px; padding: 8px 15px; background: linear-gradient(135deg, #ec4899, #a855f7); color: #fff; border-radius: 20px; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>üì∏ ${appData.trip.name || 'ÊàëÁöÑÊóÖÁ®ã'}</h1>
    <p class="subtitle">${appData.trip.destination ? 'üìç ' + appData.trip.destination + ' ‚Ä¢ ' : ''}${appData.trip.startDate ? formatDate(new Date(appData.trip.startDate)) + ' - ' + formatDate(new Date(appData.trip.endDate)) : ''}</p>
    
    <div class="stats">
        <div class="stat"><div class="stat-value">${appData.checkins?.length || 0}</div><div class="stat-label">ÂºµÁÖßÁâá</div></div>
        <div class="stat"><div class="stat-value">${appData.spots?.filter(s => s.checked).length || 0}</div><div class="stat-label">ÂÄãÊôØÈªû</div></div>
        <div class="stat"><div class="stat-value">${Object.keys(appData.badges || {}).length}</div><div class="stat-label">ÂÄãÊàêÂ∞±</div></div>
    </div>`;
            
            // ÊåâÊó•ÊúüËº∏Âá∫
            sortedDates.forEach((date, i) => {
                const photos = photosByDate[date] || [];
                const notes = appData.dailyNotes?.[date] || [];
                
                html += `<div class="day"><div class="day-title">Day ${i + 1} ‚Ä¢ ${formatDate(new Date(date))}</div>`;
                
                // ÁÖßÁâá
                if (photos.length > 0) {
                    html += `<div class="section-title">üì∏ ÊâìÂç°ÁÖßÁâá</div>`;
                    photos.forEach(c => {
                        html += `<div class="photo-entry"><img src="${c.photo}" alt="${c.spotName}"><div class="photo-entry-content"><div class="photo-entry-spot">üìç ${c.spotName}</div>${c.note ? `<div class="photo-entry-note">${c.note}</div>` : ''}</div></div>`;
                    });
                }
                
                // ÈªûÊª¥
                if (notes.length > 0) {
                    html += `<div class="section-title">‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥</div>`;
                    notes.forEach(note => {
                        html += `<div class="diary-entry"><div class="diary-mood">${note.mood} <span class="diary-time">üïê ${note.time}</span></div><div class="diary-content">${note.content}</div></div>`;
                    });
                }
                
                html += `</div>`;
            });
            
            // ÊàêÂ∞±
            const unlockedBadges = CHECKIN_BADGES.filter(b => appData.badges?.[b.id]);
            if (unlockedBadges.length > 0) {
                html += `<div class="badges"><h3>üèÜ Áç≤ÂæóÁöÑÊàêÂ∞±</h3>`;
                unlockedBadges.forEach(b => {
                    html += `<span class="badge">${b.icon} ${b.name}</span>`;
                });
                html += `</div>`;
            }
            
            html += `<p style="text-align:center;color:#999;margin-top:40px;font-size:0.85em;">üì∏ ÊóÖÈÅäÂõûÊÜ∂ÈåÑÁî±„ÄåÊóÖÈÅäÁßòÊõ∏„ÄçÂåØÂá∫ ‚Ä¢ ${new Date().toLocaleString('zh-TW')}</p></body></html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${appData.trip.name || 'ÊóÖÈÅäÂõûÊÜ∂ÈåÑ'}_${new Date().toISOString().split('T')[0]}.html`;
            a.click();
            URL.revokeObjectURL(a.href);
            showToast('ÂõûÊÜ∂ÈåÑÂ∑≤ÂåØÂá∫ üìñ', 'success');
        }
        
        // üóëÔ∏è Ê∏ÖÈô§ÊâìÂç°ÂõûÊÜ∂ÔºàÁî®Êà∂‰∏ªÂãïÊìç‰ΩúÔºâ
        function clearCheckinMemories() {
            const photoCount = appData.checkins?.length || 0;
            const spotCount = appData.spots?.length || 0;
            const badgeCount = Object.keys(appData.badges || {}).length;
            
            if (photoCount === 0 && spotCount === 0 && badgeCount === 0) {
                showToast('Ê≤íÊúâÊâìÂç°ÂõûÊÜ∂ÈúÄË¶ÅÊ∏ÖÈô§', 'info');
                return;
            }
            
            const msg = `‚ö†Ô∏è Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊâìÂç°ÂõûÊÜ∂ÂóéÔºü\n\n` +
                `Âç≥Â∞áÂà™Èô§Ôºö\n` +
                `${photoCount > 0 ? `‚Ä¢ ${photoCount} ÂºµÊâìÂç°ÁÖßÁâá\n` : ''}` +
                `${spotCount > 0 ? `‚Ä¢ ${spotCount} ÂÄãÊôØÈªûË®òÈåÑ\n` : ''}` +
                `${badgeCount > 0 ? `‚Ä¢ ${badgeCount} ÂÄãÊàêÂ∞±ÂæΩÁ´†\n` : ''}` +
                `\nüí° Âª∫Ë≠∞ÂÖàÂåØÂá∫ HTML ÂõûÊÜ∂ÈåÑ‰øùÂ≠òÔºÅ\n\nÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`;
            
            if (!confirm(msg)) return;
            if (!confirm('ÂÜçÊ¨°Á¢∫Ë™çÔºöÁúüÁöÑË¶ÅÂà™Èô§ÊâÄÊúâÊâìÂç°ÂõûÊÜ∂ÂóéÔºü')) return;
            
            appData.spots = [];
            appData.checkins = [];
            appData.badges = {};
            saveData();
            renderCheckinPage();
            showToast('Â∑≤Ê∏ÖÈô§ÊâÄÊúâÊâìÂç°ÂõûÊÜ∂', 'success');
        }
        
        // üìù ÂåØÂá∫ÂõûÊÜ∂ÈåÑÂà∞ Google DocÔºàÂê´ÁÖßÁâáÂíåÊóÖÈÅäÈªûÊª¥Ôºâ
        async function exportMemoirToGoogleDoc() {
            const token = getStoredToken();
            if (!token) {
                showToast('Ë´ãÂÖàÊéàÊ¨ä Google Â∏≥Ëôü', 'error');
                return;
            }
            
            const hasCheckins = appData.checkins && appData.checkins.length > 0;
            const hasNotes = appData.dailyNotes && Object.keys(appData.dailyNotes).length > 0;
            
            if (!hasCheckins && !hasNotes) {
                showToast('Ê≤íÊúâÂõûÊÜ∂ÂèØÂåØÂá∫', 'error');
                return;
            }
            
            showToast('üìù Ê≠£Âú®ÂåØÂá∫Âà∞ Google DocÔºàÂê´ÁÖßÁâáÔºâ...', 'info');
            
            try {
                const trip = appData.trip;
                const docTitle = `${trip.name || 'ÊóÖÈÅäÂõûÊÜ∂ÈåÑ'} - ${new Date().toLocaleDateString('zh-TW')}`;
                
                // Êî∂ÈõÜÊâÄÊúâÊó•Êúü
                const allDates = new Set();
                if (hasCheckins) appData.checkins.forEach(c => allDates.add(c.date));
                if (hasNotes) Object.keys(appData.dailyNotes).forEach(d => allDates.add(d));
                const sortedDates = Array.from(allDates).sort((a, b) => new Date(a) - new Date(b));
                
                // ÂàÜÁµÑÊâìÂç°ÁÖßÁâá
                const photosByDate = {};
                if (hasCheckins) {
                    appData.checkins.forEach(c => {
                        if (!photosByDate[c.date]) photosByDate[c.date] = [];
                        photosByDate[c.date].push(c);
                    });
                }
                
                // ÁµÑÂêà HTML ÂÖßÂÆπÔºàÂê´ÁÖßÁâáÔºâ
                let htmlContent = `
                    <html><head><meta charset="utf-8"></head>
                    <body style="font-family: Arial, sans-serif; line-height: 1.8; max-width: 800px; margin: 0 auto;">
                    <h1 style="color: #ec4899; border-bottom: 3px solid #ec4899; padding-bottom: 10px; text-align: center;">
                        üì∏ ${trip.name || 'ÊàëÁöÑÊóÖÈÅäÂõûÊÜ∂'}
                    </h1>
                    <p style="color: #666; text-align: center; margin-bottom: 30px;">
                        ${trip.destination ? 'üìç ' + trip.destination : ''} 
                        ${trip.startDate ? '‚Ä¢ ' + formatDate(new Date(trip.startDate)) + ' - ' + formatDate(new Date(trip.endDate)) : ''}
                    </p>
                    
                    <table style="width: 100%; margin-bottom: 30px;">
                        <tr>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ec4899;">${appData.checkins?.length || 0}</div>
                                <div style="color: #666;">ÂºµÁÖßÁâá</div>
                            </td>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${appData.spots?.filter(s => s.checked).length || 0}</div>
                                <div style="color: #666;">ÂÄãÊôØÈªû</div>
                            </td>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #06b6d4;">${Object.keys(appData.badges || {}).length}</div>
                                <div style="color: #666;">ÂÄãÊàêÂ∞±</div>
                            </td>
                        </tr>
                    </table>
                    <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
                `;
                
                // ÊåâÊó•ÊúüËº∏Âá∫
                sortedDates.forEach((date, dayIndex) => {
                    const photos = photosByDate[date] || [];
                    const notes = appData.dailyNotes?.[date] || [];
                    
                    htmlContent += `
                        <h2 style="color: #a855f7; margin-top: 40px; border-bottom: 2px solid #a855f7; padding-bottom: 8px;">
                            Day ${dayIndex + 1} ‚Ä¢ ${formatDate(new Date(date))}
                        </h2>
                    `;
                    
                    // üì∏ ÊâìÂç°ÁÖßÁâáÔºàÂê´ÂúñÁâáÔºâ- 2x2 Á∂≤Ê†ºÊéíÂàó
                    if (photos.length > 0) {
                        htmlContent += `<h3 style="color: #ec4899;">üì∏ ÊâìÂç°ÁÖßÁâá</h3>`;
                        
                        // ÊØè4ÂºµÁÖßÁâáÁÇ∫‰∏ÄÁµÑ
                        for (let i = 0; i < photos.length; i += 4) {
                            const group = photos.slice(i, i + 4);
                            htmlContent += `<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;"><tr>`;
                            
                            group.forEach((c, idx) => {
                                // ÊãçÁ´ãÂæóÁÖßÁâá‰ΩøÁî®ÁôΩËâ≤ËÉåÊôØÔºå‰∏ÄËà¨ÁÖßÁâá‰ΩøÁî®Ê∑∫ÁÅ∞ËÉåÊôØ
                                const bgColor = c.isPolaroid ? '#ffffff' : '#f8f9fa';
                                const imgStyle = c.isPolaroid 
                                    ? 'width: 100%; height: 150px; object-fit: contain; background: white;' 
                                    : 'width: 100%; height: 150px; object-fit: cover;';
                                
                                htmlContent += `
                                    <td style="width: 50%; vertical-align: top; padding: 8px;">
                                        <div style="background: ${bgColor}; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                            <img src="${c.photo}" style="${imgStyle} display: block;">
                                            <div style="padding: 8px;">
                                                <div style="font-weight: bold; font-size: 0.85em; margin-bottom: 4px;">üìç ${c.spotName}</div>
                                                ${c.note ? `<div style="color: #666; font-size: 0.75em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${escapeHtml(c.note)}</div>` : ''}
                                            </div>
                                        </div>
                                    </td>
                                `;
                                
                                // ÊØèÂÖ©ÂºµÊèõË°å
                                if (idx === 1 && group.length > 2) {
                                    htmlContent += `</tr><tr>`;
                                }
                            });
                            
                            // Â¶ÇÊûúÊúÄÂæå‰∏ÄË°åÂè™ÊúâÂñÆÂºµÔºåË£ú‰∏ÄÂÄãÁ©∫Ê†º
                            if (group.length === 1 || group.length === 3) {
                                htmlContent += `<td style="width: 50%;"></td>`;
                            }
                            
                            htmlContent += `</tr></table>`;
                        }
                    }
                    
                    // ‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥
                    if (notes.length > 0) {
                        htmlContent += `<h3 style="color: #06b6d4;">‚úçÔ∏è ÊóÖÈÅäÈªûÊª¥</h3>`;
                        notes.forEach(note => {
                            htmlContent += `
                                <div style="background: #fdf2f8; border-left: 4px solid #ec4899; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0;">
                                    <div style="font-size: 1.3em; margin-bottom: 8px;">
                                        ${note.mood} <span style="color: #999; font-size: 0.7em;">üïê ${note.time}</span>
                                    </div>
                                    <div style="white-space: pre-wrap; line-height: 1.6;">${escapeHtml(note.content)}</div>
                                </div>
                            `;
                        });
                    }
                });
                
                // üèÜ ÊàêÂ∞±
                const unlockedBadges = CHECKIN_BADGES.filter(b => appData.badges?.[b.id]);
                if (unlockedBadges.length > 0) {
                    htmlContent += `
                        <h2 style="color: #ffd700; margin-top: 40px;">üèÜ Áç≤ÂæóÁöÑÊàêÂ∞±</h2>
                        <table style="width: 100%;">
                    `;
                    unlockedBadges.forEach(badge => {
                        htmlContent += `
                            <tr>
                                <td style="padding: 10px; font-size: 1.5em;">${badge.icon}</td>
                                <td style="padding: 10px;">
                                    <strong>${badge.name}</strong><br>
                                    <span style="color: #666; font-size: 0.9em;">${badge.desc}</span>
                                </td>
                            </tr>
                        `;
                    });
                    htmlContent += `</table>`;
                }
                
                // ÁµêÂ∞æ
                htmlContent += `
                    <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 40px 0 20px 0;">
                    <p style="text-align: center; color: #999; font-size: 0.85em;">
                        üì∏ ÊóÖÈÅäÂõûÊÜ∂ÈåÑÁî±„ÄåÊóÖÈÅäÁßòÊõ∏„ÄçÂåØÂá∫<br>
                        üìÖ ${new Date().toLocaleString('zh-TW')}
                    </p>
                    </body></html>
                `;
                
                // Âª∫Á´ã Google Doc
                const metadata = { name: docTitle, mimeType: 'application/vnd.google-apps.document' };
                const boundary = '-------314159265358979323846';
                const multipartBody = 
                    '\r\n--' + boundary + '\r\n' +
                    'Content-Type: application/json\r\n\r\n' +
                    JSON.stringify(metadata) +
                    '\r\n--' + boundary + '\r\n' +
                    'Content-Type: text/html\r\n\r\n' +
                    htmlContent +
                    '\r\n--' + boundary + '--';
                
                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token.access_token,
                        'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                    },
                    body: multipartBody
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'Âª∫Á´ãÂ§±Êïó');
                }
                
                const result = await response.json();
                const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                
                showDocLinkModal(docTitle, docUrl);
                
            } catch (error) {
                console.error('ÂåØÂá∫Â§±Êïó:', error);
                showToast('ÂåØÂá∫Â§±ÊïóÔºö' + error.message, 'error');
            }
        }
        
        // üñºÔ∏è ‰∏äÂÇ≥Âà∞ Google Áõ∏Á∞ø
        async function exportToGooglePhotos() {
            const token = getStoredToken();
            if (!token) {
                showToast('Ë´ãÂÖàÊéàÊ¨ä Google Â∏≥Ëôü', 'error');
                return;
            }
            
            if (!appData.checkins || appData.checkins.length === 0) {
                showToast('Ê≤íÊúâÁÖßÁâáÂèØ‰∏äÂÇ≥', 'error');
                return;
            }
            
            const photoCount = appData.checkins.length;
            showToast(`üñºÔ∏è Ê≠£Âú®‰∏äÂÇ≥ ${photoCount} ÂºµÁÖßÁâáÂà∞ Google Áõ∏Á∞ø...`, 'info');
            
            try {
                // 1. Âª∫Á´ãÁõ∏Á∞ø
                const albumTitle = `${appData.trip.name || 'ÊóÖÈÅäÂõûÊÜ∂'} - ${new Date().toLocaleDateString('zh-TW')}`;
                
                const albumResponse = await fetch('https://photoslibrary.googleapis.com/v1/albums', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token.access_token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ album: { title: albumTitle } })
                });
                
                if (!albumResponse.ok) {
                    const error = await albumResponse.json();
                    console.error('Âª∫Á´ãÁõ∏Á∞øÂ§±Êïó:', error);
                    
                    // Ê™¢Êü•ÊòØÂê¶ÈúÄË¶ÅÈáçÊñ∞ÊéàÊ¨ä
                    if (albumResponse.status === 401 || albumResponse.status === 403 || 
                        error.error?.status === 'PERMISSION_DENIED' ||
                        error.error?.message?.includes('scope')) {
                        showGooglePhotosReauthModal();
                        return;
                    }
                    throw new Error(error.error?.message || 'Âª∫Á´ãÁõ∏Á∞øÂ§±Êïó');
                }
                
                const album = await albumResponse.json();
                const albumId = album.id;
                
                showToast(`üìÅ Â∑≤Âª∫Á´ãÁõ∏Á∞ø„Äå${albumTitle}„ÄçÔºåÈñãÂßã‰∏äÂÇ≥ÁÖßÁâá...`, 'info');
                
                // 2. ‰∏äÂÇ≥ÊØèÂºµÁÖßÁâá
                const uploadTokens = [];
                let successCount = 0;
                let failedCount = 0;
                
                for (let i = 0; i < appData.checkins.length; i++) {
                    const checkin = appData.checkins[i];
                    
                    // Ê™¢Êü•ÊòØÂê¶ÊúâÁÖßÁâá
                    if (!checkin.photo) {
                        failedCount++;
                        continue;
                    }
                    
                    try {
                        // Â∞á base64 ËΩâÁÇ∫ binary
                        const base64Data = checkin.photo.split(',')[1];
                        if (!base64Data) {
                            failedCount++;
                            continue;
                        }
                        
                        const binaryString = atob(base64Data);
                        const bytes = new Uint8Array(binaryString.length);
                        for (let j = 0; j < binaryString.length; j++) {
                            bytes[j] = binaryString.charCodeAt(j);
                        }
                        
                        // ‰∏äÂÇ≥ bytes ÂèñÂæó upload token
                        const fileName = `${checkin.date || 'photo'}_${(checkin.spotName || 'photo').replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '_')}_${i+1}.jpg`;
                        
                        const uploadResponse = await fetch('https://photoslibrary.googleapis.com/v1/uploads', {
                            method: 'POST',
                            headers: {
                                'Authorization': 'Bearer ' + token.access_token,
                                'Content-Type': 'application/octet-stream',
                                'X-Goog-Upload-Content-Type': 'image/jpeg',
                                'X-Goog-Upload-Protocol': 'raw',
                                'X-Goog-Upload-File-Name': encodeURIComponent(fileName)
                            },
                            body: bytes
                        });
                        
                        if (uploadResponse.ok) {
                            const uploadToken = await uploadResponse.text();
                            if (uploadToken && uploadToken.length > 0) {
                                uploadTokens.push({
                                    uploadToken: uploadToken,
                                    description: `üìç ${checkin.spotName || 'Êú™ÂëΩÂêçÂú∞Èªû'} ‚Ä¢ ${checkin.date || ''}${checkin.note ? ' ‚Ä¢ ' + checkin.note.substring(0, 50) : ''}`,
                                    fileName: fileName
                                });
                                successCount++;
                            } else {
                                failedCount++;
                            }
                            
                            if (successCount % 3 === 0 || i === appData.checkins.length - 1) {
                                showToast(`üì§ Â∑≤‰∏äÂÇ≥ ${successCount}/${photoCount} Âºµ...`, 'info');
                            }
                        } else {
                            const errText = await uploadResponse.text();
                            console.error(`ÁÖßÁâá ${i+1} ‰∏äÂÇ≥Â§±Êïó:`, uploadResponse.status, errText);
                            failedCount++;
                        }
                    } catch (uploadErr) {
                        console.error(`ÁÖßÁâá ${i+1} ËôïÁêÜÂ§±Êïó:`, uploadErr);
                        failedCount++;
                    }
                }
                
                if (uploadTokens.length === 0) {
                    throw new Error(`ÊâÄÊúâÁÖßÁâá‰∏äÂÇ≥Â§±ÊïóÔºàÂÖ± ${failedCount} ÂºµÔºâ`);
                }
                
                // 3. ÊâπÊ¨°Âª∫Á´ãÂ™íÈ´îÈ†ÖÁõÆÔºàÊØèÊ¨°ÊúÄÂ§ö 50 ÂºµÔºâ
                showToast(`üì∏ Ê≠£Âú®Âª∫Á´ã ${uploadTokens.length} ÂºµÁÖßÁâá...`, 'info');
                
                let createdCount = 0;
                for (let i = 0; i < uploadTokens.length; i += 50) {
                    const batch = uploadTokens.slice(i, i + 50);
                    
                    const batchCreateResponse = await fetch('https://photoslibrary.googleapis.com/v1/mediaItems:batchCreate', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer ' + token.access_token,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            albumId: albumId,
                            newMediaItems: batch.map(item => ({
                                description: item.description,
                                simpleMediaItem: {
                                    fileName: item.fileName,
                                    uploadToken: item.uploadToken
                                }
                            }))
                        })
                    });
                    
                    if (batchCreateResponse.ok) {
                        const result = await batchCreateResponse.json();
                        console.log('batchCreate result:', result);
                        createdCount += result.newMediaItemResults?.filter(r => !r.status?.code || r.status.code === 0).length || 0;
                    } else {
                        const errText = await batchCreateResponse.text();
                        console.error('batchCreate Â§±Êïó:', batchCreateResponse.status, errText);
                    }
                }
                
                // 4. È°ØÁ§∫ÊàêÂäüË®äÊÅØ
                const albumUrl = album.productUrl || `https://photos.google.com/album/${albumId}`;
                
                showGooglePhotosResultModal(createdCount, albumTitle, albumUrl);
                
            } catch (error) {
                console.error('‰∏äÂÇ≥Âà∞ Google Áõ∏Á∞øÂ§±Êïó:', error);
                
                if (error.message.includes('insufficient') || error.message.includes('scope') || error.message.includes('PERMISSION')) {
                    showGooglePhotosReauthModal();
                } else {
                    showToast('‰∏äÂÇ≥Â§±ÊïóÔºö' + error.message, 'error');
                }
            }
        }
        
        function showGooglePhotosResultModal(count, albumTitle, albumUrl) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.id = 'googlePhotosResultModal';
            modal.innerHTML = `
                <div class="modal" style="text-align:center;">
                    <div style="font-size:3em;margin-bottom:15px;">üéâ</div>
                    <h3 style="margin-bottom:10px;color:var(--text-light);">‰∏äÂÇ≥ÊàêÂäüÔºÅ</h3>
                    <p style="color:var(--text-secondary);margin-bottom:15px;">
                        Â∑≤ÊàêÂäü‰∏äÂÇ≥ <strong style="color:var(--cyan);">${count}</strong> ÂºµÁÖßÁâá
                    </p>
                    <p style="font-size:0.85em;color:var(--text-dim);margin-bottom:20px;">
                        üìÅ Áõ∏Á∞øÔºö${albumTitle}
                    </p>
                    <a href="${albumUrl}" target="_blank" class="btn btn-primary" style="display:block;text-decoration:none;margin-bottom:10px;">
                        üñºÔ∏è ÂâçÂæÄ Google Áõ∏Á∞øÊü•Áúã
                    </a>
                    <button class="btn btn-outline" onclick="document.getElementById('googlePhotosResultModal').remove()">ÈóúÈñâ</button>
                </div>
            `;
            modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
            document.body.appendChild(modal);
        }
        
        function showGooglePhotosReauthModal() {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.id = 'googlePhotosReauthModal';
            modal.innerHTML = `
                <div class="modal" style="text-align:center;">
                    <div style="font-size:3em;margin-bottom:15px;">üîê</div>
                    <h3 style="margin-bottom:10px;color:var(--text-light);">ÈúÄË¶ÅÈáçÊñ∞ÊéàÊ¨ä</h3>
                    <p style="color:var(--text-secondary);margin-bottom:15px;">
                        Google Áõ∏Á∞øÂäüËÉΩÈúÄË¶ÅÈ°çÂ§ñÁöÑÊ¨äÈôê
                    </p>
                    <p style="font-size:0.85em;color:var(--text-dim);margin-bottom:20px;">
                        Ë´ãÂÖàÁôªÂá∫ÔºåÁÑ∂ÂæåÈáçÊñ∞ÊéàÊ¨ä Google Â∏≥Ëôü‰ª•ÂèñÂæóÁõ∏Á∞ø‰∏äÂÇ≥Ê¨äÈôê
                    </p>
                    <button class="btn btn-primary" style="width:100%;margin-bottom:10px;" onclick="reauthForGooglePhotos()">
                        üîÑ ÈáçÊñ∞ÊéàÊ¨ä
                    </button>
                    <button class="btn btn-outline" onclick="document.getElementById('googlePhotosReauthModal').remove()">Á®çÂæåÂÜçË™™</button>
                </div>
            `;
            modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
            document.body.appendChild(modal);
        }
        
        function reauthForGooglePhotos() {
            // Ê∏ÖÈô§ÁèæÊúâÊéàÊ¨ä
            localStorage.removeItem('google_token');
            document.getElementById('googlePhotosReauthModal')?.remove();
            
            // ÈáçÊñ∞ÊéàÊ¨ä
            showToast('Ë´ãÈáçÊñ∞ÊéàÊ¨ä Google Â∏≥Ëôü', 'info');
            handleAuthClick();
        }
        
        // üì∏ ‰∏ãËºâÊâÄÊúâÁÖßÁâáÔºàZIP ÊâìÂåÖÔºâ
        async function downloadAllPhotos() {
            if (!appData.checkins || appData.checkins.length === 0) {
                showToast('Ê≤íÊúâÁÖßÁâáÂèØ‰∏ãËºâ', 'error');
                return;
            }
            
            // Ê™¢Êü• JSZip ÊòØÂê¶ËºâÂÖ•
            if (typeof JSZip === 'undefined') {
                showToast('Ê≠£Âú®ËºâÂÖ•ÊâìÂåÖÂ∑•ÂÖ∑...', 'info');
                // ÂòóË©¶ÂãïÊÖãËºâÂÖ•
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
                script.onload = () => downloadAllPhotos();
                document.head.appendChild(script);
                return;
            }
            
            showToast('üì¶ Ê≠£Âú®ÊâìÂåÖÁÖßÁâá...', 'info');
            
            try {
                const zip = new JSZip();
                const folder = zip.folder(appData.trip.name || 'ÊóÖÈÅäÁÖßÁâá');
                
                // ÊåâÊó•ÊúüÂàÜÁµÑ
                const grouped = {};
                appData.checkins.forEach(c => {
                    if (!grouped[c.date]) grouped[c.date] = [];
                    grouped[c.date].push(c);
                });
                
                const sortedDates = Object.keys(grouped).sort((a, b) => new Date(a) - new Date(b));
                
                sortedDates.forEach((date, dayIndex) => {
                    const dayFolder = folder.folder(`Day${dayIndex + 1}_${date}`);
                    grouped[date].forEach((c, photoIndex) => {
                        // Âæû base64 ËΩâÊèõÁÇ∫ blob
                        const base64Data = c.photo.split(',')[1];
                        const fileName = `${photoIndex + 1}_${c.spotName.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '_')}.jpg`;
                        dayFolder.file(fileName, base64Data, { base64: true });
                    });
                });
                
                // Áî¢Áîü ZIP ‰∏¶‰∏ãËºâ
                const content = await zip.generateAsync({ type: 'blob' });
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${appData.trip.name || 'ÊóÖÈÅäÁÖßÁâá'}_${new Date().toISOString().split('T')[0]}.zip`;
                a.click();
                URL.revokeObjectURL(url);
                
                showToast(`‚úÖ Â∑≤ÊâìÂåÖ ${appData.checkins.length} ÂºµÁÖßÁâá`, 'success');
                
            } catch (error) {
                console.error('ÊâìÂåÖÂ§±Êïó:', error);
                showToast('ÊâìÂåÖÂ§±ÊïóÔºö' + error.message, 'error');
            }
        }
        
        // ============================================
        // üéÆ Ë∂£Âë≥Â∑•ÂÖ∑ÂäüËÉΩ
        // ============================================
        
        // ÂàáÊèõË∂£Âë≥Â∑•ÂÖ∑Èù¢Êùø
        function switchFunTool(tool) {
            document.querySelectorAll('.fun-tool-card').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.fun-panel').forEach(p => p.classList.remove('active'));
            document.querySelector(`.fun-tool-card[onclick="switchFunTool('${tool}')"]`)?.classList.add('active');
            document.getElementById(`funPanel-${tool}`)?.classList.add('active');
            
            // ÂàùÂßãÂåñÂêÑÂ∑•ÂÖ∑
            if (tool === 'roulette') initRoulette();
            if (tool === 'chemistry') initChemistry();
            if (tool === 'price') initPrice();
            if (tool === 'bingo') initBingo();
            if (tool === 'mood') initMood();
        }
        
        // === Ëº™Áõ§ÂäüËÉΩ ===
        function initRoulette() {
            if (!appData.funTools) appData.funTools = { roulette: { options: ['ÂêÉÊãâÈ∫µ', 'ÈÄõÁ•ûÁ§æ', 'Ë≤∑Ëó•Â¶ù'] } };
            renderRouletteOptions();
            renderRouletteWheel();
        }
        
        function renderRouletteOptions() {
            const container = document.getElementById('rouletteOptions');
            if (!container) return;
            const options = appData.funTools?.roulette?.options || [];
            container.innerHTML = options.map((opt, i) => `
                <div class="tag">${opt}<button class="tag-remove" onclick="removeRouletteOption(${i})">‚úï</button></div>
            `).join('');
        }
        
        function renderRouletteWheel() {
            const wheel = document.getElementById('rouletteWheel');
            if (!wheel) return;
            const options = appData.funTools?.roulette?.options || [];
            const n = options.length;
            if (n === 0) { wheel.style.background = 'var(--bg-card-hover)'; wheel.innerHTML = ''; return; }
            
            const colors = ['#06b6d4', '#a855f7', '#f59e0b', '#ec4899', '#10b981', '#3b82f6', '#ef4444', '#ffd93d'];
            const angle = 360 / n;
            let gradientParts = [];
            for (let i = 0; i < n; i++) {
                gradientParts.push(`${colors[i % colors.length]} ${i * angle}deg ${(i + 1) * angle}deg`);
            }
            wheel.style.background = `conic-gradient(from -90deg, ${gradientParts.join(', ')})`;
            
            // ÊñáÂ≠óÊ≤øÂçäÂæëÊñπÂêëÂûÇÁõ¥ÊéíÂàóÔºåÁî±‰∏äËÄå‰∏ã
            wheel.innerHTML = options.map((opt, i) => {
                const rotateAngle = i * angle + angle / 2;
                return `<div style="position:absolute;left:50%;top:10%;width:50px;height:75px;margin-left:-25px;transform-origin:center 120px;transform:rotate(${rotateAngle}deg);display:flex;align-items:center;justify-content:center;pointer-events:none;"><span style="writing-mode:vertical-rl;text-orientation:mixed;font-size:0.85em;font-weight:700;text-shadow:2px 2px 4px rgba(0,0,0,0.8);white-space:nowrap;max-height:70px;overflow:hidden;letter-spacing:2px;">${opt}</span></div>`;
            }).join('');
        }
        
        function addRouletteOption() {
            const input = document.getElementById('rouletteInput');
            const value = input?.value.trim();
            if (!value) return;
            if (!appData.funTools.roulette) appData.funTools.roulette = { options: [] };
            appData.funTools.roulette.options.push(value);
            saveData(); input.value = '';
            renderRouletteOptions(); renderRouletteWheel();
        }
        
        function removeRouletteOption(index) {
            appData.funTools.roulette.options.splice(index, 1);
            saveData(); renderRouletteOptions(); renderRouletteWheel();
        }
        
        let isSpinning = false;
        function spinRoulette() {
            const options = appData.funTools?.roulette?.options || [];
            if (isSpinning || options.length === 0) return;
            isSpinning = true;
            
            const wheel = document.getElementById('rouletteWheel');
            const result = document.getElementById('rouletteResult');
            const resultText = document.getElementById('rouletteResultText');
            result.classList.remove('show');
            
            const n = options.length;
            const angle = 360 / n;
            const randomIndex = Math.floor(Math.random() * n);
            const extraSpins = 5 + Math.floor(Math.random() * 3);
            // ÊâáÂΩ¢ÂæûÈ†ÇÈÉ®ÈñãÂßãÔºåÁ¨¨iÂÄãÊâáÂΩ¢‰∏≠ÂøÉÂú® i*angle + angle/2
            // Ë¶ÅËÆìË©≤ÊâáÂΩ¢ËΩâÂà∞È†ÇÈÉ®ÊåáÈáù‰ΩçÁΩÆÔºåÈúÄË¶ÅÈ†ÜÊôÇÈáùÊóãËΩâ (randomIndex * angle + angle/2) Â∫¶
            // ‰ΩÜÊàëÂÄëÁî®ÁöÑÊòØÈÄÜÊôÇÈáùËßíÂ∫¶Ë®àÁÆóÔºåÊâÄ‰ª•Áî® 360 Ê∏õÂéª
            const stopAngle = randomIndex * angle + angle / 2;
            const targetAngle = extraSpins * 360 + (360 - stopAngle);
            
            wheel.style.transition = 'transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
            wheel.style.transform = `rotate(${targetAngle}deg)`;
            
            setTimeout(() => {
                resultText.textContent = options[randomIndex];
                result.classList.add('show');
                isSpinning = false;
                setTimeout(() => { 
                    wheel.style.transition = 'none'; 
                    wheel.style.transform = `rotate(${targetAngle % 360}deg)`; 
                }, 100);
            }, 4000);
        }
        
        document.getElementById('rouletteInput')?.addEventListener('keypress', e => { if (e.key === 'Enter') addRouletteOption(); });
        
        // === ÈªòÂ•ëÊ∏¨Ë©¶ ===
        let currentPlayer = 0;
        
        function initChemistry() {
            if (!appData.funTools.chemistry) {
                appData.funTools.chemistry = { questions: ['‰ªäÂ§©ÊúÄÊÉ≥ÂéªÂì™Ë£°Ôºü', 'ÂçàÈ§êÊÉ≥ÂêÉ‰ªÄÈ∫ºÔºü', 'ÊúÄÊÉ≥Ë≤∑‰ªÄÈ∫ºÁ¥ÄÂøµÂìÅÔºü', 'Êôö‰∏äÊÉ≥ÂÅö‰ªÄÈ∫ºÊ¥ªÂãïÔºü'], answers: [[], []] };
            }
            renderChemistryQuestions();
        }
        
        function renderChemistryQuestions() {
            const container = document.getElementById('chemistryQuestions');
            if (!container) return;
            const answers = appData.funTools.chemistry.answers[currentPlayer] || [];
            container.innerHTML = appData.funTools.chemistry.questions.map((q, i) => `
                <div class="chemistry-question">
                    <div class="chemistry-question-title">ÂïèÈ°å ${i + 1}</div>
                    <div class="chemistry-question-text">${q}</div>
                    <input type="${answers[i] ? 'password' : 'text'}" class="input-field" placeholder="‰Ω†ÁöÑÁ≠îÊ°à..." value="${answers[i] || ''}" oninput="saveChemistryAnswer(${i}, this.value)">
                </div>
            `).join('');
        }
        
        function switchPlayer(index) {
            currentPlayer = index;
            document.querySelectorAll('.player-tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
                const ans = appData.funTools.chemistry.answers[i] || [];
                if (ans.length === appData.funTools.chemistry.questions.length && ans.every(a => a)) tab.classList.add('done');
                else tab.classList.remove('done');
            });
            renderChemistryQuestions();
        }
        
        function saveChemistryAnswer(index, value) {
            if (!appData.funTools.chemistry.answers[currentPlayer]) appData.funTools.chemistry.answers[currentPlayer] = [];
            appData.funTools.chemistry.answers[currentPlayer][index] = value;
            saveData(); switchPlayer(currentPlayer);
        }
        
        function revealChemistry() {
            const a1 = appData.funTools.chemistry.answers[0] || [];
            const a2 = appData.funTools.chemistry.answers[1] || [];
            const qLen = appData.funTools.chemistry.questions.length;
            if (a1.length < qLen || a2.length < qLen || !a1.every(a=>a) || !a2.every(a=>a)) { showToast('‚ö†Ô∏è ÂÖ©‰ΩçÊóÖ‰º¥ÈÉΩË¶ÅÂõûÁ≠îÂÆåÊâçËÉΩÊè≠ÊõâÔºÅ', 'error'); return; }
            
            let matches = 0;
            const results = appData.funTools.chemistry.questions.map((q, i) => {
                const match = a1[i]?.toLowerCase().trim() === a2[i]?.toLowerCase().trim();
                if (match) matches++;
                return { question: q, a1: a1[i], a2: a2[i], match };
            });
            const score = Math.round((matches / qLen) * 100);
            
            document.getElementById('chemistryResults').innerHTML = `
                <div class="chemistry-match"><div><div class="chemistry-score">${score}%</div><div style="color:var(--text-dim);">ÈªòÂ•ëÊåáÊï∏</div></div></div>
                ${results.map(r => `<div class="chemistry-result" style="border-left-color:${r.match ? 'var(--emerald)' : 'var(--red)'}"><div style="font-weight:600;margin-bottom:6px;">${r.question}</div><div style="display:flex;gap:16px;font-size:0.9em;"><div><span style="color:var(--text-muted);">A:</span> ${r.a1}</div><div><span style="color:var(--text-muted);">B:</span> ${r.a2}</div></div><div style="margin-top:6px;color:${r.match ? 'var(--emerald)' : 'var(--red)'};">${r.match ? '‚úì ‰∏ÄËá¥ÔºÅ' : '‚úó ‰∏çÂêå'}</div></div>`).join('')}
            `;
        }
        
        function resetChemistry() {
            appData.funTools.chemistry.answers = [[], []];
            saveData();
            document.getElementById('chemistryResults').innerHTML = '';
            document.querySelectorAll('.player-tab').forEach(t => t.classList.remove('done'));
            switchPlayer(0);
            showToast('Â∑≤ÈáçÁΩÆÔºÅ', 'success');
        }
        
        // === Áâ©ÂÉπÊèõÁÆó ===
        function initPrice() {
            if (!appData.funTools.price) appData.funTools.price = { currency: 'JPY' };
            renderCurrencyGrid();
        }
        
        function renderCurrencyGrid(filter = '') {
            const grid = document.getElementById('currencyGrid');
            if (!grid) return;
            const entries = Object.entries(EXCHANGE_RATES).filter(([code, info]) => 
                code !== 'TWD' && (filter === '' || code.includes(filter.toUpperCase()) || info.name.includes(filter))
            );
            grid.innerHTML = entries.map(([code, info]) => `
                <button class="currency-btn ${appData.funTools.price.currency === code ? 'active' : ''}" onclick="selectCurrency('${code}')">${info.flag} ${info.name}</button>
            `).join('');
        }
        
        function filterCurrencies() {
            const search = document.getElementById('currencySearch')?.value || '';
            renderCurrencyGrid(search);
        }
        
        function selectCurrency(code) {
            appData.funTools.price.currency = code;
            saveData();
            renderCurrencyGrid(document.getElementById('currencySearch')?.value || '');
            calculatePrice();
        }
        
        function calculatePrice() {
            const input = document.getElementById('priceInput')?.value;
            const amount = parseFloat(input) || 0;
            const currencyCode = appData.funTools.price.currency;
            const currency = EXCHANGE_RATES[currencyCode];
            if (!currency) return;
            
            const twdAmount = Math.round(amount * currency.rate);
            document.getElementById('priceDisplay').textContent = `${currency.symbol} ${amount.toLocaleString()}`;
            document.getElementById('priceConverted').textContent = `‚âà NT$ ${twdAmount.toLocaleString()}`;
            
            if (twdAmount > 0) {
                let equivalent = [];
                let remaining = twdAmount;
                const sorted = [...TW_PRICES].sort((a, b) => b.price - a.price);
                for (const item of sorted) {
                    const count = Math.floor(remaining / item.price);
                    if (count > 0) { equivalent.push(`${count}${item.name}`); remaining -= count * item.price; if (equivalent.length >= 2) break; }
                }
                if (equivalent.length === 0) equivalent.push(`‰∏çÂà∞‰∏Ä${TW_PRICES[TW_PRICES.length-1].name}`);
                document.getElementById('equivalentText').textContent = equivalent.join(' + ');
            } else {
                document.getElementById('equivalentText').textContent = 'Ëº∏ÂÖ•ÈáëÈ°çÁúãÁúã';
            }
        }
        
        // === Bingo ===
        function initBingo() {
            if (!appData.funTools.bingo) appData.funTools.bingo = { items: [], grid: [], checked: [] };
            if (!appData.funTools.bingo.items || appData.funTools.bingo.items.length < 24) appData.funTools.bingo.items = [...DEFAULT_BINGO];
            if (!appData.funTools.bingo.grid || appData.funTools.bingo.grid.length === 0) generateBingo();
            else renderBingo();
            document.getElementById('bingoCustomItems').value = appData.funTools.bingo.items.join('\n');
        }
        
        function generateBingo() {
            const items = [...appData.funTools.bingo.items].sort(() => Math.random() - 0.5).slice(0, 24);
            items.splice(12, 0, 'FREE');
            appData.funTools.bingo.grid = items;
            appData.funTools.bingo.checked = [12];
            saveData(); renderBingo();
        }
        
        function renderBingo() {
            const grid = document.getElementById('bingoGrid');
            if (!grid) return;
            grid.innerHTML = appData.funTools.bingo.grid.map((item, i) => `
                <div class="bingo-cell ${appData.funTools.bingo.checked.includes(i) ? 'checked' : ''} ${i === 12 ? 'center' : ''}" onclick="toggleBingoCell(${i})">${item}</div>
            `).join('');
            updateBingoStats();
        }
        
        function toggleBingoCell(index) {
            if (index === 12) return;
            const idx = appData.funTools.bingo.checked.indexOf(index);
            if (idx > -1) appData.funTools.bingo.checked.splice(idx, 1);
            else appData.funTools.bingo.checked.push(index);
            saveData(); renderBingo();
        }
        
        function updateBingoStats() {
            const checked = appData.funTools.bingo.checked;
            let lines = 0;
            for (let r = 0; r < 5; r++) { if ([0,1,2,3,4].every(c => checked.includes(r * 5 + c))) lines++; }
            for (let c = 0; c < 5; c++) { if ([0,1,2,3,4].every(r => checked.includes(r * 5 + c))) lines++; }
            if ([0,6,12,18,24].every(i => checked.includes(i))) lines++;
            if ([4,8,12,16,20].every(i => checked.includes(i))) lines++;
            document.getElementById('bingoLines').textContent = lines;
            document.getElementById('bingoChecks').textContent = checked.length - 1;
        }
        
        function saveBingoItems() {
            const text = document.getElementById('bingoCustomItems')?.value || '';
            const items = text.split('\n').map(s => s.trim()).filter(s => s);
            if (items.length < 24) { showToast('‚ö†Ô∏è Ëá≥Â∞ëÈúÄË¶Å 24 ÂÄãÈ†ÖÁõÆÔºÅ', 'error'); return; }
            appData.funTools.bingo.items = items;
            saveData(); generateBingo(); closeModal('bingoCustomModal');
            showToast('‚úÖ Â∑≤ÂÑ≤Â≠ò‰∏¶ÈáçÊñ∞Áî¢ÁîüÔºÅ', 'success');
        }
        
        // === Â§©Ê∞£Á©øÊê≠ ===
        async function getWeather() {
            const city = document.getElementById('weatherCity')?.value.trim();
            if (!city) { showToast('Ë´ãËº∏ÂÖ•ÂüéÂ∏ÇÂêçÁ®±', 'error'); return; }
            
            const weathers = [
                { icon: '‚òÄÔ∏è', desc: 'Êô¥Â§©', temp: 28, humidity: 45, wind: 3, rain: 0 },
                { icon: '‚õÖ', desc: 'Â§öÈõ≤', temp: 22, humidity: 60, wind: 5, rain: 10 },
                { icon: 'üåßÔ∏è', desc: 'Â∞èÈõ®', temp: 18, humidity: 80, wind: 8, rain: 70 },
                { icon: '‚ùÑÔ∏è', desc: 'ÂØíÂÜ∑', temp: 5, humidity: 50, wind: 10, rain: 20 },
                { icon: 'üå§Ô∏è', desc: 'Êô¥ÊôÇÂ§öÈõ≤', temp: 25, humidity: 55, wind: 4, rain: 5 }
            ];
            const weather = weathers[Math.floor(Math.random() * weathers.length)];
            const outfit = getOutfitSuggestion(weather.temp, weather.rain);
            
            document.getElementById('weatherDisplay').innerHTML = `
                <div class="weather-display"><div class="weather-location">üìç ${city}</div><div class="weather-icon">${weather.icon}</div><div class="weather-temp">${weather.temp}¬∞C</div><div class="weather-desc">${weather.desc}</div></div>
                <div class="weather-details"><div class="weather-detail"><div class="weather-detail-icon">üíß</div><div class="weather-detail-value">${weather.humidity}%</div><div class="weather-detail-label">ÊøïÂ∫¶</div></div><div class="weather-detail"><div class="weather-detail-icon">üí®</div><div class="weather-detail-value">${weather.wind} m/s</div><div class="weather-detail-label">È¢®ÈÄü</div></div><div class="weather-detail"><div class="weather-detail-icon">üåßÔ∏è</div><div class="weather-detail-value">${weather.rain}%</div><div class="weather-detail-label">ÈôçÈõ®Ê©üÁéá</div></div></div>
                <div class="outfit-suggestion"><div class="outfit-title">üëï Á©øÊê≠Âª∫Ë≠∞</div><div class="outfit-items">${outfit.map(item => `<div class="outfit-item">${item}</div>`).join('')}</div></div>
            `;
        }
        
        function getOutfitSuggestion(temp, rain) {
            const items = [];
            if (temp >= 28) items.push('üëï Áü≠Ë¢ñ', 'ü©≥ Áü≠Ë§≤', 'üß¢ Â∏ΩÂ≠ê', 'üï∂Ô∏è Â§™ÈôΩÁúºÈè°');
            else if (temp >= 22) items.push('üëï ËñÑÈï∑Ë¢ñ', 'üëñ Èï∑Ë§≤', 'üß• ËñÑÂ§ñÂ•óÂÇôÁî®');
            else if (temp >= 15) items.push('üß• Â§ñÂ•ó', 'üëñ Èï∑Ë§≤', 'üëï Èï∑Ë¢ñ‰∏äË°£');
            else if (temp >= 8) items.push('üß• ÂéöÂ§ñÂ•ó', 'üß£ ÂúçÂ∑æ', 'üëñ Èï∑Ë§≤', 'üß§ ÊâãÂ•óÂÇôÁî®');
            else items.push('üß• ÁæΩÁµ®Ë°£', 'üß£ ÂúçÂ∑æ', 'üß§ ÊâãÂ•ó', 'üéø ‰øùÊöñÂÖßÊê≠');
            if (rain > 50) items.push('‚òî Èõ®ÂÇòÂøÖÂÇô');
            else if (rain > 20) items.push('üåÇ Â∏∂ÊääÂÇò');
            return items;
        }
        
        document.getElementById('weatherCity')?.addEventListener('keypress', e => { if (e.key === 'Enter') getWeather(); });
        
        // === ÂøÉÊÉÖÊ∫´Â∫¶Ë®à ===
        function initMood() {
            if (!appData.funTools.mood) appData.funTools.mood = { records: [] };
            const today = new Date();
            const weekdays = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];
            const moodDate = document.getElementById('moodDate');
            if (moodDate) moodDate.textContent = `${today.getMonth() + 1}/${today.getDate()} (${weekdays[today.getDay()]})`;
            updateMoodDisplay();
            renderMoodChart();
            renderMoodHistory();
        }
        
        function updateMoodDisplay() {
            const slider = document.getElementById('moodSlider');
            if (!slider) return;
            const value = parseInt(slider.value);
            const moodValue = document.getElementById('moodValue');
            const moodEmoji = document.getElementById('moodEmoji');
            if (moodValue) moodValue.textContent = value;
            const emojis = ['üò¢', 'üòû', 'üòî', 'üòê', 'üôÇ', 'üòä', 'üòÑ', 'üòÅ', 'ü§©', 'ü•≥'];
            if (moodEmoji) moodEmoji.textContent = emojis[value - 1];
        }
        
        function saveMood() {
            const value = parseInt(document.getElementById('moodSlider')?.value || 7);
            const note = document.getElementById('moodNote')?.value.trim() || '';
            const today = new Date().toISOString().split('T')[0];
            
            const existingIndex = appData.funTools.mood.records.findIndex(r => r.date === today);
            const record = { date: today, value, note, timestamp: new Date().toISOString() };
            
            if (existingIndex > -1) appData.funTools.mood.records[existingIndex] = record;
            else appData.funTools.mood.records.push(record);
            
            appData.funTools.mood.records = appData.funTools.mood.records.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 30);
            saveData();
            document.getElementById('moodNote').value = '';
            renderMoodChart(); renderMoodHistory();
            showToast('üíæ Â∑≤Ë®òÈåÑ‰ªäÊó•ÂøÉÊÉÖÔºÅ', 'success');
        }
        
        function renderMoodChart() {
            const container = document.getElementById('moodChart');
            if (!container) return;
            const records = (appData.funTools.mood?.records || []).sort((a, b) => new Date(a.date) - new Date(b.date)).slice(-7);
            
            if (records.length === 0) {
                container.innerHTML = '<div class="mood-chart-title">üìä ÂøÉÊÉÖÊõ≤Á∑ö</div><div style="text-align:center;color:var(--text-muted);padding:20px;">ÈÇÑÊ≤íÊúâË®òÈåÑ</div>';
                return;
            }
            container.innerHTML = `<div class="mood-chart-title">üìä ÊúÄËøë 7 Â§©ÂøÉÊÉÖÊõ≤Á∑ö</div><div class="mood-chart-container">${records.map(r => {
                const date = new Date(r.date);
                return `<div class="mood-bar" style="height:${r.value * 10}%"><div class="mood-bar-label">${date.getMonth()+1}/${date.getDate()}</div></div>`;
            }).join('')}</div>`;
        }
        
        function renderMoodHistory() {
            const container = document.getElementById('moodHistory');
            if (!container) return;
            const records = (appData.funTools.mood?.records || []).sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);
            if (records.length === 0) { container.innerHTML = ''; return; }
            
            const emojis = ['üò¢', 'üòû', 'üòî', 'üòê', 'üôÇ', 'üòä', 'üòÑ', 'üòÅ', 'ü§©', 'ü•≥'];
            const weekdays = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];
            
            container.innerHTML = records.map(r => {
                const date = new Date(r.date);
                return `<div class="mood-entry"><div class="mood-entry-emoji">${emojis[r.value - 1]}</div><div class="mood-entry-info"><div class="mood-entry-date">${date.getMonth()+1}/${date.getDate()} (${weekdays[date.getDay()]})</div>${r.note ? `<div class="mood-entry-note">${r.note}</div>` : ''}</div><div class="mood-entry-score">${r.value}</div></div>`;
            }).join('');
        }
    </script>
</body>
</html>
